var app=function(){"use strict";function e(){}function t(e,t){for(const r in t)e[r]=t[r];return e}function r(e){return e()}function n(){return Object.create(null)}function i(e){e.forEach(r)}function o(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(t,...r){if(null==t)return e;const n=t.subscribe(...r);return n.unsubscribe?()=>n.unsubscribe():n}function u(e){let t;return a(e,(e=>t=e))(),t}function c(e,t,r){e.$$.on_destroy.push(a(t,r))}function l(e,t,r,n){if(e){const i=h(e,t,r,n);return e[0](i)}}function h(e,r,n,i){return e[1]&&i?t(n.ctx.slice(),e[1](i(r))):n.ctx}function f(e,t,r,n,i,o,s){const a=function(e,t,r,n){if(e[2]&&n){const i=e[2](n(r));if(void 0===t.dirty)return i;if("object"==typeof i){const e=[],r=Math.max(t.dirty.length,i.length);for(let n=0;n<r;n+=1)e[n]=t.dirty[n]|i[n];return e}return t.dirty|i}return t.dirty}(t,n,i,o);if(a){const i=h(t,r,n,s);e.p(i,a)}}function d(t){return t&&o(t.destroy)?t.destroy:e}function p(e,t){e.appendChild(t)}function g(e,t,r){e.insertBefore(t,r||null)}function m(e){e.parentNode.removeChild(e)}function v(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}function y(e){return document.createElement(e)}function b(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function w(e){return document.createTextNode(e)}function F(){return w(" ")}function _(){return w("")}function S(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function E(e,t,r){null==r?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function x(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function D(e,t){e.value=null==t?"":t}function k(e,t,r){e.classList[r?"add":"remove"](t)}let A;function C(e){A=e}function P(){if(!A)throw new Error("Function called outside component initialization");return A}function T(e){P().$$.on_mount.push(e)}function R(){const e=P();return(t,r)=>{const n=e.$$.callbacks[t];if(n){const i=function(e,t){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!1,!1,t),r}(t,r);n.slice().forEach((t=>{t.call(e,i)}))}}}function B(e,t){const r=e.$$.callbacks[t.type];r&&r.slice().forEach((e=>e(t)))}const I=[],j=[],$=[],L=[],N=Promise.resolve();let O=!1;function U(){O||(O=!0,N.then(z))}function M(){return U(),N}function H(e){$.push(e)}function q(e){L.push(e)}let V=!1;const K=new Set;function z(){if(!V){V=!0;do{for(let e=0;e<I.length;e+=1){const t=I[e];C(t),J(t.$$)}for(C(null),I.length=0;j.length;)j.pop()();for(let e=0;e<$.length;e+=1){const t=$[e];K.has(t)||(K.add(t),t())}$.length=0}while(I.length);for(;L.length;)L.pop()();O=!1,V=!1,K.clear()}}function J(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(H)}}const W=new Set;let Y;function G(){Y={r:0,c:[],p:Y}}function X(){Y.r||i(Y.c),Y=Y.p}function Z(e,t){e&&e.i&&(W.delete(e),e.i(t))}function Q(e,t,r,n){if(e&&e.o){if(W.has(e))return;W.add(e),Y.c.push((()=>{W.delete(e),n&&(r&&e.d(1),n())})),e.o(t)}}function ee(e,t){Q(e,1,1,(()=>{t.delete(e.key)}))}function te(e,t){const r={},n={},i={$$scope:1};let o=e.length;for(;o--;){const s=e[o],a=t[o];if(a){for(const e in s)e in a||(n[e]=1);for(const e in a)i[e]||(r[e]=a[e],i[e]=1);e[o]=a}else for(const e in s)i[e]=1}for(const e in n)e in r||(r[e]=void 0);return r}function re(e){return"object"==typeof e&&null!==e?e:{}}function ne(e,t,r){const n=e.$$.props[t];void 0!==n&&(e.$$.bound[n]=r,r(e.$$.ctx[n]))}function ie(e){e&&e.c()}function oe(e,t,n){const{fragment:s,on_mount:a,on_destroy:u,after_update:c}=e.$$;s&&s.m(t,n),H((()=>{const t=a.map(r).filter(o);u?u.push(...t):i(t),e.$$.on_mount=[]})),c.forEach(H)}function se(e,t){const r=e.$$;null!==r.fragment&&(i(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function ae(t,r,o,s,a,u,c=[-1]){const l=A;C(t);const h=r.props||{},f=t.$$={fragment:null,ctx:null,props:u,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:n(),dirty:c,skip_bound:!1};let d=!1;if(f.ctx=o?o(t,h,((e,r,...n)=>{const i=n.length?n[0]:r;return f.ctx&&a(f.ctx[e],f.ctx[e]=i)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](i),d&&function(e,t){-1===e.$$.dirty[0]&&(I.push(e),U(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),r})):[],f.update(),d=!0,i(f.before_update),f.fragment=!!s&&s(f.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);f.fragment&&f.fragment.l(e),e.forEach(m)}else f.fragment&&f.fragment.c();r.intro&&Z(t.$$.fragment),oe(t,r.target,r.anchor),z()}C(l)}class ue{$destroy(){se(this,1),this.$destroy=e}$on(e,t){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class ce extends ue{constructor(e){super(),ae(this,e,null,null,s,{})}}function le(e){let t,r,n,i;const o=e[2].default,s=l(o,e,e[1],null);return{c(){t=y("div"),r=y("div"),s&&s.c(),E(r,"class",n="flex flex-col items-center w-full "+e[0]),E(t,"class","container flex flex-grow mx-auto items-center justify-center mt-2")},m(e,n){g(e,t,n),p(t,r),s&&s.m(r,null),i=!0},p(e,[t]){s&&s.p&&2&t&&f(s,o,e,e[1],t,null,null),(!i||1&t&&n!==(n="flex flex-col items-center w-full "+e[0]))&&E(r,"class",n)},i(e){i||(Z(s,e),i=!0)},o(e){Q(s,e),i=!1},d(e){e&&m(t),s&&s.d(e)}}}function he(e,t,r){let{$$slots:n={},$$scope:i}=t,{extraClasses:o=""}=t;return e.$$set=e=>{"extraClasses"in e&&r(0,o=e.extraClasses),"$$scope"in e&&r(1,i=e.$$scope)},[o,i,n]}class fe extends ue{constructor(e){super(),ae(this,e,he,le,s,{extraClasses:0})}}var de="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function pe(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}var ge=pe((function(e,t){var r;r=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=22)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i={debug:function(){},info:function(){},warn:function(){},error:function(){}},o=void 0,s=void 0;(t.Log=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.reset=function(){s=3,o=i},e.debug=function(){if(s>=4){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.debug.apply(o,Array.from(t))}},e.info=function(){if(s>=3){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.info.apply(o,Array.from(t))}},e.warn=function(){if(s>=2){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.warn.apply(o,Array.from(t))}},e.error=function(){if(s>=1){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.error.apply(o,Array.from(t))}},n(e,null,[{key:"NONE",get:function(){return 0}},{key:"ERROR",get:function(){return 1}},{key:"WARN",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"level",get:function(){return s},set:function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");s=e}},{key:"logger",get:function(){return o},set:function(e){if(!e.debug&&e.info&&(e.debug=e.info),!(e.debug&&e.info&&e.warn&&e.error))throw new Error("Invalid logger");o=e}}]),e}()).reset()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i={setInterval:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return setInterval(e,t)})),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return clearInterval(e)}))},o=!1,s=null;t.Global=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e._testing=function(){o=!0},e.setXMLHttpRequest=function(e){s=e},n(e,null,[{key:"location",get:function(){if(!o)return location}},{key:"localStorage",get:function(){if(!o&&"undefined"!=typeof window)return localStorage}},{key:"sessionStorage",get:function(){if(!o&&"undefined"!=typeof window)return sessionStorage}},{key:"XMLHttpRequest",get:function(){if(!o&&"undefined"!=typeof window)return s||XMLHttpRequest}},{key:"timer",get:function(){if(!o)return i}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataService=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(7);t.MetadataService=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.JsonService;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw i.Log.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=t,this._jsonService=new r(["application/jwk-set+json"])}return e.prototype.getMetadata=function(){var e=this;return this._settings.metadata?(i.Log.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(i.Log.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then((function(t){return i.Log.debug("MetadataService.getMetadata: json received"),e._settings.metadata=t,t}))):(i.Log.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))},e.prototype.getIssuer=function(){return this._getMetadataProperty("issuer")},e.prototype.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},e.prototype.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},e.prototype.getTokenEndpoint=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("token_endpoint",e)},e.prototype.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},e.prototype.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},e.prototype.getRevocationEndpoint=function(){return this._getMetadataProperty("revocation_endpoint",!0)},e.prototype.getKeysEndpoint=function(){return this._getMetadataProperty("jwks_uri",!0)},e.prototype._getMetadataProperty=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i.Log.debug("MetadataService.getMetadataProperty for: "+e),this.getMetadata().then((function(r){if(i.Log.debug("MetadataService.getMetadataProperty: metadata recieved"),void 0===r[e]){if(!0===t)return void i.Log.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+e);throw i.Log.error("MetadataService.getMetadataProperty: Metadata does not contain property "+e),new Error("Metadata does not contain property "+e)}return r[e]}))},e.prototype.getSigningKeys=function(){var e=this;return this._settings.signingKeys?(i.Log.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then((function(t){return i.Log.debug("MetadataService.getSigningKeys: jwks_uri received",t),e._jsonService.getJson(t).then((function(t){if(i.Log.debug("MetadataService.getSigningKeys: key set received",t),!t.keys)throw i.Log.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return e._settings.signingKeys=t.keys,e._settings.signingKeys}))}))},n(e,[{key:"metadataUrl",get:function(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(".well-known/openid-configuration")<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=".well-known/openid-configuration"))),this._metadataUrl}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UrlUtility=void 0;var n=r(0),i=r(1);t.UrlUtility=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.addQueryParam=function(e,t,r){return e.indexOf("?")<0&&(e+="?"),"?"!==e[e.length-1]&&(e+="&"),e+=encodeURIComponent(t),(e+="=")+encodeURIComponent(r)},e.parseUrlFragment=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.Global;"string"!=typeof e&&(e=r.location.href);var o=e.lastIndexOf(t);o>=0&&(e=e.substr(o+1)),"?"===t&&(o=e.indexOf("#"))>=0&&(e=e.substr(0,o));for(var s,a={},u=/([^&=]+)=([^&]*)/g,c=0;s=u.exec(e);)if(a[decodeURIComponent(s[1])]=decodeURIComponent(s[2]),c++>50)return n.Log.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",e),{error:"Response exceeded expected number of parameters"};for(var l in a)return a;return{}},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.JoseUtil=void 0;var n=r(25),i=function(e){return e&&e.__esModule?e:{default:e}}(r(32));t.JoseUtil=(0,i.default)({jws:n.jws,KeyUtil:n.KeyUtil,X509:n.X509,crypto:n.crypto,hextob64u:n.hextob64u,b64tohex:n.b64tohex,AllowedSigningAlgs:n.AllowedSigningAlgs})},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.OidcClientSettings=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),s=r(6),a=r(23),u=r(2),c="id_token",l="openid";t.OidcClientSettings=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.authority,i=t.metadataUrl,o=t.metadata,h=t.signingKeys,f=t.client_id,d=t.client_secret,p=t.response_type,g=void 0===p?c:p,m=t.scope,v=void 0===m?l:m,y=t.redirect_uri,b=t.post_logout_redirect_uri,w=t.prompt,F=t.display,_=t.max_age,S=t.ui_locales,E=t.acr_values,x=t.resource,D=t.response_mode,k=t.filterProtocolClaims,A=void 0===k||k,C=t.loadUserInfo,P=void 0===C||C,T=t.staleStateAge,R=void 0===T?900:T,B=t.clockSkew,I=void 0===B?300:B,j=t.userInfoJwtIssuer,$=void 0===j?"OP":j,L=t.stateStore,N=void 0===L?new s.WebStorageStateStore:L,O=t.ResponseValidatorCtor,U=void 0===O?a.ResponseValidator:O,M=t.MetadataServiceCtor,H=void 0===M?u.MetadataService:M,q=t.extraQueryParams,V=void 0===q?{}:q,K=t.extraTokenParams,z=void 0===K?{}:K;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._authority=r,this._metadataUrl=i,this._metadata=o,this._signingKeys=h,this._client_id=f,this._client_secret=d,this._response_type=g,this._scope=v,this._redirect_uri=y,this._post_logout_redirect_uri=b,this._prompt=w,this._display=F,this._max_age=_,this._ui_locales=S,this._acr_values=E,this._resource=x,this._response_mode=D,this._filterProtocolClaims=!!A,this._loadUserInfo=!!P,this._staleStateAge=R,this._clockSkew=I,this._userInfoJwtIssuer=$,this._stateStore=N,this._validator=new U(this),this._metadataService=new H(this),this._extraQueryParams="object"===(void 0===V?"undefined":n(V))?V:{},this._extraTokenParams="object"===(void 0===z?"undefined":n(z))?z:{}}return i(e,[{key:"client_id",get:function(){return this._client_id},set:function(e){if(this._client_id)throw o.Log.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=e}},{key:"client_secret",get:function(){return this._client_secret}},{key:"response_type",get:function(){return this._response_type}},{key:"scope",get:function(){return this._scope}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"post_logout_redirect_uri",get:function(){return this._post_logout_redirect_uri}},{key:"prompt",get:function(){return this._prompt}},{key:"display",get:function(){return this._display}},{key:"max_age",get:function(){return this._max_age}},{key:"ui_locales",get:function(){return this._ui_locales}},{key:"acr_values",get:function(){return this._acr_values}},{key:"resource",get:function(){return this._resource}},{key:"response_mode",get:function(){return this._response_mode}},{key:"authority",get:function(){return this._authority},set:function(e){if(this._authority)throw o.Log.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=e}},{key:"metadataUrl",get:function(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(".well-known/openid-configuration")<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=".well-known/openid-configuration")),this._metadataUrl}},{key:"metadata",get:function(){return this._metadata},set:function(e){this._metadata=e}},{key:"signingKeys",get:function(){return this._signingKeys},set:function(e){this._signingKeys=e}},{key:"filterProtocolClaims",get:function(){return this._filterProtocolClaims}},{key:"loadUserInfo",get:function(){return this._loadUserInfo}},{key:"staleStateAge",get:function(){return this._staleStateAge}},{key:"clockSkew",get:function(){return this._clockSkew}},{key:"userInfoJwtIssuer",get:function(){return this._userInfoJwtIssuer}},{key:"stateStore",get:function(){return this._stateStore}},{key:"validator",get:function(){return this._validator}},{key:"metadataService",get:function(){return this._metadataService}},{key:"extraQueryParams",get:function(){return this._extraQueryParams},set:function(e){"object"===(void 0===e?"undefined":n(e))?this._extraQueryParams=e:this._extraQueryParams={}}},{key:"extraTokenParams",get:function(){return this._extraTokenParams},set:function(e){"object"===(void 0===e?"undefined":n(e))?this._extraTokenParams=e:this._extraTokenParams={}}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.WebStorageStateStore=void 0;var n=r(0),i=r(1);t.WebStorageStateStore=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.prefix,n=void 0===r?"oidc.":r,o=t.store,s=void 0===o?i.Global.localStorage:o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._store=s,this._prefix=n}return e.prototype.set=function(e,t){return n.Log.debug("WebStorageStateStore.set",e),e=this._prefix+e,this._store.setItem(e,t),Promise.resolve()},e.prototype.get=function(e){n.Log.debug("WebStorageStateStore.get",e),e=this._prefix+e;var t=this._store.getItem(e);return Promise.resolve(t)},e.prototype.remove=function(e){n.Log.debug("WebStorageStateStore.remove",e),e=this._prefix+e;var t=this._store.getItem(e);return this._store.removeItem(e),Promise.resolve(t)},e.prototype.getAllKeys=function(){n.Log.debug("WebStorageStateStore.getAllKeys");for(var e=[],t=0;t<this._store.length;t++){var r=this._store.key(t);0===r.indexOf(this._prefix)&&e.push(r.substr(this._prefix.length))}return Promise.resolve(e)},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.JsonService=void 0;var n=r(0),i=r(1);t.JsonService=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.Global.XMLHttpRequest,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&Array.isArray(t)?this._contentTypes=t.slice():this._contentTypes=[],this._contentTypes.push("application/json"),n&&this._contentTypes.push("application/jwt"),this._XMLHttpRequest=r,this._jwtHandler=n}return e.prototype.getJson=function(e,t){var r=this;if(!e)throw n.Log.error("JsonService.getJson: No url passed"),new Error("url");return n.Log.debug("JsonService.getJson, url: ",e),new Promise((function(i,o){var s=new r._XMLHttpRequest;s.open("GET",e);var a=r._contentTypes,u=r._jwtHandler;s.onload=function(){if(n.Log.debug("JsonService.getJson: HTTP response received, status",s.status),200===s.status){var t=s.getResponseHeader("Content-Type");if(t){var r=a.find((function(e){if(t.startsWith(e))return!0}));if("application/jwt"==r)return void u(s).then(i,o);if(r)try{return void i(JSON.parse(s.responseText))}catch(e){return n.Log.error("JsonService.getJson: Error parsing JSON response",e.message),void o(e)}}o(Error("Invalid response Content-Type: "+t+", from URL: "+e))}else o(Error(s.statusText+" ("+s.status+")"))},s.onerror=function(){n.Log.error("JsonService.getJson: network error"),o(Error("Network Error"))},t&&(n.Log.debug("JsonService.getJson: token passed, setting Authorization header"),s.setRequestHeader("Authorization","Bearer "+t)),s.send()}))},e.prototype.postForm=function(e,t){var r=this;if(!e)throw n.Log.error("JsonService.postForm: No url passed"),new Error("url");return n.Log.debug("JsonService.postForm, url: ",e),new Promise((function(i,o){var s=new r._XMLHttpRequest;s.open("POST",e);var a=r._contentTypes;s.onload=function(){if(n.Log.debug("JsonService.postForm: HTTP response received, status",s.status),200!==s.status){if(400===s.status&&(r=s.getResponseHeader("Content-Type"))&&a.find((function(e){if(r.startsWith(e))return!0})))try{var t=JSON.parse(s.responseText);if(t&&t.error)return n.Log.error("JsonService.postForm: Error from server: ",t.error),void o(new Error(t.error))}catch(e){return n.Log.error("JsonService.postForm: Error parsing JSON response",e.message),void o(e)}o(Error(s.statusText+" ("+s.status+")"))}else{var r;if((r=s.getResponseHeader("Content-Type"))&&a.find((function(e){if(r.startsWith(e))return!0})))try{return void i(JSON.parse(s.responseText))}catch(e){return n.Log.error("JsonService.postForm: Error parsing JSON response",e.message),void o(e)}o(Error("Invalid response Content-Type: "+r+", from URL: "+e))}},s.onerror=function(){n.Log.error("JsonService.postForm: network error"),o(Error("Network Error"))};var u="";for(var c in t){var l=t[c];l&&(u.length>0&&(u+="&"),u+=encodeURIComponent(c),u+="=",u+=encodeURIComponent(l))}s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(u)}))},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.State=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r(14));t.State=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,n=t.data,i=t.created,s=t.request_type;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=r||(0,o.default)(),this._data=n,this._created="number"==typeof i&&i>0?i:parseInt(Date.now()/1e3),this._request_type=s}return e.prototype.toStorageString=function(){return i.Log.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})},e.fromStorageString=function(t){return i.Log.debug("State.fromStorageString"),new e(JSON.parse(t))},e.clearStaleState=function(t,r){var n=Date.now()/1e3-r;return t.getAllKeys().then((function(r){i.Log.debug("State.clearStaleState: got keys",r);for(var o=[],s=function(s){var a=r[s];u=t.get(a).then((function(r){var o=!1;if(r)try{var s=e.fromStorageString(r);i.Log.debug("State.clearStaleState: got item from key: ",a,s.created),s.created<=n&&(o=!0)}catch(e){i.Log.error("State.clearStaleState: Error parsing state for key",a,e.message),o=!0}else i.Log.debug("State.clearStaleState: no item in storage for key: ",a),o=!0;if(o)return i.Log.debug("State.clearStaleState: removed item for key: ",a),t.remove(a)})),o.push(u)},a=0;a<r.length;a++){var u;s(a)}return i.Log.debug("State.clearStaleState: waiting on promise count:",o.length),Promise.all(o)}))},n(e,[{key:"id",get:function(){return this._id}},{key:"data",get:function(){return this._data}},{key:"created",get:function(){return this._created}},{key:"request_type",get:function(){return this._request_type}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.OidcClient=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(5),s=r(11),a=r(12),u=r(36),c=r(37),l=r(38),h=r(13),f=r(8);t.OidcClient=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof o.OidcClientSettings?this._settings=t:this._settings=new o.OidcClientSettings(t)}return e.prototype.createSigninRequest=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.response_type,n=t.scope,o=t.redirect_uri,s=t.data,u=t.state,c=t.prompt,l=t.display,h=t.max_age,f=t.ui_locales,d=t.id_token_hint,p=t.login_hint,g=t.acr_values,m=t.resource,v=t.request,y=t.request_uri,b=t.response_mode,w=t.extraQueryParams,F=t.extraTokenParams,_=t.request_type,S=t.skipUserInfo,E=arguments[1];i.Log.debug("OidcClient.createSigninRequest");var x=this._settings.client_id;r=r||this._settings.response_type,n=n||this._settings.scope,o=o||this._settings.redirect_uri,c=c||this._settings.prompt,l=l||this._settings.display,h=h||this._settings.max_age,f=f||this._settings.ui_locales,g=g||this._settings.acr_values,m=m||this._settings.resource,b=b||this._settings.response_mode,w=w||this._settings.extraQueryParams,F=F||this._settings.extraTokenParams;var D=this._settings.authority;return a.SigninRequest.isCode(r)&&"code"!==r?Promise.reject(new Error("OpenID Connect hybrid flow is not supported")):this._metadataService.getAuthorizationEndpoint().then((function(t){i.Log.debug("OidcClient.createSigninRequest: Received authorization endpoint",t);var k=new a.SigninRequest({url:t,client_id:x,redirect_uri:o,response_type:r,scope:n,data:s||u,authority:D,prompt:c,display:l,max_age:h,ui_locales:f,id_token_hint:d,login_hint:p,acr_values:g,resource:m,request:v,request_uri:y,extraQueryParams:w,extraTokenParams:F,request_type:_,response_mode:b,client_secret:e._settings.client_secret,skipUserInfo:S}),A=k.state;return(E=E||e._stateStore).set(A.id,A.toStorageString()).then((function(){return k}))}))},e.prototype.readSigninResponseState=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i.Log.debug("OidcClient.readSigninResponseState");var n="query"===this._settings.response_mode||!this._settings.response_mode&&a.SigninRequest.isCode(this._settings.response_type)?"?":"#",o=new u.SigninResponse(e,n);return o.state?(t=t||this._stateStore,(r?t.remove.bind(t):t.get.bind(t))(o.state).then((function(e){if(!e)throw i.Log.error("OidcClient.readSigninResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:h.SigninState.fromStorageString(e),response:o}}))):(i.Log.error("OidcClient.readSigninResponseState: No state in response"),Promise.reject(new Error("No state in response")))},e.prototype.processSigninResponse=function(e,t){var r=this;return i.Log.debug("OidcClient.processSigninResponse"),this.readSigninResponseState(e,t,!0).then((function(e){var t=e.state,n=e.response;return i.Log.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),r._validator.validateSigninResponse(t,n)}))},e.prototype.createSignoutRequest=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id_token_hint,n=t.data,o=t.state,s=t.post_logout_redirect_uri,a=t.extraQueryParams,u=t.request_type,l=arguments[1];return i.Log.debug("OidcClient.createSignoutRequest"),s=s||this._settings.post_logout_redirect_uri,a=a||this._settings.extraQueryParams,this._metadataService.getEndSessionEndpoint().then((function(t){if(!t)throw i.Log.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");i.Log.debug("OidcClient.createSignoutRequest: Received end session endpoint",t);var h=new c.SignoutRequest({url:t,id_token_hint:r,post_logout_redirect_uri:s,data:n||o,extraQueryParams:a,request_type:u}),f=h.state;return f&&(i.Log.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),(l=l||e._stateStore).set(f.id,f.toStorageString())),h}))},e.prototype.readSignoutResponseState=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i.Log.debug("OidcClient.readSignoutResponseState");var n=new l.SignoutResponse(e);if(!n.state)return i.Log.debug("OidcClient.readSignoutResponseState: No state in response"),n.error?(i.Log.warn("OidcClient.readSignoutResponseState: Response was error: ",n.error),Promise.reject(new s.ErrorResponse(n))):Promise.resolve({undefined:void 0,response:n});var o=n.state;return t=t||this._stateStore,(r?t.remove.bind(t):t.get.bind(t))(o).then((function(e){if(!e)throw i.Log.error("OidcClient.readSignoutResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:f.State.fromStorageString(e),response:n}}))},e.prototype.processSignoutResponse=function(e,t){var r=this;return i.Log.debug("OidcClient.processSignoutResponse"),this.readSignoutResponseState(e,t,!0).then((function(e){var t=e.state,n=e.response;return t?(i.Log.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),r._validator.validateSignoutResponse(t,n)):(i.Log.debug("OidcClient.processSignoutResponse: No state from storage; skipping validating response"),n)}))},e.prototype.clearStaleState=function(e){return i.Log.debug("OidcClient.clearStaleState"),e=e||this._stateStore,f.State.clearStaleState(e,this.settings.staleStateAge)},n(e,[{key:"_stateStore",get:function(){return this.settings.stateStore}},{key:"_validator",get:function(){return this.settings.validator}},{key:"_metadataService",get:function(){return this.settings.metadataService}},{key:"settings",get:function(){return this._settings}},{key:"metadataService",get:function(){return this._metadataService}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenClient=void 0;var n=r(7),i=r(2),o=r(0);t.TokenClient=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.JsonService,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MetadataService;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw o.Log.error("TokenClient.ctor: No settings passed"),new Error("settings");this._settings=t,this._jsonService=new r,this._metadataService=new s(this._settings)}return e.prototype.exchangeCode=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(t=Object.assign({},t)).grant_type=t.grant_type||"authorization_code",t.client_id=t.client_id||this._settings.client_id,t.redirect_uri=t.redirect_uri||this._settings.redirect_uri,t.code?t.redirect_uri?t.code_verifier?t.client_id?this._metadataService.getTokenEndpoint(!1).then((function(r){return o.Log.debug("TokenClient.exchangeCode: Received token endpoint"),e._jsonService.postForm(r,t).then((function(e){return o.Log.debug("TokenClient.exchangeCode: response received"),e}))})):(o.Log.error("TokenClient.exchangeCode: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(o.Log.error("TokenClient.exchangeCode: No code_verifier passed"),Promise.reject(new Error("A code_verifier is required"))):(o.Log.error("TokenClient.exchangeCode: No redirect_uri passed"),Promise.reject(new Error("A redirect_uri is required"))):(o.Log.error("TokenClient.exchangeCode: No code passed"),Promise.reject(new Error("A code is required")))},e.prototype.exchangeRefreshToken=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(t=Object.assign({},t)).grant_type=t.grant_type||"refresh_token",t.client_id=t.client_id||this._settings.client_id,t.client_secret=t.client_secret||this._settings.client_secret,t.refresh_token?t.client_id?this._metadataService.getTokenEndpoint(!1).then((function(r){return o.Log.debug("TokenClient.exchangeRefreshToken: Received token endpoint"),e._jsonService.postForm(r,t).then((function(e){return o.Log.debug("TokenClient.exchangeRefreshToken: response received"),e}))})):(o.Log.error("TokenClient.exchangeRefreshToken: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(o.Log.error("TokenClient.exchangeRefreshToken: No refresh_token passed"),Promise.reject(new Error("A refresh_token is required")))},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorResponse=void 0;var n=r(0);t.ErrorResponse=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.error,o=r.error_description,s=r.error_uri,a=r.state,u=r.session_state;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!i)throw n.Log.error("No error passed to ErrorResponse"),new Error("error");var c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,o||i));return c.name="ErrorResponse",c.error=i,c.error_description=o,c.error_uri=s,c.state=a,c.session_state=u,c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(Error)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SigninRequest=void 0;var n=r(0),i=r(3),o=r(13);t.SigninRequest=function(){function e(t){var r=t.url,s=t.client_id,a=t.redirect_uri,u=t.response_type,c=t.scope,l=t.authority,h=t.data,f=t.prompt,d=t.display,p=t.max_age,g=t.ui_locales,m=t.id_token_hint,v=t.login_hint,y=t.acr_values,b=t.resource,w=t.response_mode,F=t.request,_=t.request_uri,S=t.extraQueryParams,E=t.request_type,x=t.client_secret,D=t.extraTokenParams,k=t.skipUserInfo;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!r)throw n.Log.error("SigninRequest.ctor: No url passed"),new Error("url");if(!s)throw n.Log.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!a)throw n.Log.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!u)throw n.Log.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!c)throw n.Log.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!l)throw n.Log.error("SigninRequest.ctor: No authority passed"),new Error("authority");var A=e.isOidc(u),C=e.isCode(u);w||(w=e.isCode(u)?"query":null),this.state=new o.SigninState({nonce:A,data:h,client_id:s,authority:l,redirect_uri:a,code_verifier:C,request_type:E,response_mode:w,client_secret:x,scope:c,extraTokenParams:D,skipUserInfo:k}),r=i.UrlUtility.addQueryParam(r,"client_id",s),r=i.UrlUtility.addQueryParam(r,"redirect_uri",a),r=i.UrlUtility.addQueryParam(r,"response_type",u),r=i.UrlUtility.addQueryParam(r,"scope",c),r=i.UrlUtility.addQueryParam(r,"state",this.state.id),A&&(r=i.UrlUtility.addQueryParam(r,"nonce",this.state.nonce)),C&&(r=i.UrlUtility.addQueryParam(r,"code_challenge",this.state.code_challenge),r=i.UrlUtility.addQueryParam(r,"code_challenge_method","S256"));var P={prompt:f,display:d,max_age:p,ui_locales:g,id_token_hint:m,login_hint:v,acr_values:y,resource:b,request:F,request_uri:_,response_mode:w};for(var T in P)P[T]&&(r=i.UrlUtility.addQueryParam(r,T,P[T]));for(var R in S)r=i.UrlUtility.addQueryParam(r,R,S[R]);this.url=r}return e.isOidc=function(e){return!!e.split(/\s+/g).filter((function(e){return"id_token"===e}))[0]},e.isOAuth=function(e){return!!e.split(/\s+/g).filter((function(e){return"token"===e}))[0]},e.isCode=function(e){return!!e.split(/\s+/g).filter((function(e){return"code"===e}))[0]},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SigninState=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(8),s=r(4),a=function(e){return e&&e.__esModule?e:{default:e}}(r(14));t.SigninState=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.nonce,i=r.authority,o=r.client_id,u=r.redirect_uri,c=r.code_verifier,l=r.response_mode,h=r.client_secret,f=r.scope,d=r.extraTokenParams,p=r.skipUserInfo;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var g=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,arguments[0]));if(!0===n?g._nonce=(0,a.default)():n&&(g._nonce=n),!0===c?g._code_verifier=(0,a.default)()+(0,a.default)()+(0,a.default)():c&&(g._code_verifier=c),g.code_verifier){var m=s.JoseUtil.hashString(g.code_verifier,"SHA256");g._code_challenge=s.JoseUtil.hexToBase64Url(m)}return g._redirect_uri=u,g._authority=i,g._client_id=o,g._response_mode=l,g._client_secret=h,g._scope=f,g._extraTokenParams=d,g._skipUserInfo=p,g}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.toStorageString=function(){return i.Log.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,nonce:this.nonce,code_verifier:this.code_verifier,redirect_uri:this.redirect_uri,authority:this.authority,client_id:this.client_id,response_mode:this.response_mode,client_secret:this.client_secret,scope:this.scope,extraTokenParams:this.extraTokenParams,skipUserInfo:this.skipUserInfo})},t.fromStorageString=function(e){return i.Log.debug("SigninState.fromStorageString"),new t(JSON.parse(e))},n(t,[{key:"nonce",get:function(){return this._nonce}},{key:"authority",get:function(){return this._authority}},{key:"client_id",get:function(){return this._client_id}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"code_verifier",get:function(){return this._code_verifier}},{key:"code_challenge",get:function(){return this._code_challenge}},{key:"response_mode",get:function(){return this._response_mode}},{key:"client_secret",get:function(){return this._client_secret}},{key:"scope",get:function(){return this._scope}},{key:"extraTokenParams",get:function(){return this._extraTokenParams}},{key:"skipUserInfo",get:function(){return this._skipUserInfo}}]),t}(o.State)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,n.default)().replace(/-/g,"")};var n=function(e){return e&&e.__esModule?e:{default:e}}(r(33));e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.User=function(){function e(t){var r=t.id_token,n=t.session_state,i=t.access_token,o=t.refresh_token,s=t.token_type,a=t.scope,u=t.profile,c=t.expires_at,l=t.state;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id_token=r,this.session_state=n,this.access_token=i,this.refresh_token=o,this.token_type=s,this.scope=a,this.profile=u,this.expires_at=c,this.state=l}return e.prototype.toStorageString=function(){return i.Log.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},e.fromStorageString=function(t){return i.Log.debug("User.fromStorageString"),new e(JSON.parse(t))},n(e,[{key:"expires_in",get:function(){if(this.expires_at){var e=parseInt(Date.now()/1e3);return this.expires_at-e}},set:function(e){var t=parseInt(e);if("number"==typeof t&&t>0){var r=parseInt(Date.now()/1e3);this.expires_at=r+t}}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenEvents=void 0;var n=r(0),i=r(48);t.AccessTokenEvents=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.accessTokenExpiringNotificationTime,n=void 0===r?60:r,o=t.accessTokenExpiringTimer,s=void 0===o?new i.Timer("Access token expiring"):o,a=t.accessTokenExpiredTimer,u=void 0===a?new i.Timer("Access token expired"):a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._accessTokenExpiringNotificationTime=n,this._accessTokenExpiring=s,this._accessTokenExpired=u}return e.prototype.load=function(e){if(e.access_token&&void 0!==e.expires_in){var t=e.expires_in;if(n.Log.debug("AccessTokenEvents.load: access token present, remaining duration:",t),t>0){var r=t-this._accessTokenExpiringNotificationTime;r<=0&&(r=1),n.Log.debug("AccessTokenEvents.load: registering expiring timer in:",r),this._accessTokenExpiring.init(r)}else n.Log.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();var i=t+1;n.Log.debug("AccessTokenEvents.load: registering expired timer in:",i),this._accessTokenExpired.init(i)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},e.prototype.unload=function(){n.Log.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},e.prototype.addAccessTokenExpiring=function(e){this._accessTokenExpiring.addHandler(e)},e.prototype.removeAccessTokenExpiring=function(e){this._accessTokenExpiring.removeHandler(e)},e.prototype.addAccessTokenExpired=function(e){this._accessTokenExpired.addHandler(e)},e.prototype.removeAccessTokenExpired=function(e){this._accessTokenExpired.removeHandler(e)},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=r(0);t.Event=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t,this._callbacks=[]}return e.prototype.addHandler=function(e){this._callbacks.push(e)},e.prototype.removeHandler=function(e){var t=this._callbacks.findIndex((function(t){return t===e}));t>=0&&this._callbacks.splice(t,1)},e.prototype.raise=function(){n.Log.debug("Event: Raising event: "+this._name);for(var e=0;e<this._callbacks.length;e++){var t;(t=this._callbacks)[e].apply(t,arguments)}},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SessionMonitor=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(19),s=r(1);t.SessionMonitor=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.CheckSessionIFrame,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.Global.timer;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw i.Log.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=t,this._CheckSessionIFrameCtor=n,this._timer=a,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),this._userManager.getUser().then((function(e){e?r._start(e):r._settings.monitorAnonymousSession&&r._userManager.querySessionStatus().then((function(e){var t={session_state:e.session_state};e.sub&&e.sid&&(t.profile={sub:e.sub,sid:e.sid}),r._start(t)})).catch((function(e){i.Log.error("SessionMonitor ctor: error from querySessionStatus:",e.message)}))})).catch((function(e){i.Log.error("SessionMonitor ctor: error from getUser:",e.message)}))}return e.prototype._start=function(e){var t=this,r=e.session_state;r&&(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,i.Log.debug("SessionMonitor._start: session_state:",r,", sub:",this._sub)):(this._sub=void 0,this._sid=void 0,i.Log.debug("SessionMonitor._start: session_state:",r,", anonymous user")),this._checkSessionIFrame?this._checkSessionIFrame.start(r):this._metadataService.getCheckSessionIframe().then((function(e){if(e){i.Log.debug("SessionMonitor._start: Initializing check session iframe");var n=t._client_id,o=t._checkSessionInterval,s=t._stopCheckSessionOnError;t._checkSessionIFrame=new t._CheckSessionIFrameCtor(t._callback.bind(t),n,e,o,s),t._checkSessionIFrame.load().then((function(){t._checkSessionIFrame.start(r)}))}else i.Log.warn("SessionMonitor._start: No check session iframe found in the metadata")})).catch((function(e){i.Log.error("SessionMonitor._start: Error from getCheckSessionIframe:",e.message)})))},e.prototype._stop=function(){var e=this;if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&(i.Log.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop()),this._settings.monitorAnonymousSession)var t=this._timer.setInterval((function(){e._timer.clearInterval(t),e._userManager.querySessionStatus().then((function(t){var r={session_state:t.session_state};t.sub&&t.sid&&(r.profile={sub:t.sub,sid:t.sid}),e._start(r)})).catch((function(e){i.Log.error("SessionMonitor: error from querySessionStatus:",e.message)}))}),1e3)},e.prototype._callback=function(){var e=this;this._userManager.querySessionStatus().then((function(t){var r=!0;t?t.sub===e._sub?(r=!1,e._checkSessionIFrame.start(t.session_state),t.sid===e._sid?i.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",t.session_state):(i.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",t.session_state),e._userManager.events._raiseUserSessionChanged())):i.Log.debug("SessionMonitor._callback: Different subject signed into OP:",t.sub):i.Log.debug("SessionMonitor._callback: Subject no longer signed into OP"),r&&(e._sub?(i.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),e._userManager.events._raiseUserSignedOut()):(i.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed in event"),e._userManager.events._raiseUserSignedIn()))})).catch((function(t){e._sub&&(i.Log.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",t.message),e._userManager.events._raiseUserSignedOut())}))},n(e,[{key:"_settings",get:function(){return this._userManager.settings}},{key:"_metadataService",get:function(){return this._userManager.metadataService}},{key:"_client_id",get:function(){return this._settings.client_id}},{key:"_checkSessionInterval",get:function(){return this._settings.checkSessionInterval}},{key:"_stopCheckSessionOnError",get:function(){return this._settings.stopCheckSessionOnError}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CheckSessionIFrame=void 0;var n=r(0);t.CheckSessionIFrame=function(){function e(t,r,n,i){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._callback=t,this._client_id=r,this._url=n,this._interval=i||2e3,this._stopOnError=o;var s=n.indexOf("/",n.indexOf("//")+2);this._frame_origin=n.substr(0,s),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.style.width=0,this._frame.style.height=0,this._frame.src=n}return e.prototype.load=function(){var e=this;return new Promise((function(t){e._frame.onload=function(){t()},window.document.body.appendChild(e._frame),e._boundMessageEvent=e._message.bind(e),window.addEventListener("message",e._boundMessageEvent,!1)}))},e.prototype._message=function(e){e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(n.Log.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(n.Log.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):n.Log.debug("CheckSessionIFrame: "+e.data+" message from check session op iframe"))},e.prototype.start=function(e){var t=this;if(this._session_state!==e){n.Log.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=e;var r=function(){t._frame.contentWindow.postMessage(t._client_id+" "+t._session_state,t._frame_origin)};r(),this._timer=window.setInterval(r,this._interval)}},e.prototype.stop=function(){this._session_state=null,this._timer&&(n.Log.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRevocationClient=void 0;var n=r(0),i=r(2),o=r(1);t.TokenRevocationClient=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.Global.XMLHttpRequest,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MetadataService;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw n.Log.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=t,this._XMLHttpRequestCtor=r,this._metadataService=new s(this._settings)}return e.prototype.revoke=function(e,t){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"access_token";if(!e)throw n.Log.error("TokenRevocationClient.revoke: No token provided"),new Error("No token provided.");if("access_token"!==i&&"refresh_token"!=i)throw n.Log.error("TokenRevocationClient.revoke: Invalid token type"),new Error("Invalid token type.");return this._metadataService.getRevocationEndpoint().then((function(o){if(o){n.Log.debug("TokenRevocationClient.revoke: Revoking "+i);var s=r._settings.client_id,a=r._settings.client_secret;return r._revoke(o,s,a,e,i)}if(t)throw n.Log.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")}))},e.prototype._revoke=function(e,t,r,i,o){var s=this;return new Promise((function(a,u){var c=new s._XMLHttpRequestCtor;c.open("POST",e),c.onload=function(){n.Log.debug("TokenRevocationClient.revoke: HTTP response received, status",c.status),200===c.status?a():u(Error(c.statusText+" ("+c.status+")"))},c.onerror=function(){n.Log.debug("TokenRevocationClient.revoke: Network Error."),u("Network Error")};var l="client_id="+encodeURIComponent(t);r&&(l+="&client_secret="+encodeURIComponent(r)),l+="&token_type_hint="+encodeURIComponent(o),l+="&token="+encodeURIComponent(i),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.send(l)}))},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaPopupWindow=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.CordovaPopupWindow=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t})),this.features=t.popupWindowFeatures||"location=no,toolbar=no,zoom=no",this.target=t.popupWindowTarget||"_blank",this.redirect_uri=t.startUrl,i.Log.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}return e.prototype._isInAppBrowserInstalled=function(e){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some((function(t){return e.hasOwnProperty(t)}))},e.prototype.navigate=function(e){if(e&&e.url){if(!window.cordova)return this._error("cordova is undefined");var t=window.cordova.require("cordova/plugin_list").metadata;if(!1===this._isInAppBrowserInstalled(t))return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(e.url,this.target,this.features),this._popup?(i.Log.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise},e.prototype._loadStartCallback=function(e){0===e.url.indexOf(this.redirect_uri)&&this._success({url:e.url})},e.prototype._exitCallback=function(e){this._error(e)},e.prototype._success=function(e){this._cleanup(),i.Log.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(e)},e.prototype._error=function(e){this._cleanup(),i.Log.error(e),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup()},e.prototype._cleanup=function(){this._popup&&(i.Log.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null},n(e,[{key:"promise",get:function(){return this._promise}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(9),o=r(5),s=r(6),a=r(39),u=r(40),c=r(16),l=r(2),h=r(50),f=r(51),d=r(19),p=r(20),g=r(18),m=r(1),v=r(15),y=r(52);t.default={Version:y.Version,Log:n.Log,OidcClient:i.OidcClient,OidcClientSettings:o.OidcClientSettings,WebStorageStateStore:s.WebStorageStateStore,InMemoryWebStorage:a.InMemoryWebStorage,UserManager:u.UserManager,AccessTokenEvents:c.AccessTokenEvents,MetadataService:l.MetadataService,CordovaPopupNavigator:h.CordovaPopupNavigator,CordovaIFrameNavigator:f.CordovaIFrameNavigator,CheckSessionIFrame:d.CheckSessionIFrame,TokenRevocationClient:p.TokenRevocationClient,SessionMonitor:g.SessionMonitor,Global:m.Global,User:v.User},e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseValidator=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(0),o=r(2),s=r(24),a=r(10),u=r(11),c=r(4),l=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];t.ResponseValidator=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.MetadataService,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.UserInfoService,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c.JoseUtil,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a.TokenClient;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw i.Log.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=t,this._metadataService=new r(this._settings),this._userInfoService=new n(this._settings),this._joseUtil=u,this._tokenClient=new l(this._settings)}return e.prototype.validateSigninResponse=function(e,t){var r=this;return i.Log.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(e,t).then((function(t){return i.Log.debug("ResponseValidator.validateSigninResponse: state processed"),r._validateTokens(e,t).then((function(t){return i.Log.debug("ResponseValidator.validateSigninResponse: tokens validated"),r._processClaims(e,t).then((function(e){return i.Log.debug("ResponseValidator.validateSigninResponse: claims processed"),e}))}))}))},e.prototype.validateSignoutResponse=function(e,t){return e.id!==t.state?(i.Log.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(i.Log.debug("ResponseValidator.validateSignoutResponse: state validated"),t.state=e.data,t.error?(i.Log.warn("ResponseValidator.validateSignoutResponse: Response was error",t.error),Promise.reject(new u.ErrorResponse(t))):Promise.resolve(t))},e.prototype._processSigninParams=function(e,t){if(e.id!==t.state)return i.Log.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!e.client_id)return i.Log.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!e.authority)return i.Log.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==e.authority)return i.Log.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=e.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==e.client_id)return i.Log.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=e.client_id;return i.Log.debug("ResponseValidator._processSigninParams: state validated"),t.state=e.data,t.error?(i.Log.warn("ResponseValidator._processSigninParams: Response was error",t.error),Promise.reject(new u.ErrorResponse(t))):e.nonce&&!t.id_token?(i.Log.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!e.nonce&&t.id_token?(i.Log.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):e.code_verifier&&!t.code?(i.Log.error("ResponseValidator._processSigninParams: Expecting code in response"),Promise.reject(new Error("No code in response"))):!e.code_verifier&&t.code?(i.Log.error("ResponseValidator._processSigninParams: Not expecting code in response"),Promise.reject(new Error("Unexpected code in response"))):(t.scope||(t.scope=e.scope),Promise.resolve(t))},e.prototype._processClaims=function(e,t){var r=this;if(t.isOpenIdConnect){if(i.Log.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),t.profile=this._filterProtocolClaims(t.profile),!0!==e.skipUserInfo&&this._settings.loadUserInfo&&t.access_token)return i.Log.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(t.access_token).then((function(e){return i.Log.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),e.sub!==t.profile.sub?(i.Log.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in access_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in access_token"))):(t.profile=r._mergeClaims(t.profile,e),i.Log.debug("ResponseValidator._processClaims: user info claims received, updated profile:",t.profile),t)}));i.Log.debug("ResponseValidator._processClaims: not loading user info")}else i.Log.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(t)},e.prototype._mergeClaims=function(e,t){var r=Object.assign({},e);for(var i in t){var o=t[i];Array.isArray(o)||(o=[o]);for(var s=0;s<o.length;s++){var a=o[s];r[i]?Array.isArray(r[i])?r[i].indexOf(a)<0&&r[i].push(a):r[i]!==a&&("object"===(void 0===a?"undefined":n(a))?r[i]=this._mergeClaims(r[i],a):r[i]=[r[i],a]):r[i]=a}}return r},e.prototype._filterProtocolClaims=function(e){i.Log.debug("ResponseValidator._filterProtocolClaims, incoming claims:",e);var t=Object.assign({},e);return this._settings._filterProtocolClaims?(l.forEach((function(e){delete t[e]})),i.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",t)):i.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),t},e.prototype._validateTokens=function(e,t){return t.code?(i.Log.debug("ResponseValidator._validateTokens: Validating code"),this._processCode(e,t)):t.id_token?t.access_token?(i.Log.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(e,t)):(i.Log.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(e,t)):(i.Log.debug("ResponseValidator._validateTokens: No code to process or id_token to validate"),Promise.resolve(t))},e.prototype._processCode=function(e,t){var r=this,o={client_id:e.client_id,client_secret:e.client_secret,code:t.code,redirect_uri:e.redirect_uri,code_verifier:e.code_verifier};return e.extraTokenParams&&"object"===n(e.extraTokenParams)&&Object.assign(o,e.extraTokenParams),this._tokenClient.exchangeCode(o).then((function(n){for(var o in n)t[o]=n[o];return t.id_token?(i.Log.debug("ResponseValidator._processCode: token response successful, processing id_token"),r._validateIdTokenAttributes(e,t)):(i.Log.debug("ResponseValidator._processCode: token response successful, returning response"),t)}))},e.prototype._validateIdTokenAttributes=function(e,t){var r=this;return this._metadataService.getIssuer().then((function(n){var o=e.client_id,s=r._settings.clockSkew;return i.Log.debug("ResponseValidator._validateIdTokenAttributes: Validaing JWT attributes; using clock skew (in seconds) of: ",s),r._joseUtil.validateJwtAttributes(t.id_token,n,o,s).then((function(r){return e.nonce&&e.nonce!==r.nonce?(i.Log.error("ResponseValidator._validateIdTokenAttributes: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):r.sub?(t.profile=r,t):(i.Log.error("ResponseValidator._validateIdTokenAttributes: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))},e.prototype._validateIdTokenAndAccessToken=function(e,t){var r=this;return this._validateIdToken(e,t).then((function(e){return r._validateAccessToken(e)}))},e.prototype._validateIdToken=function(e,t){var r=this;if(!e.nonce)return i.Log.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));var n=this._joseUtil.parseJwt(t.id_token);if(!n||!n.header||!n.payload)return i.Log.error("ResponseValidator._validateIdToken: Failed to parse id_token",n),Promise.reject(new Error("Failed to parse id_token"));if(e.nonce!==n.payload.nonce)return i.Log.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"));var o=n.header.kid;return this._metadataService.getIssuer().then((function(s){return i.Log.debug("ResponseValidator._validateIdToken: Received issuer"),r._metadataService.getSigningKeys().then((function(a){if(!a)return i.Log.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));i.Log.debug("ResponseValidator._validateIdToken: Received signing keys");var u=void 0;if(o)u=a.filter((function(e){return e.kid===o}))[0];else{if((a=r._filterByAlg(a,n.header.alg)).length>1)return i.Log.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));u=a[0]}if(!u)return i.Log.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var c=e.client_id,l=r._settings.clockSkew;return i.Log.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",l),r._joseUtil.validateJwt(t.id_token,u,s,c,l).then((function(){return i.Log.debug("ResponseValidator._validateIdToken: JWT validation successful"),n.payload.sub?(t.profile=n.payload,t):(i.Log.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))}))},e.prototype._filterByAlg=function(e,t){var r=null;if(t.startsWith("RS"))r="RSA";else if(t.startsWith("PS"))r="PS";else{if(!t.startsWith("ES"))return i.Log.debug("ResponseValidator._filterByAlg: alg not supported: ",t),[];r="EC"}return i.Log.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",r),e=e.filter((function(e){return e.kty===r})),i.Log.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",r,e.length),e},e.prototype._validateAccessToken=function(e){if(!e.profile)return i.Log.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!e.profile.at_hash)return i.Log.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!e.id_token)return i.Log.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));var t=this._joseUtil.parseJwt(e.id_token);if(!t||!t.header)return i.Log.error("ResponseValidator._validateAccessToken: Failed to parse id_token",t),Promise.reject(new Error("Failed to parse id_token"));var r=t.header.alg;if(!r||5!==r.length)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r),Promise.reject(new Error("Unsupported alg: "+r));var n=r.substr(2,3);if(!n)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r,n),Promise.reject(new Error("Unsupported alg: "+r));if(256!==(n=parseInt(n))&&384!==n&&512!==n)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r,n),Promise.reject(new Error("Unsupported alg: "+r));var o="sha"+n,s=this._joseUtil.hashString(e.access_token,o);if(!s)return i.Log.error("ResponseValidator._validateAccessToken: access_token hash failed:",o),Promise.reject(new Error("Failed to validate at_hash"));var a=s.substr(0,s.length/2),u=this._joseUtil.hexToBase64Url(a);return u!==e.profile.at_hash?(i.Log.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",u,e.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(i.Log.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(e))},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UserInfoService=void 0;var n=r(7),i=r(2),o=r(0),s=r(4);t.UserInfoService=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.JsonService,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MetadataService,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s.JoseUtil;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw o.Log.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=t,this._jsonService=new r(void 0,void 0,this._getClaimsFromJwt.bind(this)),this._metadataService=new a(this._settings),this._joseUtil=u}return e.prototype.getClaims=function(e){var t=this;return e?this._metadataService.getUserInfoEndpoint().then((function(r){return o.Log.debug("UserInfoService.getClaims: received userinfo url",r),t._jsonService.getJson(r,e).then((function(e){return o.Log.debug("UserInfoService.getClaims: claims received",e),e}))})):(o.Log.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))},e.prototype._getClaimsFromJwt=function e(t){var r=this;try{var n=this._joseUtil.parseJwt(t.responseText);if(!n||!n.header||!n.payload)return o.Log.error("UserInfoService._getClaimsFromJwt: Failed to parse JWT",n),Promise.reject(new Error("Failed to parse id_token"));var i=n.header.kid,s=void 0;switch(this._settings.userInfoJwtIssuer){case"OP":s=this._metadataService.getIssuer();break;case"ANY":s=Promise.resolve(n.payload.iss);break;default:s=Promise.resolve(this._settings.userInfoJwtIssuer)}return s.then((function(e){return o.Log.debug("UserInfoService._getClaimsFromJwt: Received issuer:"+e),r._metadataService.getSigningKeys().then((function(s){if(!s)return o.Log.error("UserInfoService._getClaimsFromJwt: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));o.Log.debug("UserInfoService._getClaimsFromJwt: Received signing keys");var a=void 0;if(i)a=s.filter((function(e){return e.kid===i}))[0];else{if((s=r._filterByAlg(s,n.header.alg)).length>1)return o.Log.error("UserInfoService._getClaimsFromJwt: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));a=s[0]}if(!a)return o.Log.error("UserInfoService._getClaimsFromJwt: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var u=r._settings.client_id,c=r._settings.clockSkew;return o.Log.debug("UserInfoService._getClaimsFromJwt: Validaing JWT; using clock skew (in seconds) of: ",c),r._joseUtil.validateJwt(t.responseText,a,e,u,c,void 0,!0).then((function(){return o.Log.debug("UserInfoService._getClaimsFromJwt: JWT validation successful"),n.payload}))}))}))}catch(e){return o.Log.error("UserInfoService._getClaimsFromJwt: Error parsing JWT response",e.message),void reject(e)}},e.prototype._filterByAlg=function(e,t){var r=null;if(t.startsWith("RS"))r="RSA";else if(t.startsWith("PS"))r="PS";else{if(!t.startsWith("ES"))return o.Log.debug("UserInfoService._filterByAlg: alg not supported: ",t),[];r="EC"}return o.Log.debug("UserInfoService._filterByAlg: Looking for keys that match kty: ",r),e=e.filter((function(e){return e.kty===r})),o.Log.debug("UserInfoService._filterByAlg: Number of keys that match kty: ",r,e.length),e},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AllowedSigningAlgs=t.b64tohex=t.hextob64u=t.crypto=t.X509=t.KeyUtil=t.jws=void 0;var n=r(26);t.jws=n.jws,t.KeyUtil=n.KEYUTIL,t.X509=n.X509,t.crypto=n.crypto,t.hextob64u=n.hextob64u,t.b64tohex=n.b64tohex,t.AllowedSigningAlgs=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"]},function(e,t,r){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=!1,i={};
/*!
    Copyright (c) 2011, Yahoo! Inc. All rights reserved.
    Code licensed under the BSD License:
    http://developer.yahoo.com/yui/license.html
    version: 2.9.0
    */if(void 0===o)var o={};o.lang={extend:function(e,t,r){if(!t||!e)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var i=function(){};if(i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t),r){var o;for(o in r)e.prototype[o]=r[o];var s=function(){},a=["toString","valueOf"];try{/MSIE/.test(n)&&(s=function(e,t){for(o=0;o<a.length;o+=1){var r=a[o],n=t[r];"function"==typeof n&&n!=Object.prototype[r]&&(e[r]=n)}})}catch(e){}s(e.prototype,r)}}};
/*! CryptoJS v3.1.2 core-fix.js
     * code.google.com/p/crypto-js
     * (c) 2009-2013 by Jeff Mott. All rights reserved.
     * code.google.com/p/crypto-js/wiki/License
     * THIS IS FIX of 'core.js' to fix Hmac issue.
     * https://code.google.com/p/crypto-js/issues/detail?id=84
     * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
     */
var s,a,u,c,l,h,f,d,p,g,m,v=v||(s=Math,u=(a={}).lib={},c=u.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var r=new e;return t&&r.mixIn(t),r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=u.WordArray=c.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||f).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var s=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=s<<24-(n+o)%4*8}else for(o=0;o<i;o+=4)t[n+o>>>2]=r[o>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=s.ceil(t/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(4294967296*s.random()|0);return new l.init(t,e)}}),h=a.enc={},f=h.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new l.init(r,t/2)}},d=h.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new l.init(r,t)}},p=h.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},g=u.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,r=t.words,n=t.sigBytes,i=this.blockSize,o=n/(4*i),a=(o=e?s.ceil(o):s.max((0|o)-this._minBufferSize,0))*i,u=s.min(4*a,n);if(a){for(var c=0;c<a;c+=i)this._doProcessBlock(r,c);var h=r.splice(0,a);t.sigBytes-=u}return new l.init(h,u)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),u.Hasher=g.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new m.HMAC.init(e,r).finalize(t)}}}),m=a.algo={},a);!function(e){var t,r=(t=v).lib,n=r.Base,i=r.WordArray;(t=t.x64={}).Word=n.extend({init:function(e,t){this.high=e,this.low=t}}),t.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],n=0;n<t;n++){var o=e[n];r.push(o.high),r.push(o.low)}return i.create(r,this.sigBytes)},clone:function(){for(var e=n.clone.call(this),t=e.words=this.words.slice(0),r=t.length,i=0;i<r;i++)t[i]=t[i].clone();return e}})}(),function(){var e=v,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp(),e=[];for(var i=0;i<r;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;4>s&&i+.75*s<r;s++)e.push(n.charAt(o>>>6*(3-s)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var r=e.length,n=this._map;(i=n.charAt(64))&&-1!=(i=e.indexOf(i))&&(r=i);for(var i=[],o=0,s=0;s<r;s++)if(s%4){var a=n.indexOf(e.charAt(s-1))<<s%4*2,u=n.indexOf(e.charAt(s))>>>6-s%4*2;i[o>>>2]|=(a|u)<<24-o%4*8,o++}return t.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){for(var t=v,r=(i=t.lib).WordArray,n=i.Hasher,i=t.algo,o=[],s=[],a=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var h=e.sqrt(l),f=2;f<=h;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(8>c&&(o[c]=a(e.pow(u,.5))),s[c]=a(e.pow(u,1/3)),c++),u++}var d=[];i=i.SHA256=n.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],u=r[4],c=r[5],l=r[6],h=r[7],f=0;64>f;f++){if(16>f)d[f]=0|e[t+f];else{var p=d[f-15],g=d[f-2];d[f]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+d[f-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+d[f-16]}p=h+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+s[f]+d[f],g=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&i^n&o^i&o),h=l,l=c,c=u,u=a+p|0,a=o,o=i,i=n,n=p+g|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+u|0,r[5]=r[5]+c|0,r[6]=r[6]+l|0,r[7]=r[7]+h|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA256=n._createHelper(i),t.HmacSHA256=n._createHmacHelper(i)}(Math),function(){function e(){return n.create.apply(n,arguments)}for(var t=v,r=t.lib.Hasher,n=(o=t.x64).Word,i=o.WordArray,o=t.algo,s=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],a=[],u=0;80>u;u++)a[u]=e();o=o.SHA512=r.extend({_doReset:function(){this._hash=new i.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=(h=this._hash.words)[0],n=h[1],i=h[2],o=h[3],u=h[4],c=h[5],l=h[6],h=h[7],f=r.high,d=r.low,p=n.high,g=n.low,m=i.high,v=i.low,y=o.high,b=o.low,w=u.high,F=u.low,_=c.high,S=c.low,E=l.high,x=l.low,D=h.high,k=h.low,A=f,C=d,P=p,T=g,R=m,B=v,I=y,j=b,$=w,L=F,N=_,O=S,U=E,M=x,H=D,q=k,V=0;80>V;V++){var K=a[V];if(16>V)var z=K.high=0|e[t+2*V],J=K.low=0|e[t+2*V+1];else{z=((J=(z=a[V-15]).high)>>>1|(W=z.low)<<31)^(J>>>8|W<<24)^J>>>7;var W=(W>>>1|J<<31)^(W>>>8|J<<24)^(W>>>7|J<<25),Y=((J=(Y=a[V-2]).high)>>>19|(G=Y.low)<<13)^(J<<3|G>>>29)^J>>>6,G=(G>>>19|J<<13)^(G<<3|J>>>29)^(G>>>6|J<<26),X=(J=a[V-7]).high,Z=(Q=a[V-16]).high,Q=Q.low;z=(z=(z=z+X+((J=W+J.low)>>>0<W>>>0?1:0))+Y+((J+=G)>>>0<G>>>0?1:0))+Z+((J+=Q)>>>0<Q>>>0?1:0),K.high=z,K.low=J}X=$&N^~$&U,Q=L&O^~L&M,K=A&P^A&R^P&R;var ee=C&T^C&B^T&B,te=(W=(A>>>28|C<<4)^(A<<30|C>>>2)^(A<<25|C>>>7),Y=(C>>>28|A<<4)^(C<<30|A>>>2)^(C<<25|A>>>7),(G=s[V]).high),re=G.low;Z=(Z=(Z=(Z=H+(($>>>14|L<<18)^($>>>18|L<<14)^($<<23|L>>>9))+((G=q+((L>>>14|$<<18)^(L>>>18|$<<14)^(L<<23|$>>>9)))>>>0<q>>>0?1:0))+X+((G+=Q)>>>0<Q>>>0?1:0))+te+((G+=re)>>>0<re>>>0?1:0))+z+((G+=J)>>>0<J>>>0?1:0),H=U,q=M,U=N,M=O,N=$,O=L,$=I+Z+((L=j+G|0)>>>0<j>>>0?1:0)|0,I=R,j=B,R=P,B=T,P=A,T=C,A=Z+(K=W+K+((J=Y+ee)>>>0<Y>>>0?1:0))+((C=G+J|0)>>>0<G>>>0?1:0)|0}d=r.low=d+C,r.high=f+A+(d>>>0<C>>>0?1:0),g=n.low=g+T,n.high=p+P+(g>>>0<T>>>0?1:0),v=i.low=v+B,i.high=m+R+(v>>>0<B>>>0?1:0),b=o.low=b+j,o.high=y+I+(b>>>0<j>>>0?1:0),F=u.low=F+L,u.high=w+$+(F>>>0<L>>>0?1:0),S=c.low=S+O,c.high=_+N+(S>>>0<O>>>0?1:0),x=l.low=x+M,l.high=E+U+(x>>>0<M>>>0?1:0),k=h.low=k+q,h.high=D+H+(k>>>0<q>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(n+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32}),t.SHA512=r._createHelper(o),t.HmacSHA512=r._createHmacHelper(o)}(),function(){var e=v,t=(i=e.x64).Word,r=i.WordArray,n=(i=e.algo).SHA512,i=i.SHA384=n.extend({_doReset:function(){this._hash=new r.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=n._createHelper(i),e.HmacSHA384=n._createHmacHelper(i)}();
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
     */
var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function b(e){var t,r,n="";for(t=0;t+3<=e.length;t+=3)r=parseInt(e.substring(t,t+3),16),n+=y.charAt(r>>6)+y.charAt(63&r);for(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=y.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=y.charAt(r>>2)+y.charAt((3&r)<<4));(3&n.length)>0;)n+="=";return n}function w(e){var t,r,n,i="",o=0;for(t=0;t<e.length&&"="!=e.charAt(t);++t)(n=y.indexOf(e.charAt(t)))<0||(0==o?(i+=k(n>>2),r=3&n,o=1):1==o?(i+=k(r<<2|n>>4),r=15&n,o=2):2==o?(i+=k(r),i+=k(n>>2),r=3&n,o=3):(i+=k(r<<2|n>>4),i+=k(15&n),o=0));return 1==o&&(i+=k(r<<2)),i}function F(e){var t,r=w(e),n=new Array;for(t=0;2*t<r.length;++t)n[t]=parseInt(r.substring(2*t,2*t+2),16);return n}function _(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function S(){return new _(null)}_.prototype.am=function(e,t,r,n,i,o){for(;--o>=0;){var s=t*this[e++]+r[n]+i;i=Math.floor(s/67108864),r[n++]=67108863&s}return i},_.prototype.DB=26,_.prototype.DM=67108863,_.prototype.DV=1<<26,_.prototype.FV=Math.pow(2,52),_.prototype.F1=26,_.prototype.F2=0;var E,x,D=new Array;for(E="0".charCodeAt(0),x=0;x<=9;++x)D[E++]=x;for(E="a".charCodeAt(0),x=10;x<36;++x)D[E++]=x;for(E="A".charCodeAt(0),x=10;x<36;++x)D[E++]=x;function k(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function A(e,t){var r=D[e.charCodeAt(t)];return null==r?-1:r}function C(e){var t=S();return t.fromInt(e),t}function P(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function T(e){this.m=e}function R(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function B(e,t){return e&t}function I(e,t){return e|t}function j(e,t){return e^t}function $(e,t){return e&~t}function L(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function N(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function O(){}function U(e){return e}function M(e){this.r2=S(),this.q3=S(),_.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}T.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},T.prototype.revert=function(e){return e},T.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},T.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},T.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},R.prototype.convert=function(e){var t=S();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(_.ZERO)>0&&this.m.subTo(t,t),t},R.prototype.revert=function(e){var t=S();return e.copyTo(t),this.reduce(t),t},R.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},R.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},R.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},_.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},_.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},_.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,o=0;--n>=0;){var s=8==r?255&e[n]:A(e,n);s<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==o?this[this.t++]=s:o+r>this.DB?(this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this[this.t++]=s>>this.DB-o):this[this.t-1]|=s<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&_.ZERO.subTo(this,this)},_.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},_.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},_.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},_.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+s+1]=this[r]>>i|a,a=(this[r]&o)<<n;for(r=s-1;r>=0;--r)t[r]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},_.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)t[s-r-1]|=(this[s]&o)<<i,t[s-r]=this[s]>>n;n>0&&(t[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}},_.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},_.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t[i]=0;for(i=0;i<n.t;++i)t[i+r.t]=r.am(0,n[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&_.ZERO.subTo(t,t)},_.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},_.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=S());var o=S(),s=this.s,a=e.s,u=this.DB-P(n[n.t-1]);u>0?(n.lShiftTo(u,o),i.lShiftTo(u,r)):(n.copyTo(o),i.copyTo(r));var c=o.t,l=o[c-1];if(0!=l){var h=l*(1<<this.F1)+(c>1?o[c-2]>>this.F2:0),f=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,m=g-c,v=null==t?S():t;for(o.dlShiftTo(m,v),r.compareTo(v)>=0&&(r[r.t++]=1,r.subTo(v,r)),_.ONE.dlShiftTo(c,v),v.subTo(o,o);o.t<c;)o[o.t++]=0;for(;--m>=0;){var y=r[--g]==l?this.DM:Math.floor(r[g]*f+(r[g-1]+p)*d);if((r[g]+=o.am(0,y,r,m,0,c))<y)for(o.dlShiftTo(m,v),r.subTo(v,r);r[g]<--y;)r.subTo(v,r)}null!=t&&(r.drShiftTo(c,t),s!=a&&_.ZERO.subTo(t,t)),r.t=c,r.clamp(),u>0&&r.rShiftTo(u,r),s<0&&_.ZERO.subTo(r,r)}}},_.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},_.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},_.prototype.exp=function(e,t){if(e>4294967295||e<1)return _.ONE;var r=S(),n=S(),i=t.convert(this),o=P(e)-1;for(i.copyTo(r);--o>=0;)if(t.sqrTo(r,n),(e&1<<o)>0)t.mulTo(n,i,r);else{var s=r;r=n,n=s}return t.revert(r)},_.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(r=this[s]>>a)>0&&(i=!0,o=k(r));s>=0;)a<t?(r=(this[s]&(1<<a)-1)<<t-a,r|=this[--s]>>(a+=this.DB-t)):(r=this[s]>>(a-=t)&n,a<=0&&(a+=this.DB,--s)),r>0&&(i=!0),i&&(o+=k(r));return i?o:"0"},_.prototype.negate=function(){var e=S();return _.ZERO.subTo(this,e),e},_.prototype.abs=function(){return this.s<0?this.negate():this},_.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},_.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+P(this[this.t-1]^this.s&this.DM)},_.prototype.mod=function(e){var t=S();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(_.ZERO)>0&&e.subTo(t,t),t},_.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new T(t):new R(t),this.exp(e,r)},_.ZERO=C(0),_.ONE=C(1),O.prototype.convert=U,O.prototype.revert=U,O.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},O.prototype.sqrTo=function(e,t){e.squareTo(t)},M.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=S();return e.copyTo(t),this.reduce(t),t},M.prototype.revert=function(e){return e},M.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},M.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},M.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var H,q,V,K=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],z=(1<<26)/K[K.length-1];
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
     */function J(){this.i=0,this.j=0,this.S=new Array}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
     */
function W(){!function(e){q[V++]^=255&e,q[V++]^=e>>8&255,q[V++]^=e>>16&255,q[V++]^=e>>24&255,V>=256&&(V-=256)}((new Date).getTime())}if(_.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},_.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=C(r),i=S(),o=S(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(e).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(e)+s},_.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,o=0,s=0,a=0;a<e.length;++a){var u=A(e,a);u<0?"-"==e.charAt(a)&&0==this.signum()&&(i=!0):(s=t*s+u,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(s,0)),i&&_.ZERO.subTo(this,this)},_.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(_.ONE.shiftLeft(e-1),I,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(_.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},_.prototype.bitwiseTo=function(e,t,r){var n,i,o=Math.min(e.t,this.t);for(n=0;n<o;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=o;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},_.prototype.changeBit=function(e,t){var r=_.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},_.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},_.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},_.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},_.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r[--i]=0;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,e[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e[i],r,i,0,t-i);r.clamp()},_.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},_.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},_.prototype.millerRabin=function(e){var t=this.subtract(_.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);(e=e+1>>1)>K.length&&(e=K.length);for(var i=S(),o=0;o<e;++o){i.fromInt(K[Math.floor(Math.random()*K.length)]);var s=i.modPow(n,this);if(0!=s.compareTo(_.ONE)&&0!=s.compareTo(t)){for(var a=1;a++<r&&0!=s.compareTo(t);)if(0==(s=s.modPowInt(2,this)).compareTo(_.ONE))return!1;if(0!=s.compareTo(t))return!1}}return!0},_.prototype.clone=
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
     */
function(){var e=S();return this.copyTo(e),e},_.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},_.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},_.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},_.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},_.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},_.prototype.equals=function(e){return 0==this.compareTo(e)},_.prototype.min=function(e){return this.compareTo(e)<0?this:e},_.prototype.max=function(e){return this.compareTo(e)>0?this:e},_.prototype.and=function(e){var t=S();return this.bitwiseTo(e,B,t),t},_.prototype.or=function(e){var t=S();return this.bitwiseTo(e,I,t),t},_.prototype.xor=function(e){var t=S();return this.bitwiseTo(e,j,t),t},_.prototype.andNot=function(e){var t=S();return this.bitwiseTo(e,$,t),t},_.prototype.not=function(){for(var e=S(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},_.prototype.shiftLeft=function(e){var t=S();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},_.prototype.shiftRight=function(e){var t=S();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},_.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+L(this[e]);return this.s<0?this.t*this.DB:-1},_.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=N(this[r]^t);return e},_.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},_.prototype.setBit=function(e){return this.changeBit(e,I)},_.prototype.clearBit=function(e){return this.changeBit(e,$)},_.prototype.flipBit=function(e){return this.changeBit(e,j)},_.prototype.add=function(e){var t=S();return this.addTo(e,t),t},_.prototype.subtract=function(e){var t=S();return this.subTo(e,t),t},_.prototype.multiply=function(e){var t=S();return this.multiplyTo(e,t),t},_.prototype.divide=function(e){var t=S();return this.divRemTo(e,t,null),t},_.prototype.remainder=function(e){var t=S();return this.divRemTo(e,null,t),t},_.prototype.divideAndRemainder=function(e){var t=S(),r=S();return this.divRemTo(e,t,r),new Array(t,r)},_.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),o=C(1);if(i<=0)return o;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new T(t):t.isEven()?new M(t):new R(t);var s=new Array,a=3,u=r-1,c=(1<<r)-1;if(s[1]=n.convert(this),r>1){var l=S();for(n.sqrTo(s[1],l);a<=c;)s[a]=S(),n.mulTo(l,s[a-2],s[a]),a+=2}var h,f,d=e.t-1,p=!0,g=S();for(i=P(e[d])-1;d>=0;){for(i>=u?h=e[d]>>i-u&c:(h=(e[d]&(1<<i+1)-1)<<u-i,d>0&&(h|=e[d-1]>>this.DB+i-u)),a=r;0==(1&h);)h>>=1,--a;if((i-=a)<0&&(i+=this.DB,--d),p)s[h].copyTo(o),p=!1;else{for(;a>1;)n.sqrTo(o,g),n.sqrTo(g,o),a-=2;a>0?n.sqrTo(o,g):(f=o,o=g,g=f),n.mulTo(g,s[h],o)}for(;d>=0&&0==(e[d]&1<<i);)n.sqrTo(o,g),f=o,o=g,g=f,--i<0&&(i=this.DB-1,--d)}return n.revert(o)},_.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return _.ZERO;for(var r=e.clone(),n=this.clone(),i=C(1),o=C(0),s=C(0),a=C(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(e,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(s.isEven()&&a.isEven()||(s.addTo(this,s),a.subTo(e,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),t&&s.subTo(i,s),a.subTo(o,a))}return 0!=n.compareTo(_.ONE)?_.ZERO:a.compareTo(e)>=0?a.subtract(e):a.signum()<0?(a.addTo(e,a),a.signum()<0?a.add(e):a):a},_.prototype.pow=function(e){return this.exp(e,new O)},_.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},_.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=K[K.length-1]){for(t=0;t<K.length;++t)if(r[0]==K[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<K.length;){for(var n=K[t],i=t+1;i<K.length&&n<z;)n*=K[i++];for(n=r.modInt(n);t<i;)if(n%K[t++]==0)return!1}return r.millerRabin(e)},_.prototype.square=function(){var e=S();return this.squareTo(e),e},J.prototype.init=function(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0},J.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]},null==q){var Y;if(q=new Array,V=0,void 0!==i&&void 0!==i.msCrypto){var G=i.msCrypto;if(G.getRandomValues){var X=new Uint8Array(32);for(G.getRandomValues(X),Y=0;Y<32;++Y)q[V++]=X[Y]}}for(;V<256;)Y=Math.floor(65536*Math.random()),q[V++]=Y>>>8,q[V++]=255&Y;V=0,W()}function Z(){if(null==H){for(W(),(H=new J).init(q),V=0;V<q.length;++V)q[V]=0;V=0}return H.next()}function Q(){}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
     */function ee(e,t){return new _(e,t)}function te(e,t,r){for(var n="",i=0;n.length<t;)n+=r(String.fromCharCode.apply(String,e.concat([(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i]))),i+=1;return n}function re(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
     */}function ne(e,t){this.x=t,this.q=e}function ie(e,t,r,n){this.curve=e,this.x=t,this.y=r,this.z=null==n?_.ONE:n,this.zinv=null}function oe(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new ie(this,null,null)}Q.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=Z()},re.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},re.prototype.setPublic=function(e,t){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof e)this.n=e,this.e=t;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA public key";this.n=ee(e,16),this.e=parseInt(t,16)}},re.prototype.encrypt=function(e){var t=function(e,t){if(t<e.length+11)throw"Message too long for RSA";for(var r=new Array,n=e.length-1;n>=0&&t>0;){var i=e.charCodeAt(n--);i<128?r[--t]=i:i>127&&i<2048?(r[--t]=63&i|128,r[--t]=i>>6|192):(r[--t]=63&i|128,r[--t]=i>>6&63|128,r[--t]=i>>12|224)}r[--t]=0;for(var o=new Q,s=new Array;t>2;){for(s[0]=0;0==s[0];)o.nextBytes(s);r[--t]=s[0]}return r[--t]=2,r[--t]=0,new _(r)}(e,this.n.bitLength()+7>>3);if(null==t)return null;var r=this.doPublic(t);if(null==r)return null;var n=r.toString(16);return 0==(1&n.length)?n:"0"+n},re.prototype.encryptOAEP=function(e,t,r){var n=function(e,t,r,n){var i=ae.crypto.MessageDigest,o=ae.crypto.Util,s=null;if(r||(r="sha1"),"string"==typeof r&&(s=i.getCanonicalAlgName(r),n=i.getHashLength(s),r=function(e){return Fe(o.hashHex(_e(e),s))}),e.length+2*n+2>t)throw"Message too long for RSA";var a,u="";for(a=0;a<t-e.length-2*n-2;a+=1)u+="\0";var c=r("")+u+""+e,l=new Array(n);(new Q).nextBytes(l);var h=te(l,c.length,r),f=[];for(a=0;a<c.length;a+=1)f[a]=c.charCodeAt(a)^h.charCodeAt(a);var d=te(f,l.length,r),p=[0];for(a=0;a<l.length;a+=1)p[a+1]=l[a]^d.charCodeAt(a);return new _(p.concat(f))}(e,this.n.bitLength()+7>>3,t,r);if(null==n)return null;var i=this.doPublic(n);if(null==i)return null;var o=i.toString(16);return 0==(1&o.length)?o:"0"+o},re.prototype.type="RSA",ne.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.x.equals(e.x)},ne.prototype.toBigInteger=function(){return this.x},ne.prototype.negate=function(){return new ne(this.q,this.x.negate().mod(this.q))},ne.prototype.add=function(e){return new ne(this.q,this.x.add(e.toBigInteger()).mod(this.q))},ne.prototype.subtract=function(e){return new ne(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))},ne.prototype.multiply=function(e){return new ne(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))},ne.prototype.square=function(){return new ne(this.q,this.x.square().mod(this.q))},ne.prototype.divide=function(e){return new ne(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))},ie.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ie.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ie.prototype.equals=function(e){return e==this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(_.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(_.ZERO))},ie.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(_.ZERO)&&!this.y.toBigInteger().equals(_.ZERO)},ie.prototype.negate=function(){return new ie(this.curve,this.x,this.y.negate(),this.z)},ie.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(_.ZERO.equals(r))return _.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new _("3"),i=this.x.toBigInteger(),o=this.y.toBigInteger(),s=(e.x.toBigInteger(),e.y.toBigInteger(),r.square()),a=s.multiply(r),u=i.multiply(s),c=t.square().multiply(this.z),l=c.subtract(u.shiftLeft(1)).multiply(e.z).subtract(a).multiply(r).mod(this.curve.q),h=u.multiply(n).multiply(t).subtract(o.multiply(a)).subtract(c.multiply(t)).multiply(e.z).add(t.multiply(a)).mod(this.curve.q),f=a.multiply(this.z).multiply(e.z).mod(this.curve.q);return new ie(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(h),f)},ie.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new _("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),i=n.multiply(r).mod(this.curve.q),o=this.curve.a.toBigInteger(),s=t.square().multiply(e);_.ZERO.equals(o)||(s=s.add(this.z.square().multiply(o)));var a=(s=s.mod(this.curve.q)).square().subtract(t.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(n).mod(this.curve.q),u=s.multiply(e).multiply(t).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(s.square().multiply(s)).mod(this.curve.q),c=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new ie(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(u),c)},ie.prototype.multiply=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,r=e,n=r.multiply(new _("3")),i=this.negate(),o=this;for(t=n.bitLength()-2;t>0;--t){o=o.twice();var s=n.testBit(t);s!=r.testBit(t)&&(o=o.add(s?this:i))}return o},ie.prototype.multiplyTwo=function(e,t,r){var n;n=e.bitLength()>r.bitLength()?e.bitLength()-1:r.bitLength()-1;for(var i=this.curve.getInfinity(),o=this.add(t);n>=0;)i=i.twice(),e.testBit(n)?i=r.testBit(n)?i.add(o):i.add(this):r.testBit(n)&&(i=i.add(t)),--n;return i},oe.prototype.getQ=function(){return this.q},oe.prototype.getA=function(){return this.a},oe.prototype.getB=function(){return this.b},oe.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)},oe.prototype.getInfinity=function(){return this.infinity},oe.prototype.fromBigInteger=function(e){return new ne(this.q,e)},oe.prototype.decodePointHex=function(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var t=(e.length-2)/2,r=e.substr(2,t),n=e.substr(t+2,t);return new ie(this,this.fromBigInteger(new _(r,16)),this.fromBigInteger(new _(n,16)));default:return null}},
/*! (c) Stefan Thomas | https://github.com/bitcoinjs/bitcoinjs-lib
     */
ne.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ie.prototype.getEncoded=function(e){var t=function(e,t){var r=e.toByteArrayUnsigned();if(t<r.length)r=r.slice(r.length-t);else for(;t>r.length;)r.unshift(0);return r},r=this.getX().toBigInteger(),n=this.getY().toBigInteger(),i=t(r,32);return e?n.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(t(n,32))),i},ie.decodeFrom=function(e,t){t[0];var r=t.length-1,n=t.slice(1,1+r/2),i=t.slice(1+r/2,1+r);n.unshift(0),i.unshift(0);var o=new _(n),s=new _(i);return new ie(e,e.fromBigInteger(o),e.fromBigInteger(s))},ie.decodeFromHex=function(e,t){t.substr(0,2);var r=t.length-2,n=t.substr(2,r/2),i=t.substr(2+r/2,r/2),o=new _(n,16),s=new _(i,16);return new ie(e,e.fromBigInteger(o),e.fromBigInteger(s))},ie.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),r=e.y.subtract(this.y).divide(t),n=r.square().subtract(this.x).subtract(e.x),i=r.multiply(this.x.subtract(n)).subtract(this.y);return new ie(this.curve,n,i)},ie.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=this.curve.fromBigInteger(_.valueOf(2)),t=this.curve.fromBigInteger(_.valueOf(3)),r=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),n=r.square().subtract(this.x.multiply(e)),i=r.multiply(this.x.subtract(n)).subtract(this.y);return new ie(this.curve,n,i)},ie.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,r=e,n=r.multiply(new _("3")),i=this.negate(),o=this;for(t=n.bitLength()-2;t>0;--t){o=o.twice();var s=n.testBit(t);s!=r.testBit(t)&&(o=o.add2D(s?this:i))}return o},ie.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),i=this.curve.getQ(),o=t.multiply(t).mod(i),s=e.multiply(e).multiply(e).add(r.multiply(e)).add(n).mod(i);return o.equals(s)},ie.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ie.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),r=this.getY().toBigInteger();if(t.compareTo(_.ONE)<0||t.compareTo(e.subtract(_.ONE))>0)throw new Error("x coordinate out of bounds");if(r.compareTo(_.ONE)<0||r.compareTo(e.subtract(_.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};
/*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
     */
var se=function(){var e=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),t=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),n={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function i(e,t,r){return t?n[t]:String.fromCharCode(parseInt(r,16))}var o=new String(""),s=Object.hasOwnProperty;return function(n,a){var u,c,l=n.match(e),h=l[0],f=!1;"{"===h?u={}:"["===h?u=[]:(u=[],f=!0);for(var d=[u],p=1-f,g=l.length;p<g;++p){var m;switch((h=l[p]).charCodeAt(0)){default:(m=d[0])[c||m.length]=+h,c=void 0;break;case 34:if(-1!==(h=h.substring(1,h.length-1)).indexOf("\\")&&(h=h.replace(t,i)),m=d[0],!c){if(!(m instanceof Array)){c=h||o;break}c=m.length}m[c]=h,c=void 0;break;case 91:m=d[0],d.unshift(m[c||m.length]=[]),c=void 0;break;case 93:d.shift();break;case 102:(m=d[0])[c||m.length]=!1,c=void 0;break;case 110:(m=d[0])[c||m.length]=null,c=void 0;break;case 116:(m=d[0])[c||m.length]=!0,c=void 0;break;case 123:m=d[0],d.unshift(m[c||m.length]={}),c=void 0;break;case 125:d.shift()}}if(f){if(1!==d.length)throw new Error;u=u[0]}else if(d.length)throw new Error;return a&&(u=function e(t,n){var i=t[n];if(i&&"object"===(void 0===i?"undefined":r(i))){var o=null;for(var u in i)if(s.call(i,u)&&i!==t){var c=e(i,u);void 0!==c?i[u]=c:(o||(o=[]),o.push(u))}if(o)for(var l=o.length;--l>=0;)delete i[o[l]]}return a.call(t,n,i)}({"":u},"")),u}}();void 0!==ae&&ae||(t.KJUR=ae={}),void 0!==ae.asn1&&ae.asn1||(ae.asn1={}),ae.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){var t=e.toString(16);if("-"!=t.substr(0,1))t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var r=t.substr(1).length;r%2==1?r+=1:t.match(/^[0-7]/)||(r+=2);for(var n="",i=0;i<r;i++)n+="f";t=new _(n,16).xor(e).add(_.ONE).toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(e,t){return De(e,t)},this.newObject=function(e){var t=ae.asn1,r=t.DERBoolean,n=t.DERInteger,i=t.DERBitString,o=t.DEROctetString,s=t.DERNull,a=t.DERObjectIdentifier,u=t.DEREnumerated,c=t.DERUTF8String,l=t.DERNumericString,h=t.DERPrintableString,f=t.DERTeletexString,d=t.DERIA5String,p=t.DERUTCTime,g=t.DERGeneralizedTime,m=t.DERSequence,v=t.DERSet,y=t.DERTaggedObject,b=t.ASN1Util.newObject,w=Object.keys(e);if(1!=w.length)throw"key of param shall be only one.";var F=w[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+F+":"))throw"undefined key: "+F;if("bool"==F)return new r(e[F]);if("int"==F)return new n(e[F]);if("bitstr"==F)return new i(e[F]);if("octstr"==F)return new o(e[F]);if("null"==F)return new s(e[F]);if("oid"==F)return new a(e[F]);if("enum"==F)return new u(e[F]);if("utf8str"==F)return new c(e[F]);if("numstr"==F)return new l(e[F]);if("prnstr"==F)return new h(e[F]);if("telstr"==F)return new f(e[F]);if("ia5str"==F)return new d(e[F]);if("utctime"==F)return new p(e[F]);if("gentime"==F)return new g(e[F]);if("seq"==F){for(var _=e[F],S=[],E=0;E<_.length;E++){var x=b(_[E]);S.push(x)}return new m({array:S})}if("set"==F){for(_=e[F],S=[],E=0;E<_.length;E++)x=b(_[E]),S.push(x);return new v({array:S})}if("tag"==F){var D=e[F];if("[object Array]"===Object.prototype.toString.call(D)&&3==D.length){var k=b(D[2]);return new y({tag:D[0],explicit:D[1],obj:k})}var A={};if(void 0!==D.explicit&&(A.explicit=D.explicit),void 0!==D.tag&&(A.tag=D.tag),void 0===D.obj)throw"obj shall be specified for 'tag'.";return A.obj=b(D.obj),new y(A)}},this.jsonToASN1HEX=function(e){return this.newObject(e).getEncodedHex()}},ae.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",r=parseInt(e.substr(0,2),16),n=(t=Math.floor(r/40)+"."+r%40,""),i=2;i<e.length;i+=2){var o=("00000000"+parseInt(e.substr(i,2),16).toString(2)).slice(-8);n+=o.substr(1,7),"0"==o.substr(0,1)&&(t=t+"."+new _(n,2).toString(10),n="")}return t},ae.asn1.ASN1Util.oidIntToHex=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},r=function(e){var r="",n=new _(e,10).toString(2),i=7-n.length%7;7==i&&(i=0);for(var o="",s=0;s<i;s++)o+="0";for(n=o+n,s=0;s<n.length-1;s+=7){var a=n.substr(s,7);s!=n.length-7&&(a="1"+a),r+=t(parseInt(a,2))}return r};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",i=e.split("."),o=40*parseInt(i[0])+parseInt(i[1]);n+=t(o),i.splice(0,2);for(var s=0;s<i.length;s++)n+=r(i[s]);return n},ae.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var e=this.hV.length/2,t=e.toString(16);if(t.length%2==1&&(t="0"+t),e<128)return t;var r=t.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+r).toString(16)+t},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},ae.asn1.DERAbstractString=function(e){ae.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=be(this.s).toLowerCase()},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0!==e.str?this.setString(e.str):void 0!==e.hex&&this.setStringHex(e.hex))},o.lang.extend(ae.asn1.DERAbstractString,ae.asn1.ASN1Object),ae.asn1.DERAbstractTime=function(e){ae.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){return utc=e.getTime()+6e4*e.getTimezoneOffset(),new Date(utc)},this.formatDate=function(e,t,r){var n=this.zeroPadding,i=this.localDateToUTC(e),o=String(i.getFullYear());"utc"==t&&(o=o.substr(2,2));var s=o+n(String(i.getMonth()+1),2)+n(String(i.getDate()),2)+n(String(i.getHours()),2)+n(String(i.getMinutes()),2)+n(String(i.getSeconds()),2);if(!0===r){var a=i.getMilliseconds();if(0!=a){var u=n(String(a),3);s=s+"."+(u=u.replace(/[0]+$/,""))}}return s+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=pe(e)},this.setByDateValue=function(e,t,r,n,i,o){var s=new Date(Date.UTC(e,t-1,r,n,i,o,0));this.setByDate(s)},this.getFreshValueHex=function(){return this.hV}},o.lang.extend(ae.asn1.DERAbstractTime,ae.asn1.ASN1Object),ae.asn1.DERAbstractStructured=function(e){ae.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},o.lang.extend(ae.asn1.DERAbstractStructured,ae.asn1.ASN1Object),ae.asn1.DERBoolean=function(){ae.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},o.lang.extend(ae.asn1.DERBoolean,ae.asn1.ASN1Object),ae.asn1.DERInteger=function(e){ae.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=ae.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new _(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.bigint?this.setByBigInteger(e.bigint):void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},o.lang.extend(ae.asn1.DERInteger,ae.asn1.ASN1Object),ae.asn1.DERBitString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ae.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.getEncodedHex()}ae.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(e<0||7<e)throw"unused bits shall be from 0 to 7: u = "+e;var r="0"+e;this.hTLV=null,this.isModified=!0,this.hV=r+t},this.setByBinaryString=function(e){var t=8-(e=e.replace(/0+$/,"")).length%8;8==t&&(t=0);for(var r=0;r<=t;r++)e+="0";var n="";for(r=0;r<e.length-1;r+=8){var i=e.substr(r,8),o=parseInt(i,2).toString(16);1==o.length&&(o="0"+o),n+=o}this.hTLV=null,this.isModified=!0,this.hV="0"+t+n},this.setByBooleanArray=function(e){for(var t="",r=0;r<e.length;r++)1==e[r]?t+="1":t+="0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):void 0!==e.hex?this.setHexValueIncludingUnusedBits(e.hex):void 0!==e.bin?this.setByBinaryString(e.bin):void 0!==e.array&&this.setByBooleanArray(e.array))},o.lang.extend(ae.asn1.DERBitString,ae.asn1.ASN1Object),ae.asn1.DEROctetString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ae.asn1.ASN1Util.newObject(e.obj);e.hex=t.getEncodedHex()}ae.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},o.lang.extend(ae.asn1.DEROctetString,ae.asn1.DERAbstractString),ae.asn1.DERNull=function(){ae.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},o.lang.extend(ae.asn1.DERNull,ae.asn1.ASN1Object),ae.asn1.DERObjectIdentifier=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},r=function(e){var r="",n=new _(e,10).toString(2),i=7-n.length%7;7==i&&(i=0);for(var o="",s=0;s<i;s++)o+="0";for(n=o+n,s=0;s<n.length-1;s+=7){var a=n.substr(s,7);s!=n.length-7&&(a="1"+a),r+=t(parseInt(a,2))}return r};ae.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",i=e.split("."),o=40*parseInt(i[0])+parseInt(i[1]);n+=t(o),i.splice(0,2);for(var s=0;s<i.length;s++)n+=r(i[s]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.setValueName=function(e){var t=ae.asn1.x509.OID.name2oid(e);if(""===t)throw"DERObjectIdentifier oidName undefined: "+e;this.setValueOidString(t)},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e):void 0!==e.oid?this.setValueOidString(e.oid):void 0!==e.hex?this.setValueHex(e.hex):void 0!==e.name&&this.setValueName(e.name))},o.lang.extend(ae.asn1.DERObjectIdentifier,ae.asn1.ASN1Object),ae.asn1.DEREnumerated=function(e){ae.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=ae.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new _(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},o.lang.extend(ae.asn1.DEREnumerated,ae.asn1.ASN1Object),ae.asn1.DERUTF8String=function(e){ae.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},o.lang.extend(ae.asn1.DERUTF8String,ae.asn1.DERAbstractString),ae.asn1.DERNumericString=function(e){ae.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},o.lang.extend(ae.asn1.DERNumericString,ae.asn1.DERAbstractString),ae.asn1.DERPrintableString=function(e){ae.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},o.lang.extend(ae.asn1.DERPrintableString,ae.asn1.DERAbstractString),ae.asn1.DERTeletexString=function(e){ae.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},o.lang.extend(ae.asn1.DERTeletexString,ae.asn1.DERAbstractString),ae.asn1.DERIA5String=function(e){ae.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},o.lang.extend(ae.asn1.DERIA5String,ae.asn1.DERAbstractString),ae.asn1.DERUTCTime=function(e){ae.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=pe(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=pe(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{12}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date))},o.lang.extend(ae.asn1.DERUTCTime,ae.asn1.DERAbstractTime),ae.asn1.DERGeneralizedTime=function(e){ae.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=pe(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=pe(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{14}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date),!0===e.millis&&(this.withMillis=!0))},o.lang.extend(ae.asn1.DERGeneralizedTime,ae.asn1.DERAbstractTime),ae.asn1.DERSequence=function(e){ae.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++)e+=this.asn1Array[t].getEncodedHex();return this.hV=e,this.hV}},o.lang.extend(ae.asn1.DERSequence,ae.asn1.DERAbstractStructured),ae.asn1.DERSet=function(e){ae.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var r=this.asn1Array[t];e.push(r.getEncodedHex())}return 1==this.sortFlag&&e.sort(),this.hV=e.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},o.lang.extend(ae.asn1.DERSet,ae.asn1.DERAbstractStructured),ae.asn1.DERTaggedObject=function(e){ae.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(e,t,r){this.hT=t,this.isExplicit=e,this.asn1Object=r,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=r.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,t),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.tag&&(this.hT=e.tag),void 0!==e.explicit&&(this.isExplicit=e.explicit),void 0!==e.obj&&(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},o.lang.extend(ae.asn1.DERTaggedObject,ae.asn1.ASN1Object);var ae,ue,ce,le=new function(){};function he(e){for(var t=new Array,r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function fe(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}function de(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);1==n.length&&(n="0"+n),t+=n}return t}function pe(e){return de(he(e))}function ge(e){return(e=(e=e.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function me(e){return e.length%4==2?e+="==":e.length%4==3&&(e+="="),(e=e.replace(/-/g,"+")).replace(/_/g,"/")}function ve(e){return e.length%2==1&&(e="0"+e),ge(b(e))}function ye(e){return w(me(e))}function be(e){return Pe(je(e))}function we(e){return decodeURIComponent(Te(e))}function Fe(e){for(var t="",r=0;r<e.length-1;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}function _e(e){for(var t="",r=0;r<e.length;r++)t+=("0"+e.charCodeAt(r).toString(16)).slice(-2);return t}function Se(e){return b(e)}function Ee(e){var t=Se(e).replace(/(.{64})/g,"$1\r\n");return t.replace(/\r\n$/,"")}function xe(e){return w(e.replace(/[^0-9A-Za-z\/+=]*/g,""))}function De(e,t){return"-----BEGIN "+t+"-----\r\n"+Ee(e)+"\r\n-----END "+t+"-----\r\n"}function ke(e,t){if(-1==e.indexOf("-----BEGIN "))throw"can't find PEM header: "+t;return xe(e=void 0!==t?(e=e.replace("-----BEGIN "+t+"-----","")).replace("-----END "+t+"-----",""):(e=e.replace(/-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----/,""))}function Ae(e){var t,r,n,i,o,s,a,u,c,l,h;if(h=e.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return u=h[1],t=parseInt(u),2===u.length&&(50<=t&&t<100?t=1900+t:0<=t&&t<50&&(t=2e3+t)),r=parseInt(h[2])-1,n=parseInt(h[3]),i=parseInt(h[4]),o=parseInt(h[5]),s=parseInt(h[6]),a=0,""!==(c=h[7])&&(l=(c.substr(1)+"00").substr(0,3),a=parseInt(l)),Date.UTC(t,r,n,i,o,s,a);throw"unsupported zulu format: "+e}function Ce(e){return~~(Ae(e)/1e3)}function Pe(e){return e.replace(/%/g,"")}function Te(e){return e.replace(/(..)/g,"%$1")}function Re(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;var r=(e=e.toLowerCase()).split(":").length-1;if(r<2)throw t;var n=":".repeat(7-r+2),i=(e=e.replace("::",n)).split(":");if(8!=i.length)throw t;for(var o=0;o<8;o++)i[o]=("0000"+i[o]).slice(-4);return i.join("")}function Be(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var t=(e=e.toLowerCase()).match(/.{1,4}/g),r=0;r<8;r++)t[r]=t[r].replace(/^0+/,""),""==t[r]&&(t[r]="0");var n=(e=":"+t.join(":")+":").match(/:(0:){2,}/g);if(null===n)return e.slice(1,-1);var i="";for(r=0;r<n.length;r++)n[r].length>i.length&&(i=n[r]);return(e=e.replace(i,"::")).slice(1,-1)}function Ie(e){var t="malformed hex value";if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(8!=e.length)return 32==e.length?Be(e):e;try{return parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16)}catch(e){throw t}}function je(e){for(var t=encodeURIComponent(e),r="",n=0;n<t.length;n++)"%"==t[n]?(r+=t.substr(n,3),n+=2):r=r+"%"+pe(t[n]);return r}function $e(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}le.getLblen=function(e,t){if("8"!=e.substr(t+2,1))return 1;var r=parseInt(e.substr(t+3,1));return 0==r?-1:0<r&&r<10?r+1:-2},le.getL=function(e,t){var r=le.getLblen(e,t);return r<1?"":e.substr(t+2,2*r)},le.getVblen=function(e,t){var r;return""==(r=le.getL(e,t))?-1:("8"===r.substr(0,1)?new _(r.substr(2),16):new _(r,16)).intValue()},le.getVidx=function(e,t){var r=le.getLblen(e,t);return r<0?r:t+2*(r+1)},le.getV=function(e,t){var r=le.getVidx(e,t),n=le.getVblen(e,t);return e.substr(r,2*n)},le.getTLV=function(e,t){return e.substr(t,2)+le.getL(e,t)+le.getV(e,t)},le.getNextSiblingIdx=function(e,t){return le.getVidx(e,t)+2*le.getVblen(e,t)},le.getChildIdx=function(e,t){var r=le,n=new Array,i=r.getVidx(e,t);"03"==e.substr(t,2)?n.push(i+2):n.push(i);for(var o=r.getVblen(e,t),s=i,a=0;;){var u=r.getNextSiblingIdx(e,s);if(null==u||u-i>=2*o)break;if(a>=200)break;n.push(u),s=u,a++}return n},le.getNthChildIdx=function(e,t,r){return le.getChildIdx(e,t)[r]},le.getIdxbyList=function(e,t,r,n){var i,o,s=le;if(0==r.length){if(void 0!==n&&e.substr(t,2)!==n)throw"checking tag doesn't match: "+e.substr(t,2)+"!="+n;return t}return i=r.shift(),o=s.getChildIdx(e,t),s.getIdxbyList(e,o[i],r,n)},le.getTLVbyList=function(e,t,r,n){var i=le,o=i.getIdxbyList(e,t,r);if(void 0===o)throw"can't find nthList object";if(void 0!==n&&e.substr(o,2)!=n)throw"checking tag doesn't match: "+e.substr(o,2)+"!="+n;return i.getTLV(e,o)},le.getVbyList=function(e,t,r,n,i){var o,s,a=le;if(void 0===(o=a.getIdxbyList(e,t,r,n)))throw"can't find nthList object";return s=a.getV(e,o),!0===i&&(s=s.substr(2)),s},le.hextooidstr=function(e){var t=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},r=[],n=e.substr(0,2),i=parseInt(n,16);r[0]=new String(Math.floor(i/40)),r[1]=new String(i%40);for(var o=e.substr(2),s=[],a=0;a<o.length/2;a++)s.push(parseInt(o.substr(2*a,2),16));var u=[],c="";for(a=0;a<s.length;a++)128&s[a]?c+=t((127&s[a]).toString(2),7):(c+=t((127&s[a]).toString(2),7),u.push(new String(parseInt(c,2))),c="");var l=r.join(".");return u.length>0&&(l=l+"."+u.join(".")),l},le.dump=function(e,t,r,n){var i=le,o=i.getV,s=i.dump,a=i.getChildIdx,u=e;e instanceof ae.asn1.ASN1Object&&(u=e.getEncodedHex());var c=function(e,t){return e.length<=2*t?e:e.substr(0,t)+"..(total "+e.length/2+"bytes).."+e.substr(e.length-t,t)};void 0===t&&(t={ommit_long_octet:32}),void 0===r&&(r=0),void 0===n&&(n="");var l=t.ommit_long_octet;if("01"==u.substr(r,2))return"00"==(h=o(u,r))?n+"BOOLEAN FALSE\n":n+"BOOLEAN TRUE\n";if("02"==u.substr(r,2))return n+"INTEGER "+c(h=o(u,r),l)+"\n";if("03"==u.substr(r,2))return n+"BITSTRING "+c(h=o(u,r),l)+"\n";if("04"==u.substr(r,2)){var h=o(u,r);return i.isASN1HEX(h)?(_=n+"OCTETSTRING, encapsulates\n")+s(h,t,0,n+"  "):n+"OCTETSTRING "+c(h,l)+"\n"}if("05"==u.substr(r,2))return n+"NULL\n";if("06"==u.substr(r,2)){var f=o(u,r),d=ae.asn1.ASN1Util.oidHexToInt(f),p=ae.asn1.x509.OID.oid2name(d),g=d.replace(/\./g," ");return""!=p?n+"ObjectIdentifier "+p+" ("+g+")\n":n+"ObjectIdentifier ("+g+")\n"}if("0c"==u.substr(r,2))return n+"UTF8String '"+we(o(u,r))+"'\n";if("13"==u.substr(r,2))return n+"PrintableString '"+we(o(u,r))+"'\n";if("14"==u.substr(r,2))return n+"TeletexString '"+we(o(u,r))+"'\n";if("16"==u.substr(r,2))return n+"IA5String '"+we(o(u,r))+"'\n";if("17"==u.substr(r,2))return n+"UTCTime "+we(o(u,r))+"\n";if("18"==u.substr(r,2))return n+"GeneralizedTime "+we(o(u,r))+"\n";if("30"==u.substr(r,2)){if("3000"==u.substr(r,4))return n+"SEQUENCE {}\n";_=n+"SEQUENCE\n";var m=t;if((2==(b=a(u,r)).length||3==b.length)&&"06"==u.substr(b[0],2)&&"04"==u.substr(b[b.length-1],2)){p=i.oidname(o(u,b[0]));var v=JSON.parse(JSON.stringify(t));v.x509ExtName=p,m=v}for(var y=0;y<b.length;y++)_+=s(u,m,b[y],n+"  ");return _}if("31"==u.substr(r,2)){_=n+"SET\n";var b=a(u,r);for(y=0;y<b.length;y++)_+=s(u,t,b[y],n+"  ");return _}var w=parseInt(u.substr(r,2),16);if(0!=(128&w)){var F=31&w;if(0!=(32&w)){var _=n+"["+F+"]\n";for(b=a(u,r),y=0;y<b.length;y++)_+=s(u,t,b[y],n+"  ");return _}return"68747470"==(h=o(u,r)).substr(0,8)&&(h=we(h)),"subjectAltName"===t.x509ExtName&&2==F&&(h=we(h)),n+"["+F+"] "+h+"\n"}return n+"UNKNOWN("+u.substr(r,2)+") "+o(u,r)+"\n"},le.isASN1HEX=function(e){var t=le;if(e.length%2==1)return!1;var r=t.getVblen(e,0),n=e.substr(0,2),i=t.getL(e,0);return e.length-n.length-i.length==2*r},le.oidname=function(e){var t=ae.asn1;ae.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var r=t.x509.OID.oid2name(e);return""===r&&(r=e),r},void 0!==ae&&ae||(t.KJUR=ae={}),void 0!==ae.lang&&ae.lang||(ae.lang={}),ae.lang.String=function(){},"function"==typeof e?(t.utf8tob64u=ue=function(t){return ge(new e(t,"utf8").toString("base64"))},t.b64utoutf8=ce=function(t){return new e(me(t),"base64").toString("utf8")}):(t.utf8tob64u=ue=function(e){return ve(Pe(je(e)))},t.b64utoutf8=ce=function(e){return decodeURIComponent(Te(ye(e)))}),ae.lang.String.isInteger=function(e){return!!e.match(/^[0-9]+$/)||!!e.match(/^-[0-9]+$/)},ae.lang.String.isHex=function(e){return!(e.length%2!=0||!e.match(/^[0-9a-f]+$/)&&!e.match(/^[0-9A-F]+$/))},ae.lang.String.isBase64=function(e){return!(!(e=e.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||e.length%4!=0)},ae.lang.String.isBase64URL=function(e){return!e.match(/[+/=]/)&&(e=me(e),ae.lang.String.isBase64(e))},ae.lang.String.isIntegerArray=function(e){return!!(e=e.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},void 0!==ae&&ae||(t.KJUR=ae={}),void 0!==ae.crypto&&ae.crypto||(ae.crypto={}),ae.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:v.algo.MD5,sha1:v.algo.SHA1,sha224:v.algo.SHA224,sha256:v.algo.SHA256,sha384:v.algo.SHA384,sha512:v.algo.SHA512,ripemd160:v.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(void 0===this.DIGESTINFOHEAD[t])throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,r){var n=this.getDigestInfoHex(e,t),i=r/4;if(n.length+22>i)throw"key is too short for SigAlg: keylen="+r+","+t;for(var o="0001",s="00"+n,a="",u=i-o.length-s.length,c=0;c<u;c+=2)a+="ff";return o+a+s},this.hashString=function(e,t){return new ae.crypto.MessageDigest({alg:t}).digestString(e)},this.hashHex=function(e,t){return new ae.crypto.MessageDigest({alg:t}).digestHex(e)},this.sha1=function(e){return new ae.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(e)},this.sha256=function(e){return new ae.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(e)},this.sha256Hex=function(e){return new ae.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(e)},this.sha512=function(e){return new ae.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(e)},this.sha512Hex=function(e){return new ae.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(e)}},ae.crypto.Util.md5=function(e){return new ae.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(e)},ae.crypto.Util.ripemd160=function(e){return new ae.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(e)},ae.crypto.Util.SECURERANDOMGEN=new Q,ae.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return ae.crypto.Util.SECURERANDOMGEN.nextBytes(t),de(t)},ae.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new _(ae.crypto.Util.getRandomHexOfNbytes(e),16)},ae.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,r=new Array((e-t)/8+1);return ae.crypto.Util.SECURERANDOMGEN.nextBytes(r),r[0]=(255<<t&255^255)&r[0],de(r)},ae.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new _(ae.crypto.Util.getRandomHexOfNbits(e),16)},ae.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var r=ae.crypto.Util.getRandomBigIntegerOfNbits(t);if(-1!=e.compareTo(r))return r}},ae.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var r=e.compareTo(t);if(1==r)throw"biMin is greater than biMax";if(0==r)return e;var n=t.subtract(e);return ae.crypto.Util.getRandomBigIntegerZeroToMax(n).add(e)},ae.crypto.MessageDigest=function(e){this.setAlgAndProvider=function(e,t){if(null!==(e=ae.crypto.MessageDigest.getCanonicalAlgName(e))&&void 0===t&&(t=ae.crypto.Util.DEFAULTPROVIDER[e]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(e)&&"cryptojs"==t){try{this.md=ae.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[e].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=v.enc.Hex.parse(e);this.md.update(t)},this.digest=function(){return this.md.finalize().toString(v.enc.Hex)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}if(-1!=":sha256:".indexOf(e)&&"sjcl"==t){try{this.md=new sjcl.hash.sha256}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=sjcl.codec.hex.toBits(e);this.md.update(t)},this.digest=function(){var e=this.md.finalize();return sjcl.codec.hex.fromBits(e)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==e&&void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=ae.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},ae.crypto.MessageDigest.getCanonicalAlgName=function(e){return"string"==typeof e&&(e=(e=e.toLowerCase()).replace(/-/,"")),e},ae.crypto.MessageDigest.getHashLength=function(e){var t=ae.crypto.MessageDigest,r=t.getCanonicalAlgName(e);if(void 0===t.HASHLENGTH[r])throw"not supported algorithm: "+e;return t.HASHLENGTH[r]},ae.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},ae.crypto.Mac=function(e){this.setAlgAndProvider=function(e,t){if(null==(e=e.toLowerCase())&&(e="hmacsha1"),"hmac"!=(e=e.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+e;void 0===t&&(t=ae.crypto.Util.DEFAULTPROVIDER[e]),this.algProv=e+"/"+t;var r=e.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(r)&&"cryptojs"==t){try{var n=ae.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[r];this.mac=v.algo.HMAC.create(n,this.pass)}catch(e){throw"setAlgAndProvider hash alg set fail hashAlg="+r+"/"+e}this.updateString=function(e){this.mac.update(e)},this.updateHex=function(e){var t=v.enc.Hex.parse(e);this.mac.update(t)},this.doFinal=function(){return this.mac.finalize().toString(v.enc.Hex)},this.doFinalString=function(e){return this.updateString(e),this.doFinal()},this.doFinalHex=function(e){return this.updateHex(e),this.doFinal()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(e){if("string"==typeof e){var t=e;return e.length%2!=1&&e.match(/^[0-9A-Fa-f]+$/)||(t=_e(e)),void(this.pass=v.enc.Hex.parse(t))}if("object"!=(void 0===e?"undefined":r(e)))throw"KJUR.crypto.Mac unsupported password type: "+e;if(t=null,void 0!==e.hex){if(e.hex.length%2!=0||!e.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+e.hex;t=e.hex}if(void 0!==e.utf8&&(t=be(e.utf8)),void 0!==e.rstr&&(t=_e(e.rstr)),void 0!==e.b64&&(t=w(e.b64)),void 0!==e.b64u&&(t=ye(e.b64u)),null==t)throw"KJUR.crypto.Mac unsupported password type: "+e;this.pass=v.enc.Hex.parse(t)},void 0!==e&&(void 0!==e.pass&&this.setPassword(e.pass),void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=ae.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},ae.crypto.Signature=function(e){var t=null;if(this._setAlgNames=function(){var e=this.algName.match(/^(.+)with(.+)$/);e&&(this.mdAlgName=e[1].toLowerCase(),this.pubkeyAlgName=e[2].toLowerCase())},this._zeroPaddingOfSignature=function(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r+="0";return r+e},this.setAlgAndProvider=function(e,t){if(this._setAlgNames(),"cryptojs/jsrsa"!=t)throw"provider not supported: "+t;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new ae.crypto.MessageDigest({alg:this.mdAlgName})}catch(e){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+e}this.init=function(e,t){var r=null;try{r=void 0===t?Le.getKey(e):Le.getKey(e,t)}catch(e){throw"init failed:"+e}if(!0===r.isPrivate)this.prvKey=r,this.state="SIGN";else{if(!0!==r.isPublic)throw"init failed.:"+r;this.pubKey=r,this.state="VERIFY"}},this.updateString=function(e){this.md.updateString(e)},this.updateHex=function(e){this.md.updateHex(e)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0!==this.ecprvhex&&void 0!==this.eccurvename){var e=new ae.crypto.ECDSA({curve:this.eccurvename});this.hSign=e.signHex(this.sHashHex,this.ecprvhex)}else if(this.prvKey instanceof re&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof re&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof ae.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof ae.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(e){return this.updateString(e),this.sign()},this.signHex=function(e){return this.updateHex(e),this.sign()},this.verify=function(e){if(this.sHashHex=this.md.digest(),void 0!==this.ecpubhex&&void 0!==this.eccurvename)return new ae.crypto.ECDSA({curve:this.eccurvename}).verifyHex(this.sHashHex,e,this.ecpubhex);if(this.pubKey instanceof re&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,e,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof re&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==ae.crypto.ECDSA&&this.pubKey instanceof ae.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==ae.crypto.DSA&&this.pubKey instanceof ae.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(e,t){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(e){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(e){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(e){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(e){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,void 0!==e&&(void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov?this.provName=ae.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==e.psssaltlen&&(this.pssSaltLen=e.psssaltlen),void 0!==e.prvkeypem)){if(void 0!==e.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{t=Le.getKey(e.prvkeypem),this.init(t)}catch(e){throw"fatal error to load pem private key: "+e}}},ae.crypto.Cipher=function(e){},ae.crypto.Cipher.encrypt=function(e,t,r){if(t instanceof re&&t.isPublic){var n=ae.crypto.Cipher.getAlgByKeyAndName(t,r);if("RSA"===n)return t.encrypt(e);if("RSAOAEP"===n)return t.encryptOAEP(e,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return t.encryptOAEP(e,"sha"+i[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.encrypt: unsupported key or algorithm"},ae.crypto.Cipher.decrypt=function(e,t,r){if(t instanceof re&&t.isPrivate){var n=ae.crypto.Cipher.getAlgByKeyAndName(t,r);if("RSA"===n)return t.decrypt(e);if("RSAOAEP"===n)return t.decryptOAEP(e,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return t.decryptOAEP(e,"sha"+i[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.decrypt: unsupported key or algorithm"},ae.crypto.Cipher.getAlgByKeyAndName=function(e,t){if(e instanceof re){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(t))return t;if(null==t)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+t}throw"getAlgByKeyAndName: not supported algorithm name: "+t},ae.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==ae&&ae||(t.KJUR=ae={}),void 0!==ae.crypto&&ae.crypto||(ae.crypto={}),ae.crypto.ECDSA=function(e){var t=new Q;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(e){return new _(e.bitLength(),t).mod(e.subtract(_.ONE)).add(_.ONE)},this.setNamedCurve=function(e){this.ecparams=ae.crypto.ECParameterDB.getByName(e),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=e},this.setPrivateKeyHex=function(e){this.isPrivate=!0,this.prvKeyHex=e},this.setPublicKeyHex=function(e){this.isPublic=!0,this.pubKeyHex=e},this.getPublicKeyXYHex=function(){var e=this.pubKeyHex;if("04"!==e.substr(0,2))throw"this method supports uncompressed format(04) only";var t=this.ecparams.keylen/4;if(e.length!==2+2*t)throw"malformed public key hex length";var r={};return r.x=e.substr(2,t),r.y=e.substr(2+t),r},this.getShortNISTPCurveName=function(){var e=this.curveName;return"secp256r1"===e||"NIST P-256"===e||"P-256"===e||"prime256v1"===e?"P-256":"secp384r1"===e||"NIST P-384"===e||"P-384"===e?"P-384":null},this.generateKeyPairHex=function(){var e=this.ecparams.n,t=this.getBigRandom(e),r=this.ecparams.G.multiply(t),n=r.getX().toBigInteger(),i=r.getY().toBigInteger(),o=this.ecparams.keylen/4,s=("0000000000"+t.toString(16)).slice(-o),a="04"+("0000000000"+n.toString(16)).slice(-o)+("0000000000"+i.toString(16)).slice(-o);return this.setPrivateKeyHex(s),this.setPublicKeyHex(a),{ecprvhex:s,ecpubhex:a}},this.signWithMessageHash=function(e){return this.signHex(e,this.prvKeyHex)},this.signHex=function(e,t){var r=new _(t,16),n=this.ecparams.n,i=new _(e,16);do{var o=this.getBigRandom(n),s=this.ecparams.G.multiply(o).getX().toBigInteger().mod(n)}while(s.compareTo(_.ZERO)<=0);var a=o.modInverse(n).multiply(i.add(r.multiply(s))).mod(n);return ae.crypto.ECDSA.biRSSigToASN1Sig(s,a)},this.sign=function(e,t){var r=t,n=this.ecparams.n,i=_.fromByteArrayUnsigned(e);do{var o=this.getBigRandom(n),s=this.ecparams.G.multiply(o).getX().toBigInteger().mod(n)}while(s.compareTo(_.ZERO)<=0);var a=o.modInverse(n).multiply(i.add(r.multiply(s))).mod(n);return this.serializeSig(s,a)},this.verifyWithMessageHash=function(e,t){return this.verifyHex(e,t,this.pubKeyHex)},this.verifyHex=function(e,t,r){var n,i,o,s=ae.crypto.ECDSA.parseSigHex(t);n=s.r,i=s.s,o=ie.decodeFromHex(this.ecparams.curve,r);var a=new _(e,16);return this.verifyRaw(a,n,i,o)},this.verify=function(e,t,n){var i,o,s;if(Bitcoin.Util.isArray(t)){var a=this.parseSig(t);i=a.r,o=a.s}else{if("object"!==(void 0===t?"undefined":r(t))||!t.r||!t.s)throw"Invalid value for signature";i=t.r,o=t.s}if(n instanceof ie)s=n;else{if(!Bitcoin.Util.isArray(n))throw"Invalid format for pubkey value, must be byte array or ECPointFp";s=ie.decodeFrom(this.ecparams.curve,n)}var u=_.fromByteArrayUnsigned(e);return this.verifyRaw(u,i,o,s)},this.verifyRaw=function(e,t,r,n){var i=this.ecparams.n,o=this.ecparams.G;if(t.compareTo(_.ONE)<0||t.compareTo(i)>=0)return!1;if(r.compareTo(_.ONE)<0||r.compareTo(i)>=0)return!1;var s=r.modInverse(i),a=e.multiply(s).mod(i),u=t.multiply(s).mod(i);return o.multiply(a).add(n.multiply(u)).getX().toBigInteger().mod(i).equals(t)},this.serializeSig=function(e,t){var r=e.toByteArraySigned(),n=t.toByteArraySigned(),i=[];return i.push(2),i.push(r.length),(i=i.concat(r)).push(2),i.push(n.length),(i=i.concat(n)).unshift(i.length),i.unshift(48),i},this.parseSig=function(e){var t;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if(2!=e[t=2])throw new Error("First element in signature must be a DERInteger");var r=e.slice(t+2,t+2+e[t+1]);if(2!=e[t+=2+e[t+1]])throw new Error("Second element in signature must be a DERInteger");var n=e.slice(t+2,t+2+e[t+1]);return t+=2+e[t+1],{r:_.fromByteArrayUnsigned(r),s:_.fromByteArrayUnsigned(n)}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var t=e[0]-27;if(t<0||t>7)throw"Invalid signature type";var r=this.ecparams.n;return{r:_.fromByteArrayUnsigned(e.slice(1,33)).mod(r),s:_.fromByteArrayUnsigned(e.slice(33,65)).mod(r),i:t}},this.readPKCS5PrvKeyHex=function(e){var t,r,n,i=le,o=ae.crypto.ECDSA.getName,s=i.getVbyList;if(!1===i.isASN1HEX(e))throw"not ASN.1 hex string";try{t=s(e,0,[2,0],"06"),r=s(e,0,[1],"04");try{n=s(e,0,[3,0],"03").substr(2)}catch(e){}}catch(e){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=o(t),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n),this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(e){var t,r,n,i=le,o=ae.crypto.ECDSA.getName,s=i.getVbyList;if(!1===i.isASN1HEX(e))throw"not ASN.1 hex string";try{s(e,0,[1,0],"06"),t=s(e,0,[1,1],"06"),r=s(e,0,[2,0,1],"04");try{n=s(e,0,[2,0,2,0],"03").substr(2)}catch(e){}}catch(e){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=o(t),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n),this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PubKeyHex=function(e){var t,r,n=le,i=ae.crypto.ECDSA.getName,o=n.getVbyList;if(!1===n.isASN1HEX(e))throw"not ASN.1 hex string";try{o(e,0,[0,0],"06"),t=o(e,0,[0,1],"06"),r=o(e,0,[1],"03").substr(2)}catch(e){throw"malformed PKCS#8 ECC public key"}if(this.curveName=i(t),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(r)},this.readCertPubKeyHex=function(e,t){5!==t&&(t=6);var r,n,i=le,o=ae.crypto.ECDSA.getName,s=i.getVbyList;if(!1===i.isASN1HEX(e))throw"not ASN.1 hex string";try{r=s(e,0,[0,t,0,1],"06"),n=s(e,0,[0,t,1],"03").substr(2)}catch(e){throw"malformed X.509 certificate ECC public key"}if(this.curveName=o(r),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n)},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))},ae.crypto.ECDSA.parseSigHex=function(e){var t=ae.crypto.ECDSA.parseSigHexInHexRS(e);return{r:new _(t.r,16),s:new _(t.s,16)}},ae.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=le,r=t.getChildIdx,n=t.getV;if("30"!=e.substr(0,2))throw"signature is not a ASN.1 sequence";var i=r(e,0);if(2!=i.length)throw"number of signature ASN.1 sequence elements seem wrong";var o=i[0],s=i[1];if("02"!=e.substr(o,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=e.substr(s,2))throw"2nd item of sequene of signature is not ASN.1 integer";return{r:n(e,o),s:n(e,s)}},ae.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=ae.crypto.ECDSA.parseSigHexInHexRS(e),r=t.r,n=t.s;if("00"==r.substr(0,2)&&r.length%32==2&&(r=r.substr(2)),"00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),r.length%32==30&&(r="00"+r),n.length%32==30&&(n="00"+n),r.length%32!=0)throw"unknown ECDSA sig r length error";if(n.length%32!=0)throw"unknown ECDSA sig s length error";return r+n},ae.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var t=e.substr(0,e.length/2),r=e.substr(e.length/2);return ae.crypto.ECDSA.hexRSSigToASN1Sig(t,r)},ae.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var r=new _(e,16),n=new _(t,16);return ae.crypto.ECDSA.biRSSigToASN1Sig(r,n)},ae.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var r=ae.asn1,n=new r.DERInteger({bigint:e}),i=new r.DERInteger({bigint:t});return new r.DERSequence({array:[n,i]}).getEncodedHex()},ae.crypto.ECDSA.getName=function(e){return"2a8648ce3d030107"===e?"secp256r1":"2b8104000a"===e?"secp256k1":"2b81040022"===e?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)?"secp256r1":-1!=="|secp256k1|".indexOf(e)?"secp256k1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(e)?"secp384r1":null},void 0!==ae&&ae||(t.KJUR=ae={}),void 0!==ae.crypto&&ae.crypto||(ae.crypto={}),ae.crypto.ECParameterDB=new function(){var e={},t={};function r(e){return new _(e,16)}this.getByName=function(r){var n=r;if(void 0!==t[n]&&(n=t[r]),void 0!==e[n])return e[n];throw"unregistered EC curve name: "+n},this.regist=function(n,i,o,s,a,u,c,l,h,f,d,p){e[n]={};var g=r(o),m=r(s),v=r(a),y=r(u),b=r(c),w=new oe(g,m,v),F=w.decodePointHex("04"+l+h);e[n].name=n,e[n].keylen=i,e[n].curve=w,e[n].G=F,e[n].n=y,e[n].h=b,e[n].oid=d,e[n].info=p;for(var _=0;_<f.length;_++)t[f[_]]=n}},ae.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),ae.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),ae.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),ae.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),ae.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),ae.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),ae.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),ae.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),ae.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),ae.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var Le=function(){var e=function(e,r,n){return t(v.AES,e,r,n)},t=function(e,t,r,n){var i=v.enc.Hex.parse(t),o=v.enc.Hex.parse(r),s=v.enc.Hex.parse(n),a={};a.key=o,a.iv=s,a.ciphertext=i;var u=e.decrypt(a,o,{iv:s});return v.enc.Hex.stringify(u)},r=function(e,t,r){return n(v.AES,e,t,r)},n=function(e,t,r,n){var i=v.enc.Hex.parse(t),o=v.enc.Hex.parse(r),s=v.enc.Hex.parse(n),a=e.encrypt(i,o,{iv:s}),u=v.enc.Hex.parse(a.toString());return v.enc.Base64.stringify(u)},i={"AES-256-CBC":{proc:e,eproc:r,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:r,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:r,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(e,r,n){return t(v.TripleDES,e,r,n)},eproc:function(e,t,r){return n(v.TripleDES,e,t,r)},keylen:24,ivlen:8},"DES-CBC":{proc:function(e,r,n){return t(v.DES,e,r,n)},eproc:function(e,t,r){return n(v.DES,e,t,r)},keylen:8,ivlen:8}},o=function(e){var t={},r=e.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));r&&(t.cipher=r[1],t.ivsalt=r[2]);var n=e.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));n&&(t.type=n[1]);var i=-1,o=0;-1!=e.indexOf("\r\n\r\n")&&(i=e.indexOf("\r\n\r\n"),o=2),-1!=e.indexOf("\n\n")&&(i=e.indexOf("\n\n"),o=1);var s=e.indexOf("-----END");if(-1!=i&&-1!=s){var a=e.substring(i+2*o,s-o);a=a.replace(/\s+/g,""),t.data=a}return t},s=function(e,t,r){for(var n=r.substring(0,16),o=v.enc.Hex.parse(n),s=v.enc.Utf8.parse(t),a=i[e].keylen+i[e].ivlen,u="",c=null;;){var l=v.algo.MD5.create();if(null!=c&&l.update(c),l.update(s),l.update(o),c=l.finalize(),(u+=v.enc.Hex.stringify(c)).length>=2*a)break}var h={};return h.keyhex=u.substr(0,2*i[e].keylen),h.ivhex=u.substr(2*i[e].keylen,2*i[e].ivlen),h},a=function(e,t,r,n){var o=v.enc.Base64.parse(e),s=v.enc.Hex.stringify(o);return(0,i[t].proc)(s,r,n)};return{version:"1.0.0",parsePKCS5PEM:function(e){return o(e)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(e,t,r){return s(e,t,r)},decryptKeyB64:function(e,t,r,n){return a(e,t,r,n)},getDecryptedKeyHex:function(e,t){var r=o(e),n=r.cipher,i=r.ivsalt,u=r.data,c=s(n,t,i).keyhex;return a(u,n,c,i)},getEncryptedPKCS5PEMFromPrvKeyHex:function(e,t,r,n,o){var a="";if(void 0!==n&&null!=n||(n="AES-256-CBC"),void 0===i[n])throw"KEYUTIL unsupported algorithm: "+n;return void 0!==o&&null!=o||(o=function(e){var t=v.lib.WordArray.random(e);return v.enc.Hex.stringify(t)}(i[n].ivlen).toUpperCase()),a="-----BEGIN "+e+" PRIVATE KEY-----\r\n",a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+n+","+o+"\r\n",a+="\r\n",(a+=function(e,t,r,n){return(0,i[t].eproc)(e,r,n)}(t,n,s(n,r,o).keyhex,o).replace(/(.{64})/g,"$1\r\n"))+"\r\n-----END "+e+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(e){var t=le,r=t.getChildIdx,n=t.getV,i={},o=r(e,0);if(2!=o.length)throw"malformed format: SEQUENCE(0).items != 2: "+o.length;i.ciphertext=n(e,o[1]);var s=r(e,o[0]);if(2!=s.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+s.length;if("2a864886f70d01050d"!=n(e,s[0]))throw"this only supports pkcs5PBES2";var a=r(e,s[1]);if(2!=s.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+a.length;var u=r(e,a[1]);if(2!=u.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+u.length;if("2a864886f70d0307"!=n(e,u[0]))throw"this only supports TripleDES";i.encryptionSchemeAlg="TripleDES",i.encryptionSchemeIV=n(e,u[1]);var c=r(e,a[0]);if(2!=c.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+c.length;if("2a864886f70d01050c"!=n(e,c[0]))throw"this only supports pkcs5PBKDF2";var l=r(e,c[1]);if(l.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+l.length;i.pbkdf2Salt=n(e,l[0]);var h=n(e,l[1]);try{i.pbkdf2Iter=parseInt(h,16)}catch(e){throw"malformed format pbkdf2Iter: "+h}return i},getPBKDF2KeyHexFromParam:function(e,t){var r=v.enc.Hex.parse(e.pbkdf2Salt),n=e.pbkdf2Iter,i=v.PBKDF2(t,r,{keySize:6,iterations:n});return v.enc.Hex.stringify(i)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(e,t){var r=ke(e,"ENCRYPTED PRIVATE KEY"),n=this.parseHexOfEncryptedPKCS8(r),i=Le.getPBKDF2KeyHexFromParam(n,t),o={};o.ciphertext=v.enc.Hex.parse(n.ciphertext);var s=v.enc.Hex.parse(i),a=v.enc.Hex.parse(n.encryptionSchemeIV),u=v.TripleDES.decrypt(o,s,{iv:a});return v.enc.Hex.stringify(u)},getKeyFromEncryptedPKCS8PEM:function(e,t){var r=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(e,t);return this.getKeyFromPlainPrivatePKCS8Hex(r)},parsePlainPrivatePKCS8Hex:function(e){var t=le,r=t.getChildIdx,n=t.getV,i={algparam:null};if("30"!=e.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var o=r(e,0);if(3!=o.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=e.substr(o[1],2))throw"malformed PKCS8 private key(code:003)";var s=r(e,o[1]);if(2!=s.length)throw"malformed PKCS8 private key(code:004)";if("06"!=e.substr(s[0],2))throw"malformed PKCS8 private key(code:005)";if(i.algoid=n(e,s[0]),"06"==e.substr(s[1],2)&&(i.algparam=n(e,s[1])),"04"!=e.substr(o[2],2))throw"malformed PKCS8 private key(code:006)";return i.keyidx=t.getVidx(e,o[2]),i},getKeyFromPlainPrivatePKCS8PEM:function(e){var t=ke(e,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(t)},getKeyFromPlainPrivatePKCS8Hex:function(e){var t,r=this.parsePlainPrivatePKCS8Hex(e);if("2a864886f70d010101"==r.algoid)t=new re;else if("2a8648ce380401"==r.algoid)t=new ae.crypto.DSA;else{if("2a8648ce3d0201"!=r.algoid)throw"unsupported private key algorithm";t=new ae.crypto.ECDSA}return t.readPKCS8PrvKeyHex(e),t},_getKeyFromPublicPKCS8Hex:function(e){var t,r=le.getVbyList(e,0,[0,0],"06");if("2a864886f70d010101"===r)t=new re;else if("2a8648ce380401"===r)t=new ae.crypto.DSA;else{if("2a8648ce3d0201"!==r)throw"unsupported PKCS#8 public key hex";t=new ae.crypto.ECDSA}return t.readPKCS8PubKeyHex(e),t},parsePublicRawRSAKeyHex:function(e){var t=le,r=t.getChildIdx,n=t.getV,i={};if("30"!=e.substr(0,2))throw"malformed RSA key(code:001)";var o=r(e,0);if(2!=o.length)throw"malformed RSA key(code:002)";if("02"!=e.substr(o[0],2))throw"malformed RSA key(code:003)";if(i.n=n(e,o[0]),"02"!=e.substr(o[1],2))throw"malformed RSA key(code:004)";return i.e=n(e,o[1]),i},parsePublicPKCS8Hex:function(e){var t=le,r=t.getChildIdx,n=t.getV,i={algparam:null},o=r(e,0);if(2!=o.length)throw"outer DERSequence shall have 2 elements: "+o.length;var s=o[0];if("30"!=e.substr(s,2))throw"malformed PKCS8 public key(code:001)";var a=r(e,s);if(2!=a.length)throw"malformed PKCS8 public key(code:002)";if("06"!=e.substr(a[0],2))throw"malformed PKCS8 public key(code:003)";if(i.algoid=n(e,a[0]),"06"==e.substr(a[1],2)?i.algparam=n(e,a[1]):"30"==e.substr(a[1],2)&&(i.algparam={},i.algparam.p=t.getVbyList(e,a[1],[0],"02"),i.algparam.q=t.getVbyList(e,a[1],[1],"02"),i.algparam.g=t.getVbyList(e,a[1],[2],"02")),"03"!=e.substr(o[1],2))throw"malformed PKCS8 public key(code:004)";return i.key=n(e,o[1]).substr(2),i}}}();Le.getKey=function(e,t,r){var n,i=(v=le).getChildIdx,o=(v.getV,v.getVbyList),s=ae.crypto,a=s.ECDSA,u=s.DSA,c=re,l=ke,h=Le;if(void 0!==c&&e instanceof c)return e;if(void 0!==a&&e instanceof a)return e;if(void 0!==u&&e instanceof u)return e;if(void 0!==e.curve&&void 0!==e.xy&&void 0===e.d)return new a({pub:e.xy,curve:e.curve});if(void 0!==e.curve&&void 0!==e.d)return new a({prv:e.d,curve:e.curve});if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(C=new c).setPublic(e.n,e.e),C;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.co&&void 0===e.qi)return(C=new c).setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),C;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0===e.p)return(C=new c).setPrivate(e.n,e.e,e.d),C;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0===e.x)return(C=new u).setPublic(e.p,e.q,e.g,e.y),C;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0!==e.x)return(C=new u).setPrivate(e.p,e.q,e.g,e.y,e.x),C;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(C=new c).setPublic(ye(e.n),ye(e.e)),C;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.qi)return(C=new c).setPrivateEx(ye(e.n),ye(e.e),ye(e.d),ye(e.p),ye(e.q),ye(e.dp),ye(e.dq),ye(e.qi)),C;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d)return(C=new c).setPrivate(ye(e.n),ye(e.e),ye(e.d)),C;if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0===e.d){var f=(A=new a({curve:e.crv})).ecparams.keylen/4,d="04"+("0000000000"+ye(e.x)).slice(-f)+("0000000000"+ye(e.y)).slice(-f);return A.setPublicKeyHex(d),A}if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0!==e.d){f=(A=new a({curve:e.crv})).ecparams.keylen/4,d="04"+("0000000000"+ye(e.x)).slice(-f)+("0000000000"+ye(e.y)).slice(-f);var p=("0000000000"+ye(e.d)).slice(-f);return A.setPublicKeyHex(d),A.setPrivateKeyHex(p),A}if("pkcs5prv"===r){var g,m=e,v=le;if(9===(g=i(m,0)).length)(C=new c).readPKCS5PrvKeyHex(m);else if(6===g.length)(C=new u).readPKCS5PrvKeyHex(m);else{if(!(g.length>2&&"04"===m.substr(g[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(C=new a).readPKCS5PrvKeyHex(m)}return C}if("pkcs8prv"===r)return h.getKeyFromPlainPrivatePKCS8Hex(e);if("pkcs8pub"===r)return h._getKeyFromPublicPKCS8Hex(e);if("x509pub"===r)return He.getPublicKeyFromCertHex(e);if(-1!=e.indexOf("-END CERTIFICATE-",0)||-1!=e.indexOf("-END X509 CERTIFICATE-",0)||-1!=e.indexOf("-END TRUSTED CERTIFICATE-",0))return He.getPublicKeyFromCertPEM(e);if(-1!=e.indexOf("-END PUBLIC KEY-")){var y=ke(e,"PUBLIC KEY");return h._getKeyFromPublicPKCS8Hex(y)}if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var b=l(e,"RSA PRIVATE KEY");return h.getKey(b,null,"pkcs5prv")}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var w=o(n=l(e,"DSA PRIVATE KEY"),0,[1],"02"),F=o(n,0,[2],"02"),S=o(n,0,[3],"02"),E=o(n,0,[4],"02"),x=o(n,0,[5],"02");return(C=new u).setPrivate(new _(w,16),new _(F,16),new _(S,16),new _(E,16),new _(x,16)),C}if(-1!=e.indexOf("-END PRIVATE KEY-"))return h.getKeyFromPlainPrivatePKCS8PEM(e);if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var D=h.getDecryptedKeyHex(e,t),k=new re;return k.readPKCS5PrvKeyHex(D),k}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var A,C=o(n=h.getDecryptedKeyHex(e,t),0,[1],"04"),P=o(n,0,[2,0],"06"),T=o(n,0,[3,0],"03").substr(2);if(void 0===ae.crypto.OID.oidhex2name[P])throw"undefined OID(hex) in KJUR.crypto.OID: "+P;return(A=new a({curve:ae.crypto.OID.oidhex2name[P]})).setPublicKeyHex(T),A.setPrivateKeyHex(C),A.isPublic=!1,A}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED"))return w=o(n=h.getDecryptedKeyHex(e,t),0,[1],"02"),F=o(n,0,[2],"02"),S=o(n,0,[3],"02"),E=o(n,0,[4],"02"),x=o(n,0,[5],"02"),(C=new u).setPrivate(new _(w,16),new _(F,16),new _(S,16),new _(E,16),new _(x,16)),C;if(-1!=e.indexOf("-END ENCRYPTED PRIVATE KEY-"))return h.getKeyFromEncryptedPKCS8PEM(e,t);throw"not supported argument"},Le.generateKeypair=function(e,t){if("RSA"==e){var r=t;(s=new re).generate(r,"10001"),s.isPrivate=!0,s.isPublic=!0;var n=new re,i=s.n.toString(16),o=s.e.toString(16);return n.setPublic(i,o),n.isPrivate=!1,n.isPublic=!0,(a={}).prvKeyObj=s,a.pubKeyObj=n,a}if("EC"==e){var s,a,u=t,c=new ae.crypto.ECDSA({curve:u}).generateKeyPairHex();return(s=new ae.crypto.ECDSA({curve:u})).setPublicKeyHex(c.ecpubhex),s.setPrivateKeyHex(c.ecprvhex),s.isPrivate=!0,s.isPublic=!1,(n=new ae.crypto.ECDSA({curve:u})).setPublicKeyHex(c.ecpubhex),n.isPrivate=!1,n.isPublic=!0,(a={}).prvKeyObj=s,a.pubKeyObj=n,a}throw"unknown algorithm: "+e},Le.getPEM=function(e,t,r,n,i,o){var s=ae,a=s.asn1,u=a.DERObjectIdentifier,c=a.DERInteger,l=a.ASN1Util.newObject,h=a.x509.SubjectPublicKeyInfo,f=s.crypto,d=f.DSA,p=f.ECDSA,g=re;function m(e){return l({seq:[{int:0},{int:{bigint:e.n}},{int:e.e},{int:{bigint:e.d}},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.dmp1}},{int:{bigint:e.dmq1}},{int:{bigint:e.coeff}}]})}function y(e){return l({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a0",!0,{oid:{name:e.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]})}function b(e){return l({seq:[{int:0},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}},{int:{bigint:e.y}},{int:{bigint:e.x}}]})}if((void 0!==g&&e instanceof g||void 0!==d&&e instanceof d||void 0!==p&&e instanceof p)&&1==e.isPublic&&(void 0===t||"PKCS8PUB"==t))return De(S=new h(e).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==t&&void 0!==g&&e instanceof g&&(void 0===r||null==r)&&1==e.isPrivate)return De(S=m(e).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==t&&void 0!==p&&e instanceof p&&(void 0===r||null==r)&&1==e.isPrivate){var w=new u({name:e.curveName}).getEncodedHex(),F=y(e).getEncodedHex(),_="";return(_+=De(w,"EC PARAMETERS"))+De(F,"EC PRIVATE KEY")}if("PKCS1PRV"==t&&void 0!==d&&e instanceof d&&(void 0===r||null==r)&&1==e.isPrivate)return De(S=b(e).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==t&&void 0!==g&&e instanceof g&&void 0!==r&&null!=r&&1==e.isPrivate){var S=m(e).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",S,r,n,o)}if("PKCS5PRV"==t&&void 0!==p&&e instanceof p&&void 0!==r&&null!=r&&1==e.isPrivate)return S=y(e).getEncodedHex(),void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",S,r,n,o);if("PKCS5PRV"==t&&void 0!==d&&e instanceof d&&void 0!==r&&null!=r&&1==e.isPrivate)return S=b(e).getEncodedHex(),void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",S,r,n,o);var E=function(e,t){var r=x(e,t);return new l({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:r.pbkdf2Salt}},{int:r.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:r.encryptionSchemeIV}}]}]}]},{octstr:{hex:r.ciphertext}}]}).getEncodedHex()},x=function(e,t){var r=v.lib.WordArray.random(8),n=v.lib.WordArray.random(8),i=v.PBKDF2(t,r,{keySize:6,iterations:100}),o=v.enc.Hex.parse(e),s=v.TripleDES.encrypt(o,i,{iv:n})+"",a={};return a.ciphertext=s,a.pbkdf2Salt=v.enc.Hex.stringify(r),a.pbkdf2Iter=100,a.encryptionSchemeAlg="DES-EDE3-CBC",a.encryptionSchemeIV=v.enc.Hex.stringify(n),a};if("PKCS8PRV"==t&&null!=g&&e instanceof g&&1==e.isPrivate){var D=m(e).getEncodedHex();return S=l({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:D}}]}).getEncodedHex(),void 0===r||null==r?De(S,"PRIVATE KEY"):De(F=E(S,r),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==t&&void 0!==p&&e instanceof p&&1==e.isPrivate)return D=new l({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]}).getEncodedHex(),S=l({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:D}}]}).getEncodedHex(),void 0===r||null==r?De(S,"PRIVATE KEY"):De(F=E(S,r),"ENCRYPTED PRIVATE KEY");if("PKCS8PRV"==t&&void 0!==d&&e instanceof d&&1==e.isPrivate)return D=new c({bigint:e.x}).getEncodedHex(),S=l({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:D}}]}).getEncodedHex(),void 0===r||null==r?De(S,"PRIVATE KEY"):De(F=E(S,r),"ENCRYPTED PRIVATE KEY");throw"unsupported object nor format"},Le.getKeyFromCSRPEM=function(e){var t=ke(e,"CERTIFICATE REQUEST");return Le.getKeyFromCSRHex(t)},Le.getKeyFromCSRHex=function(e){var t=Le.parseCSRHex(e);return Le.getKey(t.p8pubkeyhex,null,"pkcs8pub")},Le.parseCSRHex=function(e){var t=le,r=t.getChildIdx,n=t.getTLV,i={},o=e;if("30"!=o.substr(0,2))throw"malformed CSR(code:001)";var s=r(o,0);if(s.length<1)throw"malformed CSR(code:002)";if("30"!=o.substr(s[0],2))throw"malformed CSR(code:003)";var a=r(o,s[0]);if(a.length<3)throw"malformed CSR(code:004)";return i.p8pubkeyhex=n(o,a[2]),i},Le.getJWKFromKey=function(e){var t={};if(e instanceof re&&e.isPrivate)return t.kty="RSA",t.n=ve(e.n.toString(16)),t.e=ve(e.e.toString(16)),t.d=ve(e.d.toString(16)),t.p=ve(e.p.toString(16)),t.q=ve(e.q.toString(16)),t.dp=ve(e.dmp1.toString(16)),t.dq=ve(e.dmq1.toString(16)),t.qi=ve(e.coeff.toString(16)),t;if(e instanceof re&&e.isPublic)return t.kty="RSA",t.n=ve(e.n.toString(16)),t.e=ve(e.e.toString(16)),t;if(e instanceof ae.crypto.ECDSA&&e.isPrivate){if("P-256"!==(n=e.getShortNISTPCurveName())&&"P-384"!==n)throw"unsupported curve name for JWT: "+n;var r=e.getPublicKeyXYHex();return t.kty="EC",t.crv=n,t.x=ve(r.x),t.y=ve(r.y),t.d=ve(e.prvKeyHex),t}if(e instanceof ae.crypto.ECDSA&&e.isPublic){var n;if("P-256"!==(n=e.getShortNISTPCurveName())&&"P-384"!==n)throw"unsupported curve name for JWT: "+n;return r=e.getPublicKeyXYHex(),t.kty="EC",t.crv=n,t.x=ve(r.x),t.y=ve(r.y),t}throw"not supported key object"},re.getPosArrayOfChildrenFromHex=function(e){return le.getChildIdx(e,0)},re.getHexValueArrayOfChildrenFromHex=function(e){var t,r=le.getV,n=r(e,(t=re.getPosArrayOfChildrenFromHex(e))[0]),i=r(e,t[1]),o=r(e,t[2]),s=r(e,t[3]),a=r(e,t[4]),u=r(e,t[5]),c=r(e,t[6]),l=r(e,t[7]),h=r(e,t[8]);return(t=new Array).push(n,i,o,s,a,u,c,l,h),t},re.prototype.readPrivateKeyFromPEMString=function(e){var t=ke(e),r=re.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])},re.prototype.readPKCS5PrvKeyHex=function(e){var t=re.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},re.prototype.readPKCS8PrvKeyHex=function(e){var t,r,n,i,o,s,a,u,c=le,l=c.getVbyList;if(!1===c.isASN1HEX(e))throw"not ASN.1 hex string";try{t=l(e,0,[2,0,1],"02"),r=l(e,0,[2,0,2],"02"),n=l(e,0,[2,0,3],"02"),i=l(e,0,[2,0,4],"02"),o=l(e,0,[2,0,5],"02"),s=l(e,0,[2,0,6],"02"),a=l(e,0,[2,0,7],"02"),u=l(e,0,[2,0,8],"02")}catch(e){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(t,r,n,i,o,s,a,u)},re.prototype.readPKCS5PubKeyHex=function(e){var t=le,r=t.getV;if(!1===t.isASN1HEX(e))throw"keyHex is not ASN.1 hex string";var n=t.getChildIdx(e,0);if(2!==n.length||"02"!==e.substr(n[0],2)||"02"!==e.substr(n[1],2))throw"wrong hex for PKCS#5 public key";var i=r(e,n[0]),o=r(e,n[1]);this.setPublic(i,o)},re.prototype.readPKCS8PubKeyHex=function(e){var t=le;if(!1===t.isASN1HEX(e))throw"not ASN.1 hex string";if("06092a864886f70d010101"!==t.getTLVbyList(e,0,[0,0]))throw"not PKCS8 RSA public key";var r=t.getTLVbyList(e,0,[1,0]);this.readPKCS5PubKeyHex(r)},re.prototype.readCertPubKeyHex=function(e,t){var r,n;(r=new He).readCertHex(e),n=r.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};var Ne=new RegExp("");function Oe(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r+="0";return r+e}function Ue(e,t,r){for(var n="",i=0;n.length<t;)n+=Fe(r(_e(e+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])))),i+=1;return n}function Me(e){for(var t in ae.crypto.Util.DIGESTINFOHEAD){var r=ae.crypto.Util.DIGESTINFOHEAD[t],n=r.length;if(e.substring(0,n)==r)return[t,e.substring(n)]}return[]}function He(){var e=le,t=e.getChildIdx,r=e.getV,n=e.getTLV,i=e.getVbyList,o=e.getTLVbyList,s=e.getIdxbyList,a=e.getVidx,u=e.oidname,c=He,l=ke;this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==o(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return i(this.hex,0,[0,1+this.foffset],"02")},this.getSignatureAlgorithmField=function(){return u(i(this.hex,0,[0,2+this.foffset,0],"06"))},this.getIssuerHex=function(){return o(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return c.hex2dn(this.getIssuerHex())},this.getSubjectHex=function(){return o(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return c.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var e=i(this.hex,0,[0,4+this.foffset,0]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getNotAfter=function(){var e=i(this.hex,0,[0,4+this.foffset,1]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getPublicKeyHex=function(){return e.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return s(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var e=this.getPublicKeyIdx();return s(this.hex,e,[1,0],"30")},this.getPublicKey=function(){return Le.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){return u(i(this.hex,0,[1,0],"06"))},this.getSignatureValueHex=function(){return i(this.hex,0,[2],"03",!0)},this.verifySignature=function(e){var t=this.getSignatureAlgorithmName(),r=this.getSignatureValueHex(),n=o(this.hex,0,[0],"30"),i=new ae.crypto.Signature({alg:t});return i.init(e),i.updateHex(n),i.verify(r)},this.parseExt=function(){if(3!==this.version)return-1;var r=s(this.hex,0,[0,7,0],"30"),n=t(this.hex,r);this.aExtInfo=new Array;for(var o=0;o<n.length;o++){var u={critical:!1},c=0;3===t(this.hex,n[o]).length&&(u.critical=!0,c=1),u.oid=e.hextooidstr(i(this.hex,n[o],[0],"06"));var l=s(this.hex,n[o],[1+c]);u.vidx=a(this.hex,l),this.aExtInfo.push(u)}},this.getExtInfo=function(e){var t=this.aExtInfo,r=e;if(e.match(/^[0-9.]+$/)||(r=ae.asn1.x509.OID.name2oid(e)),""!==r)for(var n=0;n<t.length;n++)if(t[n].oid===r)return t[n]},this.getExtBasicConstraints=function(){var e=this.getExtInfo("basicConstraints");if(void 0===e)return e;var t=r(this.hex,e.vidx);if(""===t)return{};if("0101ff"===t)return{cA:!0};if("0101ff02"===t.substr(0,8)){var n=r(t,6);return{cA:!0,pathLen:parseInt(n,16)}}throw"basicConstraints parse error"},this.getExtKeyUsageBin=function(){var e=this.getExtInfo("keyUsage");if(void 0===e)return"";var t=r(this.hex,e.vidx);if(t.length%2!=0||t.length<=2)throw"malformed key usage value";var n=parseInt(t.substr(0,2)),i=parseInt(t.substr(2),16).toString(2);return i.substr(0,i.length-n)},this.getExtKeyUsageString=function(){for(var e=this.getExtKeyUsageBin(),t=new Array,r=0;r<e.length;r++)"1"==e.substr(r,1)&&t.push(He.KEYUSAGE_NAME[r]);return t.join(",")},this.getExtSubjectKeyIdentifier=function(){var e=this.getExtInfo("subjectKeyIdentifier");return void 0===e?e:r(this.hex,e.vidx)},this.getExtAuthorityKeyIdentifier=function(){var e=this.getExtInfo("authorityKeyIdentifier");if(void 0===e)return e;for(var i={},o=n(this.hex,e.vidx),s=t(o,0),a=0;a<s.length;a++)"80"===o.substr(s[a],2)&&(i.kid=r(o,s[a]));return i},this.getExtExtKeyUsageName=function(){var e=this.getExtInfo("extKeyUsage");if(void 0===e)return e;var i=new Array,o=n(this.hex,e.vidx);if(""===o)return i;for(var s=t(o,0),a=0;a<s.length;a++)i.push(u(r(o,s[a])));return i},this.getExtSubjectAltName=function(){for(var e=this.getExtSubjectAltName2(),t=new Array,r=0;r<e.length;r++)"DNS"===e[r][0]&&t.push(e[r][1]);return t},this.getExtSubjectAltName2=function(){var e,i,o,s=this.getExtInfo("subjectAltName");if(void 0===s)return s;for(var a=new Array,u=n(this.hex,s.vidx),c=t(u,0),l=0;l<c.length;l++)o=u.substr(c[l],2),e=r(u,c[l]),"81"===o&&(i=we(e),a.push(["MAIL",i])),"82"===o&&(i=we(e),a.push(["DNS",i])),"84"===o&&(i=He.hex2dn(e,0),a.push(["DN",i])),"86"===o&&(i=we(e),a.push(["URI",i])),"87"===o&&(i=Ie(e),a.push(["IP",i]));return a},this.getExtCRLDistributionPointsURI=function(){var e=this.getExtInfo("cRLDistributionPoints");if(void 0===e)return e;for(var r=new Array,n=t(this.hex,e.vidx),o=0;o<n.length;o++)try{var s=we(i(this.hex,n[o],[0,0,0],"86"));r.push(s)}catch(e){}return r},this.getExtAIAInfo=function(){var e=this.getExtInfo("authorityInfoAccess");if(void 0===e)return e;for(var r={ocsp:[],caissuer:[]},n=t(this.hex,e.vidx),o=0;o<n.length;o++){var s=i(this.hex,n[o],[0],"06"),a=i(this.hex,n[o],[1],"86");"2b06010505073001"===s&&r.ocsp.push(we(a)),"2b06010505073002"===s&&r.caissuer.push(we(a))}return r},this.getExtCertificatePolicies=function(){var e=this.getExtInfo("certificatePolicies");if(void 0===e)return e;for(var o=n(this.hex,e.vidx),s=[],a=t(o,0),c=0;c<a.length;c++){var l={},h=t(o,a[c]);if(l.id=u(r(o,h[0])),2===h.length)for(var f=t(o,h[1]),d=0;d<f.length;d++){var p=i(o,f[d],[0],"06");"2b06010505070201"===p?l.cps=we(i(o,f[d],[1])):"2b06010505070202"===p&&(l.unotice=we(i(o,f[d],[1,0])))}s.push(l)}return s},this.readCertPEM=function(e){this.readCertHex(l(e))},this.readCertHex=function(e){this.hex=e,this.getVersion();try{s(this.hex,0,[0,7],"a3"),this.parseExt()}catch(e){}},this.getInfo=function(){var e,t,r;if(e="Basic Fields\n",e+="  serial number: "+this.getSerialNumberHex()+"\n",e+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",e+="  issuer: "+this.getIssuerString()+"\n",e+="  notBefore: "+this.getNotBefore()+"\n",e+="  notAfter: "+this.getNotAfter()+"\n",e+="  subject: "+this.getSubjectString()+"\n",e+="  subject public key info: \n",e+="    key algorithm: "+(t=this.getPublicKey()).type+"\n","RSA"===t.type&&(e+="    n="+$e(t.n.toString(16)).substr(0,16)+"...\n",e+="    e="+$e(t.e.toString(16))+"\n"),void 0!==(r=this.aExtInfo)&&null!==r){e+="X509v3 Extensions:\n";for(var n=0;n<r.length;n++){var i=r[n],o=ae.asn1.x509.OID.oid2name(i.oid);""===o&&(o=i.oid);var s="";if(!0===i.critical&&(s="CRITICAL"),e+="  "+o+" "+s+":\n","basicConstraints"===o){var a=this.getExtBasicConstraints();void 0===a.cA?e+="    {}\n":(e+="    cA=true",void 0!==a.pathLen&&(e+=", pathLen="+a.pathLen),e+="\n")}else if("keyUsage"===o)e+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===o)e+="    "+this.getExtSubjectKeyIdentifier()+"\n";else if("authorityKeyIdentifier"===o){var u=this.getExtAuthorityKeyIdentifier();void 0!==u.kid&&(e+="    kid="+u.kid+"\n")}else if("extKeyUsage"===o)e+="    "+this.getExtExtKeyUsageName().join(", ")+"\n";else if("subjectAltName"===o)e+="    "+this.getExtSubjectAltName2()+"\n";else if("cRLDistributionPoints"===o)e+="    "+this.getExtCRLDistributionPointsURI()+"\n";else if("authorityInfoAccess"===o){var c=this.getExtAIAInfo();void 0!==c.ocsp&&(e+="    ocsp: "+c.ocsp.join(",")+"\n"),void 0!==c.caissuer&&(e+="    caissuer: "+c.caissuer.join(",")+"\n")}else if("certificatePolicies"===o)for(var l=this.getExtCertificatePolicies(),h=0;h<l.length;h++)void 0!==l[h].id&&(e+="    policy oid: "+l[h].id+"\n"),void 0!==l[h].cps&&(e+="    cps: "+l[h].cps+"\n")}}return(e+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n")+"signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"}}Ne.compile("[^0-9a-f]","gi"),re.prototype.sign=function(e,t){var r=function(e){return ae.crypto.Util.hashString(e,t)}(e);return this.signWithMessageHash(r,t)},re.prototype.signWithMessageHash=function(e,t){var r=ee(ae.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),16);return Oe(this.doPrivate(r).toString(16),this.n.bitLength())},re.prototype.signPSS=function(e,t,r){var n=function(e){return ae.crypto.Util.hashHex(e,t)}(_e(e));return void 0===r&&(r=-1),this.signWithMessageHashPSS(n,t,r)},re.prototype.signWithMessageHashPSS=function(e,t,r){var n,i=Fe(e),o=i.length,s=this.n.bitLength()-1,a=Math.ceil(s/8),u=function(e){return ae.crypto.Util.hashHex(e,t)};if(-1===r||void 0===r)r=o;else if(-2===r)r=a-o-2;else if(r<-2)throw"invalid salt length";if(a<o+r+2)throw"data too long";var c="";r>0&&(c=new Array(r),(new Q).nextBytes(c),c=String.fromCharCode.apply(String,c));var l=Fe(u(_e("\0\0\0\0\0\0\0\0"+i+c))),h=[];for(n=0;n<a-r-o-2;n+=1)h[n]=0;var f=String.fromCharCode.apply(String,h)+""+c,d=Ue(l,f.length,u),p=[];for(n=0;n<f.length;n+=1)p[n]=f.charCodeAt(n)^d.charCodeAt(n);var g=65280>>8*a-s&255;for(p[0]&=~g,n=0;n<o;n++)p.push(l.charCodeAt(n));return p.push(188),Oe(this.doPrivate(new _(p)).toString(16),this.n.bitLength())},re.prototype.verify=function(e,t){var r=ee(t=(t=t.replace(Ne,"")).replace(/[ \n]+/g,""),16);if(r.bitLength()>this.n.bitLength())return 0;var n=Me(this.doPublic(r).toString(16).replace(/^1f+00/,""));if(0==n.length)return!1;var i=n[0];return n[1]==function(e){return ae.crypto.Util.hashString(e,i)}(e)},re.prototype.verifyWithMessageHash=function(e,t){var r=ee(t=(t=t.replace(Ne,"")).replace(/[ \n]+/g,""),16);if(r.bitLength()>this.n.bitLength())return 0;var n=Me(this.doPublic(r).toString(16).replace(/^1f+00/,""));return 0!=n.length&&(n[0],n[1]==e)},re.prototype.verifyPSS=function(e,t,r,n){var i=function(e){return ae.crypto.Util.hashHex(e,r)}(_e(e));return void 0===n&&(n=-1),this.verifyWithMessageHashPSS(i,t,r,n)},re.prototype.verifyWithMessageHashPSS=function(e,t,r,n){var i=new _(t,16);if(i.bitLength()>this.n.bitLength())return!1;var o,s=function(e){return ae.crypto.Util.hashHex(e,r)},a=Fe(e),u=a.length,c=this.n.bitLength()-1,l=Math.ceil(c/8);if(-1===n||void 0===n)n=u;else if(-2===n)n=l-u-2;else if(n<-2)throw"invalid salt length";if(l<u+n+2)throw"data too long";var h=this.doPublic(i).toByteArray();for(o=0;o<h.length;o+=1)h[o]&=255;for(;h.length<l;)h.unshift(0);if(188!==h[l-1])throw"encoded message does not end in 0xbc";var f=(h=String.fromCharCode.apply(String,h)).substr(0,l-u-1),d=h.substr(f.length,u),p=65280>>8*l-c&255;if(0!=(f.charCodeAt(0)&p))throw"bits beyond keysize not zero";var g=Ue(d,f.length,s),m=[];for(o=0;o<f.length;o+=1)m[o]=f.charCodeAt(o)^g.charCodeAt(o);m[0]&=~p;var v=l-u-n-2;for(o=0;o<v;o+=1)if(0!==m[o])throw"leftmost octets not zero";if(1!==m[v])throw"0x01 marker not found";return d===Fe(s(_e("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,m.slice(-n)))))},re.SALT_LEN_HLEN=-1,re.SALT_LEN_MAX=-2,re.SALT_LEN_RECOVER=-2,He.hex2dn=function(e,t){if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw"malformed DN";for(var r=new Array,n=le.getChildIdx(e,t),i=0;i<n.length;i++)r.push(He.hex2rdn(e,n[i]));return"/"+(r=r.map((function(e){return e.replace("/","\\/")}))).join("/")},He.hex2rdn=function(e,t){if(void 0===t&&(t=0),"31"!==e.substr(t,2))throw"malformed RDN";for(var r=new Array,n=le.getChildIdx(e,t),i=0;i<n.length;i++)r.push(He.hex2attrTypeValue(e,n[i]));return(r=r.map((function(e){return e.replace("+","\\+")}))).join("+")},He.hex2attrTypeValue=function(e,t){var r=le,n=r.getV;if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw"malformed attribute type and value";var i=r.getChildIdx(e,t);2!==i.length||e.substr(i[0],2);var o=n(e,i[0]),s=ae.asn1.ASN1Util.oidHexToInt(o);return ae.asn1.x509.OID.oid2atype(s)+"="+Fe(n(e,i[1]))},He.getPublicKeyFromCertHex=function(e){var t=new He;return t.readCertHex(e),t.getPublicKey()},He.getPublicKeyFromCertPEM=function(e){var t=new He;return t.readCertPEM(e),t.getPublicKey()},He.getPublicKeyInfoPropOfCertPEM=function(e){var t,r,n=le.getVbyList,i={algparam:null};return(t=new He).readCertPEM(e),r=t.getPublicKeyHex(),i.keyhex=n(r,0,[1],"03").substr(2),i.algoid=n(r,0,[0,0],"06"),"2a8648ce3d0201"===i.algoid&&(i.algparam=n(r,0,[0,1],"06")),i},He.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==ae&&ae||(t.KJUR=ae={}),void 0!==ae.jws&&ae.jws||(ae.jws={}),ae.jws.JWS=function(){var e=ae.jws.JWS.isSafeJSONString;this.parseJWS=function(t,r){if(void 0===this.parsedJWS||!r&&void 0===this.parsedJWS.sigvalH){var n=t.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==n)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var i=n[1],o=n[2],s=n[3],a=i+"."+o;if(this.parsedJWS={},this.parsedJWS.headB64U=i,this.parsedJWS.payloadB64U=o,this.parsedJWS.sigvalB64U=s,this.parsedJWS.si=a,!r){var u=ye(s),c=ee(u,16);this.parsedJWS.sigvalH=u,this.parsedJWS.sigvalBI=c}var l=ce(i),h=ce(o);if(this.parsedJWS.headS=l,this.parsedJWS.payloadS=h,!e(l,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+l}}},ae.jws.JWS.sign=function(e,t,n,i,o){var s,a,u,c=ae,l=c.jws.JWS,h=l.readSafeJSONString,f=l.isSafeJSONString,d=c.crypto,p=(d.ECDSA,d.Mac),g=d.Signature,m=JSON;if("string"!=typeof t&&"object"!=(void 0===t?"undefined":r(t)))throw"spHeader must be JSON string or object: "+t;if("object"==(void 0===t?"undefined":r(t))&&(a=t,s=m.stringify(a)),"string"==typeof t){if(!f(s=t))throw"JWS Head is not safe JSON string: "+s;a=h(s)}if(u=n,"object"==(void 0===n?"undefined":r(n))&&(u=m.stringify(n)),""!=e&&null!=e||void 0===a.alg||(e=a.alg),""!=e&&null!=e&&void 0===a.alg&&(a.alg=e,s=m.stringify(a)),e!==a.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+a.alg;var v=null;if(void 0===l.jwsalg2sigalg[e])throw"unsupported alg name: "+e;v=l.jwsalg2sigalg[e];var y=ue(s)+"."+ue(u),b="";if("Hmac"==v.substr(0,4)){if(void 0===i)throw"mac key shall be specified for HS* alg";var w=new p({alg:v,prov:"cryptojs",pass:i});w.updateString(y),b=w.doFinal()}else{var F;-1!=v.indexOf("withECDSA")?((F=new g({alg:v})).init(i,o),F.updateString(y),hASN1Sig=F.sign(),b=ae.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig)):"none"!=v&&((F=new g({alg:v})).init(i,o),F.updateString(y),b=F.sign())}return y+"."+ve(b)},ae.jws.JWS.verify=function(e,t,n){var i,o=ae,s=o.jws.JWS,a=s.readSafeJSONString,u=o.crypto,c=u.ECDSA,l=u.Mac,h=u.Signature;void 0!==r(re)&&(i=re);var f=e.split(".");if(3!==f.length)return!1;var d,p=f[0]+"."+f[1],g=ye(f[2]),m=a(ce(f[0])),v=null;if(void 0===m.alg)throw"algorithm not specified in header";if(d=(v=m.alg).substr(0,2),null!=n&&"[object Array]"===Object.prototype.toString.call(n)&&n.length>0&&-1==(":"+n.join(":")+":").indexOf(":"+v+":"))throw"algorithm '"+v+"' not accepted in the list";if("none"!=v&&null===t)throw"key shall be specified to verify.";if("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&(t=Le.getKey(t)),!("RS"!=d&&"PS"!=d||t instanceof i))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==d&&!(t instanceof c))throw"key shall be a ECDSA obj for ES* algs";var y=null;if(void 0===s.jwsalg2sigalg[m.alg])throw"unsupported alg name: "+v;if("none"==(y=s.jwsalg2sigalg[v]))throw"not supported";if("Hmac"==y.substr(0,4)){if(void 0===t)throw"hexadecimal key shall be specified for HMAC";var b=new l({alg:y,pass:t});return b.updateString(p),g==b.doFinal()}if(-1!=y.indexOf("withECDSA")){var w,F=null;try{F=c.concatSigToASN1Sig(g)}catch(e){return!1}return(w=new h({alg:y})).init(t),w.updateString(p),w.verify(F)}return(w=new h({alg:y})).init(t),w.updateString(p),w.verify(g)},ae.jws.JWS.parse=function(e){var t,r,n,i=e.split("."),o={};if(2!=i.length&&3!=i.length)throw"malformed sJWS: wrong number of '.' splitted elements";return t=i[0],r=i[1],3==i.length&&(n=i[2]),o.headerObj=ae.jws.JWS.readSafeJSONString(ce(t)),o.payloadObj=ae.jws.JWS.readSafeJSONString(ce(r)),o.headerPP=JSON.stringify(o.headerObj,null,"  "),null==o.payloadObj?o.payloadPP=ce(r):o.payloadPP=JSON.stringify(o.payloadObj,null,"  "),void 0!==n&&(o.sigHex=ye(n)),o},ae.jws.JWS.verifyJWT=function(e,t,n){var i=ae.jws,o=i.JWS,s=o.readSafeJSONString,a=o.inArray,u=o.includedArray,c=e.split("."),l=c[0],h=c[1],f=(ye(c[2]),s(ce(l))),d=s(ce(h));if(void 0===f.alg)return!1;if(void 0===n.alg)throw"acceptField.alg shall be specified";if(!a(f.alg,n.alg))return!1;if(void 0!==d.iss&&"object"===r(n.iss)&&!a(d.iss,n.iss))return!1;if(void 0!==d.sub&&"object"===r(n.sub)&&!a(d.sub,n.sub))return!1;if(void 0!==d.aud&&"object"===r(n.aud))if("string"==typeof d.aud){if(!a(d.aud,n.aud))return!1}else if("object"==r(d.aud)&&!u(d.aud,n.aud))return!1;var p=i.IntDate.getNow();return void 0!==n.verifyAt&&"number"==typeof n.verifyAt&&(p=n.verifyAt),void 0!==n.gracePeriod&&"number"==typeof n.gracePeriod||(n.gracePeriod=0),!(void 0!==d.exp&&"number"==typeof d.exp&&d.exp+n.gracePeriod<p||void 0!==d.nbf&&"number"==typeof d.nbf&&p<d.nbf-n.gracePeriod||void 0!==d.iat&&"number"==typeof d.iat&&p<d.iat-n.gracePeriod||void 0!==d.jti&&void 0!==n.jti&&d.jti!==n.jti||!o.verify(e,t,n.alg))},ae.jws.JWS.includedArray=function(e,t){var n=ae.jws.JWS.inArray;if(null===e)return!1;if("object"!==(void 0===e?"undefined":r(e)))return!1;if("number"!=typeof e.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],t))return!1;return!0},ae.jws.JWS.inArray=function(e,t){if(null===t)return!1;if("object"!==(void 0===t?"undefined":r(t)))return!1;if("number"!=typeof t.length)return!1;for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},ae.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},ae.jws.JWS.isSafeJSONString=function(e,t,n){var i=null;try{return"object"!=(void 0===(i=se(e))?"undefined":r(i))||i.constructor===Array?0:(t&&(t[n]=i),1)}catch(e){return 0}},ae.jws.JWS.readSafeJSONString=function(e){var t=null;try{return"object"!=(void 0===(t=se(e))?"undefined":r(t))||t.constructor===Array?null:t}catch(e){return null}},ae.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==t)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]},ae.jws.JWS.getJWKthumbprint=function(e){if("RSA"!==e.kty&&"EC"!==e.kty&&"oct"!==e.kty)throw"unsupported algorithm for JWK Thumprint";var t="{";if("RSA"===e.kty){if("string"!=typeof e.n||"string"!=typeof e.e)throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if("EC"===e.kty){if("string"!=typeof e.crv||"string"!=typeof e.x||"string"!=typeof e.y)throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if("oct"===e.kty){if("string"!=typeof e.k)throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var r=_e(t);return ve(ae.crypto.Util.hashHex(r,"sha256"))},ae.jws.IntDate={},ae.jws.IntDate.get=function(e){var t=ae.jws.IntDate,r=t.getNow,n=t.getZulu;if("now"==e)return r();if("now + 1hour"==e)return r()+3600;if("now + 1day"==e)return r()+86400;if("now + 1month"==e)return r()+2592e3;if("now + 1year"==e)return r()+31536e3;if(e.match(/Z$/))return n(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e},ae.jws.IntDate.getZulu=function(e){return Ce(e)},ae.jws.IntDate.getNow=function(){return~~(new Date/1e3)},ae.jws.IntDate.intDate2UTCString=function(e){return new Date(1e3*e).toUTCString()},ae.jws.IntDate.intDate2Zulu=function(e){var t=new Date(1e3*e);return("0000"+t.getUTCFullYear()).slice(-4)+("00"+(t.getUTCMonth()+1)).slice(-2)+("00"+t.getUTCDate()).slice(-2)+("00"+t.getUTCHours()).slice(-2)+("00"+t.getUTCMinutes()).slice(-2)+("00"+t.getUTCSeconds()).slice(-2)+"Z"},t.SecureRandom=Q,t.rng_seed_time=W,t.BigInteger=_,t.RSAKey=re;var qe=ae.crypto.EDSA;t.EDSA=qe;var Ve=ae.crypto.DSA;t.DSA=Ve;var Ke=ae.crypto.Signature;t.Signature=Ke;var ze=ae.crypto.MessageDigest;t.MessageDigest=ze;var Je=ae.crypto.Mac;t.Mac=Je;var We=ae.crypto.Cipher;t.Cipher=We,t.KEYUTIL=Le,t.ASN1HEX=le,t.X509=He,t.CryptoJS=v,t.b64tohex=w,t.b64toBA=F,t.stoBA=he,t.BAtos=fe,t.BAtohex=de,t.stohex=pe,t.stob64=function(e){return b(pe(e))},t.stob64u=function(e){return ge(b(pe(e)))},t.b64utos=function(e){return fe(F(me(e)))},t.b64tob64u=ge,t.b64utob64=me,t.hex2b64=b,t.hextob64u=ve,t.b64utohex=ye,t.utf8tob64u=ue,t.b64utoutf8=ce,t.utf8tob64=function(e){return b(Pe(je(e)))},t.b64toutf8=function(e){return decodeURIComponent(Te(w(e)))},t.utf8tohex=be,t.hextoutf8=we,t.hextorstr=Fe,t.rstrtohex=_e,t.hextob64=Se,t.hextob64nl=Ee,t.b64nltohex=xe,t.hextopem=De,t.pemtohex=ke,t.hextoArrayBuffer=function(e){if(e.length%2!=0)throw"input is not even length";if(null==e.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var t=new ArrayBuffer(e.length/2),r=new DataView(t),n=0;n<e.length/2;n++)r.setUint8(n,parseInt(e.substr(2*n,2),16));return t},t.ArrayBuffertohex=function(e){for(var t="",r=new DataView(e),n=0;n<e.byteLength;n++)t+=("00"+r.getUint8(n).toString(16)).slice(-2);return t},t.zulutomsec=Ae,t.zulutosec=Ce,t.zulutodate=function(e){return new Date(Ae(e))},t.datetozulu=function(e,t,r){var n,i=e.getUTCFullYear();if(t){if(i<1950||2049<i)throw"not proper year for UTCTime: "+i;n=(""+i).slice(-2)}else n=("000"+i).slice(-4);if(n+=("0"+(e.getUTCMonth()+1)).slice(-2),n+=("0"+e.getUTCDate()).slice(-2),n+=("0"+e.getUTCHours()).slice(-2),n+=("0"+e.getUTCMinutes()).slice(-2),n+=("0"+e.getUTCSeconds()).slice(-2),r){var o=e.getUTCMilliseconds();0!==o&&(n+="."+(o=(o=("00"+o).slice(-3)).replace(/0+$/g,"")))}return n+"Z"},t.uricmptohex=Pe,t.hextouricmp=Te,t.ipv6tohex=Re,t.hextoipv6=Be,t.hextoip=Ie,t.iptohex=function(e){var t="malformed IP address";if(!(e=e.toLowerCase(e)).match(/^[0-9.]+$/)){if(e.match(/^[0-9a-f:]+$/)&&-1!==e.indexOf(":"))return Re(e);throw t}var r=e.split(".");if(4!==r.length)throw t;var n="";try{for(var i=0;i<4;i++)n+=("0"+parseInt(r[i]).toString(16)).slice(-2);return n}catch(e){throw t}},t.encodeURIComponentAll=je,t.newline_toUnix=function(e){return e.replace(/\r\n/gm,"\n")},t.newline_toDos=function(e){return(e=e.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")},t.hextoposhex=$e,t.intarystrtohex=function(e){e=(e=(e=e.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return e.split(/,/).map((function(e,t,r){var n=parseInt(e);if(n<0||255<n)throw"integer not in range 0-255";return("00"+n.toString(16)).slice(-2)})).join("")}catch(e){throw"malformed integer array string: "+e}},t.strdiffidx=function(e,t){var r=e.length;e.length>t.length&&(r=t.length);for(var n=0;n<r;n++)if(e.charCodeAt(n)!=t.charCodeAt(n))return n;return e.length!=t.length?r:-1},t.KJUR=ae;var Ye=ae.crypto;t.crypto=Ye;var Ge=ae.asn1;t.asn1=Ge;var Xe=ae.jws;t.jws=Xe;var Ze=ae.lang;t.lang=Ze}).call(this,r(27).Buffer)},function(e,t,r){(function(e){
/*!
     * The buffer module from node.js, for the browser.
     *
     * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
     * @license  MIT
     */
var n=r(29),i=r(30),o=r(31);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,r)}function c(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t),e}(e,t,r,n):"string"==typeof t?function(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(t,r),i=(e=a(e,n)).write(t,r);return i!==n&&(e=e.slice(0,i)),e}(e,t,r):function(e,t){if(u.isBuffer(t)){var r=0|d(t.length);return 0===(e=a(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(l(t),e=a(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function f(e,t){var r=t.length<0?0:0|d(t.length);e=a(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function d(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return M(e).length;default:if(n)return U(e).length;t=(""+t).toLowerCase(),n=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){var o,s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(o=r;o<a;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(e,o+f)!==c(t,f)){h=!1;break}if(h)return o}return-1}function y(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function b(e,t,r,n){return H(U(t,e.length-r),e,r,n)}function w(e,t,r,n){return H(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function F(e,t,r,n){return w(e,t,r,n)}function _(e,t,r,n){return H(M(t),e,r,n)}function S(e,t,r,n){return H(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function E(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function x(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,u,c=e[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=r)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=h}return function(e){var t=e.length;if(t<=D)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=D));return r}(n)}t.Buffer=u,t.SlowBuffer=function(e){return+e!=e&&(e=0),u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,r){return c(null,e,t,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,r){return function(e,t,r,n){return l(t),t<=0?a(e,t):void 0!==r?"string"==typeof n?a(e,t).fill(r,n):a(e,t).fill(r):a(e,t)}(null,e,t,r)},u.allocUnsafe=function(e){return h(null,e)},u.allocUnsafeSlow=function(e){return h(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return C(this,t,r);case"utf8":case"utf-8":return x(this,t,r);case"ascii":return k(this,t,r);case"latin1":case"binary":return A(this,t,r);case"base64":return E(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,r,n,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(o,s),c=this.slice(n,i),l=e.slice(t,r),h=0;h<a;++h)if(c[h]!==l[h]){o=c[h],s=l[h];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return w(this,e,t,r);case"latin1":case"binary":return F(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var D=4096;function k(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function C(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=O(e[o]);return i}function P(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function T(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,r,n,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function B(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function I(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function j(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function $(e,t,r,n,o){return o||j(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function L(e,t,r,n,o){return o||j(e,0,r,8),i.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;r=new u(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},u.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||T(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},u.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||T(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},u.prototype.readUInt8=function(e,t){return t||T(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||T(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||T(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||T(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||T(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||T(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){t||T(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||T(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||T(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||T(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||T(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,r,n){e=+e,t|=0,r|=0,n||R(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},u.prototype.writeUIntBE=function(e,t,r,n){e=+e,t|=0,r|=0,n||R(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},u.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):I(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);R(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);R(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):I(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,r){return $(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return $(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return L(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return L(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=u.isBuffer(e)?e:U(new u(e,n).toString()),a=s.length;for(o=0;o<r-t;++o)this[o+t]=s[o%a]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function O(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function M(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}).call(this,r(28))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){t.byteLength=function(e){var t=c(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){for(var t,r=c(e),n=r[0],s=r[1],a=new o(function(e,t,r){return 3*(t+r)/4-r}(0,n,s)),u=0,l=s>0?n-4:n,h=0;h<l;h+=4)t=i[e.charCodeAt(h)]<<18|i[e.charCodeAt(h+1)]<<12|i[e.charCodeAt(h+2)]<<6|i[e.charCodeAt(h+3)],a[u++]=t>>16&255,a[u++]=t>>8&255,a[u++]=255&t;return 2===s&&(t=i[e.charCodeAt(h)]<<2|i[e.charCodeAt(h+1)]>>4,a[u++]=255&t),1===s&&(t=i[e.charCodeAt(h)]<<10|i[e.charCodeAt(h+1)]<<4|i[e.charCodeAt(h+2)]>>2,a[u++]=t>>8&255,a[u++]=255&t),a},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=0,a=r-i;s<a;s+=16383)o.push(l(e,s,s+16383>a?a:s+16383));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)n[a]=s[a],i[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e,t,r){for(var i,o,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,c=u>>1,l=-7,h=r?i-1:0,f=r?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),o-=c}return(d?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*u-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+d]=255&s,d+=p,s/=256,c-=8);e[r+d-p]|=128*g}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.jws,r=e.KeyUtil,i=e.X509,o=e.crypto,s=e.hextob64u,a=e.b64tohex,u=e.AllowedSigningAlgs;return function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.parseJwt=function e(r){n.Log.debug("JoseUtil.parseJwt");try{var i=t.JWS.parse(r);return{header:i.headerObj,payload:i.payloadObj}}catch(e){n.Log.error(e)}},e.validateJwt=function(t,o,s,u,c,l,h){n.Log.debug("JoseUtil.validateJwt");try{if("RSA"===o.kty)if(o.e&&o.n)o=r.getKey(o);else{if(!o.x5c||!o.x5c.length)return n.Log.error("JoseUtil.validateJwt: RSA key missing key material",o),Promise.reject(new Error("RSA key missing key material"));var f=a(o.x5c[0]);o=i.getPublicKeyFromCertHex(f)}else{if("EC"!==o.kty)return n.Log.error("JoseUtil.validateJwt: Unsupported key type",o&&o.kty),Promise.reject(new Error(o.kty));if(!(o.crv&&o.x&&o.y))return n.Log.error("JoseUtil.validateJwt: EC key missing key material",o),Promise.reject(new Error("EC key missing key material"));o=r.getKey(o)}return e._validateJwt(t,o,s,u,c,l,h)}catch(e){return n.Log.error(e&&e.message||e),Promise.reject("JWT validation failed")}},e.validateJwtAttributes=function(t,r,i,o,s,a){o||(o=0),s||(s=parseInt(Date.now()/1e3));var u=e.parseJwt(t).payload;if(!u.iss)return n.Log.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(u.iss!==r)return n.Log.error("JoseUtil._validateJwt: Invalid issuer in token",u.iss),Promise.reject(new Error("Invalid issuer in token: "+u.iss));if(!u.aud)return n.Log.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(u.aud===i||Array.isArray(u.aud)&&u.aud.indexOf(i)>=0))return n.Log.error("JoseUtil._validateJwt: Invalid audience in token",u.aud),Promise.reject(new Error("Invalid audience in token: "+u.aud));if(u.azp&&u.azp!==i)return n.Log.error("JoseUtil._validateJwt: Invalid azp in token",u.azp),Promise.reject(new Error("Invalid azp in token: "+u.azp));if(!a){var c=s+o,l=s-o;if(!u.iat)return n.Log.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(c<u.iat)return n.Log.error("JoseUtil._validateJwt: iat is in the future",u.iat),Promise.reject(new Error("iat is in the future: "+u.iat));if(u.nbf&&c<u.nbf)return n.Log.error("JoseUtil._validateJwt: nbf is in the future",u.nbf),Promise.reject(new Error("nbf is in the future: "+u.nbf));if(!u.exp)return n.Log.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(u.exp<l)return n.Log.error("JoseUtil._validateJwt: exp is in the past",u.exp),Promise.reject(new Error("exp is in the past:"+u.exp))}return Promise.resolve(u)},e._validateJwt=function(r,i,o,s,a,c,l){return e.validateJwtAttributes(r,o,s,a,c,l).then((function(e){try{return t.JWS.verify(r,i,u)?e:(n.Log.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed")))}catch(e){return n.Log.error(e&&e.message||e),Promise.reject(new Error("signature validation failed"))}}))},e.hashString=function e(t,r){try{return o.Util.hashString(t,r)}catch(e){n.Log.error(e)}},e.hexToBase64Url=function e(t){try{return s(t)}catch(e){n.Log.error(e)}},e}()};var n=r(0);e.exports=t.default},function(e,t,r){var n=r(34),i=r(35);e.exports=function(e,t,r){var o=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);e.exports=function(){return r(n),n}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,i=r;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SigninResponse=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(3);t.SigninResponse=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=i.UrlUtility.parseUrlFragment(t,r);this.error=n.error,this.error_description=n.error_description,this.error_uri=n.error_uri,this.code=n.code,this.state=n.state,this.id_token=n.id_token,this.session_state=n.session_state,this.access_token=n.access_token,this.token_type=n.token_type,this.scope=n.scope,this.profile=void 0,this.expires_in=n.expires_in}return n(e,[{key:"expires_in",get:function(){if(this.expires_at){var e=parseInt(Date.now()/1e3);return this.expires_at-e}},set:function(e){var t=parseInt(e);if("number"==typeof t&&t>0){var r=parseInt(Date.now()/1e3);this.expires_at=r+t}}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}},{key:"isOpenIdConnect",get:function(){return this.scopes.indexOf("openid")>=0||!!this.id_token}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SignoutRequest=void 0;var n=r(0),i=r(3),o=r(8);t.SignoutRequest=function e(t){var r=t.url,s=t.id_token_hint,a=t.post_logout_redirect_uri,u=t.data,c=t.extraQueryParams,l=t.request_type;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!r)throw n.Log.error("SignoutRequest.ctor: No url passed"),new Error("url");for(var h in s&&(r=i.UrlUtility.addQueryParam(r,"id_token_hint",s)),a&&(r=i.UrlUtility.addQueryParam(r,"post_logout_redirect_uri",a),u&&(this.state=new o.State({data:u,request_type:l}),r=i.UrlUtility.addQueryParam(r,"state",this.state.id))),c)r=i.UrlUtility.addQueryParam(r,h,c[h]);this.url=r}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SignoutResponse=void 0;var n=r(3);t.SignoutResponse=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=n.UrlUtility.parseUrlFragment(t,"?");this.error=r.error,this.error_description=r.error_description,this.error_uri=r.error_uri,this.state=r.state}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryWebStorage=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.InMemoryWebStorage=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={}}return e.prototype.getItem=function(e){return i.Log.debug("InMemoryWebStorage.getItem",e),this._data[e]},e.prototype.setItem=function(e,t){i.Log.debug("InMemoryWebStorage.setItem",e),this._data[e]=t},e.prototype.removeItem=function(e){i.Log.debug("InMemoryWebStorage.removeItem",e),delete this._data[e]},e.prototype.key=function(e){return Object.getOwnPropertyNames(this._data)[e]},n(e,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UserManager=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(9),s=r(41),a=r(15),u=r(47),c=r(49),l=r(18),h=r(20),f=r(10),d=r(4);t.UserManager=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.SilentRenewService,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.SessionMonitor,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.TokenRevocationClient,p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:f.TokenClient,g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:d.JoseUtil;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r instanceof s.UserManagerSettings||(r=new s.UserManagerSettings(r));var m=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r));return m._events=new u.UserManagerEvents(r),m._silentRenewService=new n(m),m.settings.automaticSilentRenew&&(i.Log.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),m.startSilentRenew()),m.settings.monitorSession&&(i.Log.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),m._sessionMonitor=new o(m)),m._tokenRevocationClient=new a(m._settings),m._tokenClient=new p(m._settings),m._joseUtil=g,m}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getUser=function(){var e=this;return this._loadUser().then((function(t){return t?(i.Log.info("UserManager.getUser: user loaded"),e._events.load(t,!1),t):(i.Log.info("UserManager.getUser: user not found in storage"),null)}))},t.prototype.removeUser=function(){var e=this;return this.storeUser(null).then((function(){i.Log.info("UserManager.removeUser: user removed from storage"),e._events.unload()}))},t.prototype.signinRedirect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="si:r";var t={useReplaceToNavigate:e.useReplaceToNavigate};return this._signinStart(e,this._redirectNavigator,t).then((function(){i.Log.info("UserManager.signinRedirect: successful")}))},t.prototype.signinRedirectCallback=function(e){return this._signinEnd(e||this._redirectNavigator.url).then((function(e){return e.profile&&e.profile.sub?i.Log.info("UserManager.signinRedirectCallback: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinRedirectCallback: no sub"),e}))},t.prototype.signinPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="si:p";var t=e.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return t?(e.redirect_uri=t,e.display="popup",this._signin(e,this._popupNavigator,{startUrl:t,popupWindowFeatures:e.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:e.popupWindowTarget||this.settings.popupWindowTarget}).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinPopup: no sub")),e}))):(i.Log.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))},t.prototype.signinPopupCallback=function(e){return this._signinCallback(e,this._popupNavigator).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinPopupCallback: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinPopupCallback: no sub")),e})).catch((function(e){i.Log.error(e.message)}))},t.prototype.signinSilent=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(t=Object.assign({},t)).request_type="si:s",this._loadUser().then((function(r){return r&&r.refresh_token?(t.refresh_token=r.refresh_token,e._useRefreshToken(t)):(t.id_token_hint=t.id_token_hint||e.settings.includeIdTokenInSilentRenew&&r&&r.id_token,r&&e._settings.validateSubOnSilentRenew&&(i.Log.debug("UserManager.signinSilent, subject prior to silent renew: ",r.profile.sub),t.current_sub=r.profile.sub),e._signinSilentIframe(t))}))},t.prototype._useRefreshToken=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._tokenClient.exchangeRefreshToken(t).then((function(t){return t?t.access_token?e._loadUser().then((function(r){if(r){var n=Promise.resolve();return t.id_token&&(n=e._validateIdTokenFromTokenRefreshToken(r.profile,t.id_token)),n.then((function(){return i.Log.debug("UserManager._useRefreshToken: refresh token response success"),r.id_token=t.id_token,r.access_token=t.access_token,r.refresh_token=t.refresh_token||r.refresh_token,r.expires_in=t.expires_in,e.storeUser(r).then((function(){return e._events.load(r),r}))}))}return null})):(i.Log.error("UserManager._useRefreshToken: No access token returned from token endpoint"),Promise.reject("No access token returned from token endpoint")):(i.Log.error("UserManager._useRefreshToken: No response returned from token endpoint"),Promise.reject("No response returned from token endpoint"))}))},t.prototype._validateIdTokenFromTokenRefreshToken=function(e,t){var r=this;return this._metadataService.getIssuer().then((function(n){return r._joseUtil.validateJwtAttributes(t,n,r._settings.client_id,r._settings.clockSkew).then((function(t){return t?t.sub!==e.sub?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: sub in id_token does not match current sub"),Promise.reject(new Error("sub in id_token does not match current sub"))):t.auth_time&&t.auth_time!==e.auth_time?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: auth_time in id_token does not match original auth_time"),Promise.reject(new Error("auth_time in id_token does not match original auth_time"))):t.azp&&t.azp!==e.azp?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp in id_token does not match original azp"),Promise.reject(new Error("azp in id_token does not match original azp"))):!t.azp&&e.azp?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp not in id_token, but present in original id_token"),Promise.reject(new Error("azp not in id_token, but present in original id_token"))):void 0:(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: Failed to validate id_token"),Promise.reject(new Error("Failed to validate id_token")))}))}))},t.prototype._signinSilentIframe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return t?(e.redirect_uri=t,e.prompt=e.prompt||"none",this._signin(e,this._iframeNavigator,{startUrl:t,silentRequestTimeout:e.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinSilent: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinSilent: no sub")),e}))):(i.Log.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},t.prototype.signinSilentCallback=function(e){return this._signinCallback(e,this._iframeNavigator).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinSilentCallback: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinSilentCallback: no sub")),e}))},t.prototype.signinCallback=function(e){var t=this;return this.readSigninResponseState(e).then((function(r){var n=r.state;return r.response,"si:r"===n.request_type?t.signinRedirectCallback(e):"si:p"===n.request_type?t.signinPopupCallback(e):"si:s"===n.request_type?t.signinSilentCallback(e):Promise.reject(new Error("invalid response_type in state"))}))},t.prototype.signoutCallback=function(e,t){var r=this;return this.readSignoutResponseState(e).then((function(n){var i=n.state,o=n.response;return i?"so:r"===i.request_type?r.signoutRedirectCallback(e):"so:p"===i.request_type?r.signoutPopupCallback(e,t):Promise.reject(new Error("invalid response_type in state")):o}))},t.prototype.querySessionStatus=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).request_type="si:s";var r=t.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return r?(t.redirect_uri=r,t.prompt="none",t.response_type=t.response_type||this.settings.query_status_response_type,t.scope=t.scope||"openid",t.skipUserInfo=!0,this._signinStart(t,this._iframeNavigator,{startUrl:r,silentRequestTimeout:t.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(t){return e.processSigninResponse(t.url).then((function(e){if(i.Log.debug("UserManager.querySessionStatus: got signin response"),e.session_state&&e.profile.sub)return i.Log.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",e.profile.sub),{session_state:e.session_state,sub:e.profile.sub,sid:e.profile.sid};i.Log.info("querySessionStatus successful, user not authenticated")})).catch((function(t){if(t.session_state&&e.settings.monitorAnonymousSession&&("login_required"==t.message||"consent_required"==t.message||"interaction_required"==t.message||"account_selection_required"==t.message))return i.Log.info("UserManager.querySessionStatus: querySessionStatus success for anonymous user"),{session_state:t.session_state};throw t}))}))):(i.Log.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},t.prototype._signin=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signinStart(e,t,n).then((function(t){return r._signinEnd(t.url,e)}))},t.prototype._signinStart=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.prepare(n).then((function(t){return i.Log.debug("UserManager._signinStart: got navigator window handle"),r.createSigninRequest(e).then((function(e){return i.Log.debug("UserManager._signinStart: got signin request"),n.url=e.url,n.id=e.state.id,t.navigate(n)})).catch((function(e){throw t.close&&(i.Log.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),t.close()),e}))}))},t.prototype._signinEnd=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.processSigninResponse(e).then((function(e){i.Log.debug("UserManager._signinEnd: got signin response");var n=new a.User(e);if(r.current_sub){if(r.current_sub!==n.profile.sub)return i.Log.debug("UserManager._signinEnd: current user does not match user returned from signin. sub from signin: ",n.profile.sub),Promise.reject(new Error("login_required"));i.Log.debug("UserManager._signinEnd: current user matches user returned from signin")}return t.storeUser(n).then((function(){return i.Log.debug("UserManager._signinEnd: user stored"),t._events.load(n),n}))}))},t.prototype._signinCallback=function(e,t){return i.Log.debug("UserManager._signinCallback"),t.callback(e)},t.prototype.signoutRedirect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="so:r";var t=e.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;t&&(e.post_logout_redirect_uri=t);var r={useReplaceToNavigate:e.useReplaceToNavigate};return this._signoutStart(e,this._redirectNavigator,r).then((function(){i.Log.info("UserManager.signoutRedirect: successful")}))},t.prototype.signoutRedirectCallback=function(e){return this._signoutEnd(e||this._redirectNavigator.url).then((function(e){return i.Log.info("UserManager.signoutRedirectCallback: successful"),e}))},t.prototype.signoutPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="so:p";var t=e.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return e.post_logout_redirect_uri=t,e.display="popup",e.post_logout_redirect_uri&&(e.state=e.state||{}),this._signout(e,this._popupNavigator,{startUrl:t,popupWindowFeatures:e.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:e.popupWindowTarget||this.settings.popupWindowTarget}).then((function(){i.Log.info("UserManager.signoutPopup: successful")}))},t.prototype.signoutPopupCallback=function(e,t){return void 0===t&&"boolean"==typeof e&&(t=e,e=null),this._popupNavigator.callback(e,t,"?").then((function(){i.Log.info("UserManager.signoutPopupCallback: successful")}))},t.prototype._signout=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signoutStart(e,t,n).then((function(e){return r._signoutEnd(e.url)}))},t.prototype._signoutStart=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,r=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.prepare(n).then((function(r){return i.Log.debug("UserManager._signoutStart: got navigator window handle"),t._loadUser().then((function(o){return i.Log.debug("UserManager._signoutStart: loaded current user from storage"),(t._settings.revokeAccessTokenOnSignout?t._revokeInternal(o):Promise.resolve()).then((function(){var s=e.id_token_hint||o&&o.id_token;return s&&(i.Log.debug("UserManager._signoutStart: Setting id_token into signout request"),e.id_token_hint=s),t.removeUser().then((function(){return i.Log.debug("UserManager._signoutStart: user removed, creating signout request"),t.createSignoutRequest(e).then((function(e){return i.Log.debug("UserManager._signoutStart: got signout request"),n.url=e.url,e.state&&(n.id=e.state.id),r.navigate(n)}))}))}))})).catch((function(e){throw r.close&&(i.Log.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),r.close()),e}))}))},t.prototype._signoutEnd=function(e){return this.processSignoutResponse(e).then((function(e){return i.Log.debug("UserManager._signoutEnd: got signout response"),e}))},t.prototype.revokeAccessToken=function(){var e=this;return this._loadUser().then((function(t){return e._revokeInternal(t,!0).then((function(r){if(r)return i.Log.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),t.access_token=null,t.refresh_token=null,t.expires_at=null,t.token_type=null,e.storeUser(t).then((function(){i.Log.debug("UserManager.revokeAccessToken: user stored"),e._events.load(t)}))}))})).then((function(){i.Log.info("UserManager.revokeAccessToken: access token revoked successfully")}))},t.prototype._revokeInternal=function(e,t){var r=this;if(e){var n=e.access_token,o=e.refresh_token;return this._revokeAccessTokenInternal(n,t).then((function(e){return r._revokeRefreshTokenInternal(o,t).then((function(t){return e||t||i.Log.debug("UserManager.revokeAccessToken: no need to revoke due to no token(s), or JWT format"),e||t}))}))}return Promise.resolve(!1)},t.prototype._revokeAccessTokenInternal=function(e,t){return!e||e.indexOf(".")>=0?Promise.resolve(!1):this._tokenRevocationClient.revoke(e,t).then((function(){return!0}))},t.prototype._revokeRefreshTokenInternal=function(e,t){return e?this._tokenRevocationClient.revoke(e,t,"refresh_token").then((function(){return!0})):Promise.resolve(!1)},t.prototype.startSilentRenew=function(){this._silentRenewService.start()},t.prototype.stopSilentRenew=function(){this._silentRenewService.stop()},t.prototype._loadUser=function(){return this._userStore.get(this._userStoreKey).then((function(e){return e?(i.Log.debug("UserManager._loadUser: user storageString loaded"),a.User.fromStorageString(e)):(i.Log.debug("UserManager._loadUser: no user storageString"),null)}))},t.prototype.storeUser=function(e){if(e){i.Log.debug("UserManager.storeUser: storing user");var t=e.toStorageString();return this._userStore.set(this._userStoreKey,t)}return i.Log.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)},n(t,[{key:"_redirectNavigator",get:function(){return this.settings.redirectNavigator}},{key:"_popupNavigator",get:function(){return this.settings.popupNavigator}},{key:"_iframeNavigator",get:function(){return this.settings.iframeNavigator}},{key:"_userStore",get:function(){return this.settings.userStore}},{key:"events",get:function(){return this._events}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),t}(o.OidcClient)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UserManagerSettings=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(r(0),r(5)),o=r(42),s=r(43),a=r(45),u=r(6),c=r(1),l=r(12);t.UserManagerSettings=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.popup_redirect_uri,i=r.popup_post_logout_redirect_uri,h=r.popupWindowFeatures,f=r.popupWindowTarget,d=r.silent_redirect_uri,p=r.silentRequestTimeout,g=r.automaticSilentRenew,m=void 0!==g&&g,v=r.validateSubOnSilentRenew,y=void 0!==v&&v,b=r.includeIdTokenInSilentRenew,w=void 0===b||b,F=r.monitorSession,_=void 0===F||F,S=r.monitorAnonymousSession,E=void 0!==S&&S,x=r.checkSessionInterval,D=void 0===x?2e3:x,k=r.stopCheckSessionOnError,A=void 0===k||k,C=r.query_status_response_type,P=r.revokeAccessTokenOnSignout,T=void 0!==P&&P,R=r.accessTokenExpiringNotificationTime,B=void 0===R?60:R,I=r.redirectNavigator,j=void 0===I?new o.RedirectNavigator:I,$=r.popupNavigator,L=void 0===$?new s.PopupNavigator:$,N=r.iframeNavigator,O=void 0===N?new a.IFrameNavigator:N,U=r.userStore,M=void 0===U?new u.WebStorageStateStore({store:c.Global.sessionStorage}):U;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var H=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,arguments[0]));return H._popup_redirect_uri=n,H._popup_post_logout_redirect_uri=i,H._popupWindowFeatures=h,H._popupWindowTarget=f,H._silent_redirect_uri=d,H._silentRequestTimeout=p,H._automaticSilentRenew=m,H._validateSubOnSilentRenew=y,H._includeIdTokenInSilentRenew=w,H._accessTokenExpiringNotificationTime=B,H._monitorSession=_,H._monitorAnonymousSession=E,H._checkSessionInterval=D,H._stopCheckSessionOnError=A,C?H._query_status_response_type=C:arguments[0]&&arguments[0].response_type?H._query_status_response_type=l.SigninRequest.isOidc(arguments[0].response_type)?"id_token":"code":H._query_status_response_type="id_token",H._revokeAccessTokenOnSignout=T,H._redirectNavigator=j,H._popupNavigator=L,H._iframeNavigator=O,H._userStore=M,H}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"popup_redirect_uri",get:function(){return this._popup_redirect_uri}},{key:"popup_post_logout_redirect_uri",get:function(){return this._popup_post_logout_redirect_uri}},{key:"popupWindowFeatures",get:function(){return this._popupWindowFeatures}},{key:"popupWindowTarget",get:function(){return this._popupWindowTarget}},{key:"silent_redirect_uri",get:function(){return this._silent_redirect_uri}},{key:"silentRequestTimeout",get:function(){return this._silentRequestTimeout}},{key:"automaticSilentRenew",get:function(){return this._automaticSilentRenew}},{key:"validateSubOnSilentRenew",get:function(){return this._validateSubOnSilentRenew}},{key:"includeIdTokenInSilentRenew",get:function(){return this._includeIdTokenInSilentRenew}},{key:"accessTokenExpiringNotificationTime",get:function(){return this._accessTokenExpiringNotificationTime}},{key:"monitorSession",get:function(){return this._monitorSession}},{key:"monitorAnonymousSession",get:function(){return this._monitorAnonymousSession}},{key:"checkSessionInterval",get:function(){return this._checkSessionInterval}},{key:"stopCheckSessionOnError",get:function(){return this._stopCheckSessionOnError}},{key:"query_status_response_type",get:function(){return this._query_status_response_type}},{key:"revokeAccessTokenOnSignout",get:function(){return this._revokeAccessTokenOnSignout}},{key:"redirectNavigator",get:function(){return this._redirectNavigator}},{key:"popupNavigator",get:function(){return this._popupNavigator}},{key:"iframeNavigator",get:function(){return this._iframeNavigator}},{key:"userStore",get:function(){return this._userStore}}]),t}(i.OidcClientSettings)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.RedirectNavigator=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.RedirectNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(){return Promise.resolve(this)},e.prototype.navigate=function(e){return e&&e.url?(e.useReplaceToNavigate?window.location.replace(e.url):window.location=e.url,Promise.resolve()):(i.Log.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))},n(e,[{key:"url",get:function(){return window.location.href}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PopupNavigator=void 0;var n=r(0),i=r(44);t.PopupNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new i.PopupWindow(e);return Promise.resolve(t)},e.prototype.callback=function e(t,r,o){n.Log.debug("PopupNavigator.callback");try{return i.PopupWindow.notifyOpener(t,r,o),Promise.resolve()}catch(e){return Promise.reject(e)}},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PopupWindow=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(3);t.PopupWindow=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t}));var n=t.popupWindowTarget||"_blank",o=t.popupWindowFeatures||"location=no,toolbar=no,width=500,height=500,left=100,top=100;";this._popup=window.open("",n,o),this._popup&&(i.Log.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),500))}return e.prototype.navigate=function(e){return this._popup?e&&e.url?(i.Log.debug("PopupWindow.navigate: Setting URL in popup"),this._id=e.id,this._id&&(window["popupCallback_"+e.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=e.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise},e.prototype._success=function(e){i.Log.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(e)},e.prototype._error=function(e){i.Log.error("PopupWindow.error: ",e),this._cleanup(),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup(!1)},e.prototype._cleanup=function(e){i.Log.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!e&&this._popup.close(),this._popup=null},e.prototype._checkForPopupClosed=function(){this._popup&&!this._popup.closed||this._error("Popup window closed")},e.prototype._callback=function(e,t){this._cleanup(t),e?(i.Log.debug("PopupWindow.callback success"),this._success({url:e})):(i.Log.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))},e.notifyOpener=function(e,t,r){if(window.opener){if(e=e||window.location.href){var n=o.UrlUtility.parseUrlFragment(e,r);if(n.state){var s="popupCallback_"+n.state,a=window.opener[s];a?(i.Log.debug("PopupWindow.notifyOpener: passing url message to opener"),a(e,t)):i.Log.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else i.Log.warn("PopupWindow.notifyOpener: no state found in response url")}}else i.Log.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")},n(e,[{key:"promise",get:function(){return this._promise}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IFrameNavigator=void 0;var n=r(0),i=r(46);t.IFrameNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new i.IFrameWindow(e);return Promise.resolve(t)},e.prototype.callback=function e(t){n.Log.debug("IFrameNavigator.callback");try{return i.IFrameWindow.notifyParent(t),Promise.resolve()}catch(e){return Promise.reject(e)}},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IFrameWindow=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.IFrameWindow=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t})),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.style.width=0,this._frame.style.height=0,window.document.body.appendChild(this._frame)}return e.prototype.navigate=function(e){if(e&&e.url){var t=e.silentRequestTimeout||1e4;i.Log.debug("IFrameWindow.navigate: Using timeout of:",t),this._timer=window.setTimeout(this._timeout.bind(this),t),this._frame.src=e.url}else this._error("No url provided");return this.promise},e.prototype._success=function(e){this._cleanup(),i.Log.debug("IFrameWindow: Successful response from frame window"),this._resolve(e)},e.prototype._error=function(e){this._cleanup(),i.Log.error(e),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup()},e.prototype._cleanup=function(){this._frame&&(i.Log.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)},e.prototype._timeout=function(){i.Log.debug("IFrameWindow.timeout"),this._error("Frame window timed out")},e.prototype._message=function(e){if(i.Log.debug("IFrameWindow.message"),this._timer&&e.origin===this._origin&&e.source===this._frame.contentWindow){var t=e.data;t?this._success({url:t}):this._error("Invalid response from frame")}},e.notifyParent=function(e){i.Log.debug("IFrameWindow.notifyParent"),window.frameElement&&(e=e||window.location.href)&&(i.Log.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(e,location.protocol+"//"+location.host))},n(e,[{key:"promise",get:function(){return this._promise}},{key:"_origin",get:function(){return location.protocol+"//"+location.host}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UserManagerEvents=void 0;var n=r(0),i=r(16),o=r(17);t.UserManagerEvents=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r));return n._userLoaded=new o.Event("User loaded"),n._userUnloaded=new o.Event("User unloaded"),n._silentRenewError=new o.Event("Silent renew error"),n._userSignedIn=new o.Event("User signed in"),n._userSignedOut=new o.Event("User signed out"),n._userSessionChanged=new o.Event("User session changed"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.load=function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n.Log.debug("UserManagerEvents.load"),e.prototype.load.call(this,t),r&&this._userLoaded.raise(t)},t.prototype.unload=function(){n.Log.debug("UserManagerEvents.unload"),e.prototype.unload.call(this),this._userUnloaded.raise()},t.prototype.addUserLoaded=function(e){this._userLoaded.addHandler(e)},t.prototype.removeUserLoaded=function(e){this._userLoaded.removeHandler(e)},t.prototype.addUserUnloaded=function(e){this._userUnloaded.addHandler(e)},t.prototype.removeUserUnloaded=function(e){this._userUnloaded.removeHandler(e)},t.prototype.addSilentRenewError=function(e){this._silentRenewError.addHandler(e)},t.prototype.removeSilentRenewError=function(e){this._silentRenewError.removeHandler(e)},t.prototype._raiseSilentRenewError=function(e){n.Log.debug("UserManagerEvents._raiseSilentRenewError",e.message),this._silentRenewError.raise(e)},t.prototype.addUserSignedIn=function(e){this._userSignedIn.addHandler(e)},t.prototype.removeUserSignedIn=function(e){this._userSignedIn.removeHandler(e)},t.prototype._raiseUserSignedIn=function(){n.Log.debug("UserManagerEvents._raiseUserSignedIn"),this._userSignedIn.raise()},t.prototype.addUserSignedOut=function(e){this._userSignedOut.addHandler(e)},t.prototype.removeUserSignedOut=function(e){this._userSignedOut.removeHandler(e)},t.prototype._raiseUserSignedOut=function(){n.Log.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise()},t.prototype.addUserSessionChanged=function(e){this._userSessionChanged.addHandler(e)},t.prototype.removeUserSessionChanged=function(e){this._userSessionChanged.removeHandler(e)},t.prototype._raiseUserSessionChanged=function(){n.Log.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise()},t}(i.AccessTokenEvents)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(1),s=r(17);t.Timer=function(e){function t(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.Global.timer,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r));return s._timer=n,s._nowFunc=i||function(){return Date.now()/1e3},s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.init=function(e){e<=0&&(e=1),e=parseInt(e);var t=this.now+e;if(this.expiration===t&&this._timerHandle)i.Log.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);else{this.cancel(),i.Log.debug("Timer.init timer "+this._name+" for duration:",e),this._expiration=t;var r=5;e<r&&(r=e),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*r)}},t.prototype.cancel=function(){this._timerHandle&&(i.Log.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)},t.prototype._callback=function(){var t=this._expiration-this.now;i.Log.debug("Timer.callback; "+this._name+" timer expires in:",t),this._expiration<=this.now&&(this.cancel(),e.prototype.raise.call(this))},n(t,[{key:"now",get:function(){return parseInt(this._nowFunc())}},{key:"expiration",get:function(){return this._expiration}}]),t}(s.Event)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SilentRenewService=void 0;var n=r(0);t.SilentRenewService=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._userManager=t}return e.prototype.start=function(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then((function(e){})).catch((function(e){n.Log.error("SilentRenewService.start: Error from getUser:",e.message)})))},e.prototype.stop=function(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)},e.prototype._tokenExpiring=function(){var e=this;this._userManager.signinSilent().then((function(e){n.Log.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")}),(function(t){n.Log.error("SilentRenewService._tokenExpiring: Error from signinSilent:",t.message),e._userManager.events._raiseSilentRenewError(t)}))},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaPopupNavigator=void 0;var n=r(21);t.CordovaPopupNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new n.CordovaPopupWindow(e);return Promise.resolve(t)},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaIFrameNavigator=void 0;var n=r(21);t.CordovaIFrameNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){e.popupWindowFeatures="hidden=yes";var t=new n.CordovaPopupWindow(e);return Promise.resolve(t)},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.10.1"}])},e.exports=r()}));const me=[];function ve(e,t){return{subscribe:ye(e,t).subscribe}}function ye(t,r=e){let n;const i=[];function o(e){if(s(t,e)&&(t=e,n)){const e=!me.length;for(let e=0;e<i.length;e+=1){const r=i[e];r[1](),me.push(r,t)}if(e){for(let e=0;e<me.length;e+=2)me[e][0](me[e+1]);me.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(s,a=e){const u=[s,a];return i.push(u),1===i.length&&(n=r(o)||e),s(t),()=>{const e=i.indexOf(u);-1!==e&&i.splice(e,1),0===i.length&&(n(),n=null)}}}}function be(t,r,n){const s=!Array.isArray(t),u=s?[t]:t,c=r.length<2;return ve(n,(t=>{let n=!1;const l=[];let h=0,f=e;const d=()=>{if(h)return;f();const n=r(s?l[0]:l,t);c?t(n):f=o(n)?n:e},p=u.map(((e,t)=>a(e,(e=>{l[t]=e,h&=~(1<<t),n&&d()}),(()=>{h|=1<<t}))));return n=!0,d(),function(){i(p),f()}}))}function we(e){let t;const r=e[7].default,n=l(r,e,e[6],null);return{c(){n&&n.c()},m(e,r){n&&n.m(e,r),t=!0},p(e,[t]){n&&n.p&&64&t&&f(n,r,e,e[6],t,null,null)},i(e){t||(Z(n,e),t=!0)},o(e){Q(n,e),t=!1},d(e){n&&n.d(e)}}}const{UserManager:Fe}=ge,_e=ye(!0),Se=ye(!1),Ee=ye(""),xe=ye(""),De=ye({}),ke=ye(null),Ae=ye(!1),Ce=ye({}),Pe=ye({}),Te=ye({});async function Re(e=!0,t=null){const r=await u(Ce),n=t||u(Pe)||window.location.href,i=e?{pathname:window.location.pathname,search:window.location.search}:{};await r.signinRedirect({redirect_uri:n,appState:i})}async function Be(){}function Ie(t,r,n){let i,o=e;c(t,Se,(e=>n(8,i=e))),t.$$.on_destroy.push((()=>o()));let{$$slots:s={},$$scope:a}=r,{issuer:l}=r,{client_id:h}=r,{redirect_uri:f}=r,{post_logout_redirect_uri:d}=r,{metadata:p=null}=r,{scope:g="openid profile email"}=r;Pe.set(f),Te.set(d);const m=new Fe({authority:l,client_id:h,redirect_uri:f,post_logout_redirect_uri:d,response_type:"code",scope:g,automaticSilentRenew:!0,metadata:p});m.events.addUserLoaded((function(e){Se.set(!0),Ee.set(e.access_token),xe.set(e.id_token),De.set(e.profile),Ae.set(!0)})),m.events.addUserUnloaded((function(){Se.set(!1),xe.set(""),Ee.set(""),De.set({}),Ae.set(!0)})),m.events.addSilentRenewError((function(e){ke.set("SilentRenewError: "+e.message)}));let v=Promise.resolve(m);Ce.set(v);const y=new URLSearchParams(window.location.search);var b;return y.has("error")||y.has("code")||i||async function(){Ae.set(!1);try{const e=await u(Ce);await e.signinSilent(),Ae.set(!0)}catch(e){return ke.set(e.message),Ae.set(!0),!1}}(),T((async function(){const e=await v;if(y.has("error")&&ke.set(new Error(y.get("error_description"))),y.has("code")){const t=await e.signinCallback();let r=t&&t.state||{};const n=r&&r.targetUrl?r.targetUrl:window.location.pathname;r={...r,isRedirectCallback:!0},history.replaceState(r,"",n),ke.set(null)}else if(y.has("state")){await e.signinCallback()}_e.set(!1)})),b=Be,P().$$.on_destroy.push(b),t.$$set=e=>{"issuer"in e&&n(0,l=e.issuer),"client_id"in e&&n(1,h=e.client_id),"redirect_uri"in e&&n(2,f=e.redirect_uri),"post_logout_redirect_uri"in e&&n(3,d=e.post_logout_redirect_uri),"metadata"in e&&n(4,p=e.metadata),"scope"in e&&n(5,g=e.scope),"$$scope"in e&&n(6,a=e.$$scope)},[l,h,f,d,p,g,a,s]}class je extends ue{constructor(e){super(),ae(this,e,Ie,we,s,{issuer:0,client_id:1,redirect_uri:2,post_logout_redirect_uri:3,metadata:4,scope:5})}}function $e(t){let r,n,i,o,s;return{c(){r=y("a"),n=w(t[0]),E(r,"href",t[1]),E(r,"class",i="inline-block  "+(t[3]?"px-2 py-1 text-xs":"px-4 py-2 text-sm")+" leading-none border rounded border-black\n   active:bg-gray-300 border-gray-500 lg:mt-0"),k(r,"bg-green-200",t[2])},m(e,i){g(e,r,i),p(r,n),o||(s=S(r,"click",t[4]),o=!0)},p(e,[t]){1&t&&x(n,e[0]),2&t&&E(r,"href",e[1]),8&t&&i!==(i="inline-block  "+(e[3]?"px-2 py-1 text-xs":"px-4 py-2 text-sm")+" leading-none border rounded border-black\n   active:bg-gray-300 border-gray-500 lg:mt-0")&&E(r,"class",i),12&t&&k(r,"bg-green-200",e[2])},i:e,o:e,d(e){e&&m(r),o=!1,s()}}}function Le(e,t,r){let{name:n="Button"}=t,{href:i="/"}=t,{defaultAction:o=!1}=t,{small:s=!1}=t;return e.$$set=e=>{"name"in e&&r(0,n=e.name),"href"in e&&r(1,i=e.href),"defaultAction"in e&&r(2,o=e.defaultAction),"small"in e&&r(3,s=e.small)},[n,i,o,s,function(t){B(e,t)}]}class Ne extends ue{constructor(e){super(),ae(this,e,Le,$e,s,{name:0,href:1,defaultAction:2,small:3})}}function Oe(t){let r,n;return r=new Ne({props:{name:"Login",href:"/"}}),r.$on("click",t[4]),{c(){ie(r.$$.fragment)},m(e,t){oe(r,e,t),n=!0},p:e,i(e){n||(Z(r.$$.fragment,e),n=!0)},o(e){Q(r.$$.fragment,e),n=!1},d(e){se(r,e)}}}function Ue(e){let t,r,n,i,o,s,a,u,c,l=e[2].preferred_username+"";return u=new Ne({props:{name:"Logout",href:"/"}}),u.$on("click",e[5]),{c(){t=y("a"),r=b("svg"),n=b("path"),i=F(),o=y("span"),s=w(l),a=F(),ie(u.$$.fragment),E(n,"stroke-linecap","round"),E(n,"stroke-linejoin","round"),E(n,"stroke-width","2"),E(n,"d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"),E(r,"class","w-6"),E(r,"xmlns","http://www.w3.org/2000/svg"),E(r,"fill","none"),E(r,"viewBox","0 0 24 24"),E(r,"stroke","black"),E(t,"href","#/account"),E(t,"class","mr-5 flex items-center text-sm")},m(e,l){g(e,t,l),p(t,r),p(r,n),p(t,i),p(t,o),p(o,s),g(e,a,l),oe(u,e,l),c=!0},p(e,t){(!c||4&t)&&l!==(l=e[2].preferred_username+"")&&x(s,l)},i(e){c||(Z(u.$$.fragment,e),c=!0)},o(e){Q(u.$$.fragment,e),c=!1},d(e){e&&m(t),e&&m(a),se(u,e)}}}function Me(e){let t,r,n,o,s,a,u,c,l,h,f,d,v,b,w=!e[1]&&Oe(e),_=e[1]&&Ue(e);return{c(){t=y("nav"),r=y("div"),r.innerHTML='<a href="#/"><img class="w-32" src="/img/logo_1.svg" alt="logo"/></a>',n=F(),o=y("div"),s=y("button"),s.innerHTML='<img src="/img/dots-horizontal.svg" class="w-3" alt=""/>',a=F(),u=y("div"),c=y("div"),c.innerHTML='<a href="#/tasks" class="block mt-4 lg:inline-block lg:mt-0 hover:text-gray-600 mr-4">Tasks</a> \n            <a href="#/projects" class="block mt-4 lg:inline-block lg:mt-0 hover:text-gray-600 mr-4">Projects</a> \n            <a href="#responsive-header" class="block mt-4 lg:inline-block lg:mt-0 hover:text-gray-600">Blog</a>',l=F(),h=y("div"),w&&w.c(),f=F(),_&&_.c(),E(r,"class","flex items-center flex-shrink-0 text-white mr-6"),E(s,"class","flex items-center px-3 py-2 border border-gray-500 rounded hover:text-gray-600 hover:border-gray-600 focus:outline-none"),E(o,"class","block lg:hidden"),E(c,"class","text-sm lg:flex-grow"),E(h,"class","flex items-center mt-4 lg:mt-0"),E(u,"id","collapsible"),E(u,"class","w-full block flex-grow lg:flex lg:items-center lg:w-auto"),k(u,"hidden",e[0]),E(t,"class","flex items-center justify-between flex-wrap p-6  border-b-2 lg:border-0")},m(i,m){g(i,t,m),p(t,r),p(t,n),p(t,o),p(o,s),p(t,a),p(t,u),p(u,c),p(u,l),p(u,h),w&&w.m(h,null),p(h,f),_&&_.m(h,null),d=!0,v||(b=[S(s,"click",e[3]),S(u,"click",e[6])],v=!0)},p(e,[t]){e[1]?w&&(G(),Q(w,1,1,(()=>{w=null})),X()):w?(w.p(e,t),2&t&&Z(w,1)):(w=Oe(e),w.c(),Z(w,1),w.m(h,f)),e[1]?_?(_.p(e,t),2&t&&Z(_,1)):(_=Ue(e),_.c(),Z(_,1),_.m(h,null)):_&&(G(),Q(_,1,1,(()=>{_=null})),X()),1&t&&k(u,"hidden",e[0])},i(e){d||(Z(w),Z(_),d=!0)},o(e){Q(w),Q(_),d=!1},d(e){e&&m(t),w&&w.d(),_&&_.d(),v=!1,i(b)}}}function He(e,t,r){let n,i;c(e,Se,(e=>r(1,n=e))),c(e,De,(e=>r(2,i=e)));let o=!0;return[o,n,i,()=>r(0,o=!o),()=>Re(),()=>async function(e=null){const t=await u(Ce),r=e||u(Te)||window.location.href;await t.signoutRedirect({returnTo:r})}(),()=>r(0,o=!0)]}class qe extends ue{constructor(e){super(),ae(this,e,He,Me,s,{})}}var Ve=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}},Ke=Object.prototype.toString;function ze(e){return"[object Array]"===Ke.call(e)}function Je(e){return void 0===e}function We(e){return null!==e&&"object"==typeof e}function Ye(e){if("[object Object]"!==Ke.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function Ge(e){return"[object Function]"===Ke.call(e)}function Xe(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),ze(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}var Ze={isArray:ze,isArrayBuffer:function(e){return"[object ArrayBuffer]"===Ke.call(e)},isBuffer:function(e){return null!==e&&!Je(e)&&null!==e.constructor&&!Je(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:We,isPlainObject:Ye,isUndefined:Je,isDate:function(e){return"[object Date]"===Ke.call(e)},isFile:function(e){return"[object File]"===Ke.call(e)},isBlob:function(e){return"[object Blob]"===Ke.call(e)},isFunction:Ge,isStream:function(e){return We(e)&&Ge(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:Xe,merge:function e(){var t={};function r(r,n){Ye(t[n])&&Ye(r)?t[n]=e(t[n],r):Ye(r)?t[n]=e({},r):ze(r)?t[n]=r.slice():t[n]=r}for(var n=0,i=arguments.length;n<i;n++)Xe(arguments[n],r);return t},extend:function(e,t,r){return Xe(t,(function(t,n){e[n]=r&&"function"==typeof t?Ve(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}};function Qe(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var et=function(e,t,r){if(!t)return e;var n;if(r)n=r(t);else if(Ze.isURLSearchParams(t))n=t.toString();else{var i=[];Ze.forEach(t,(function(e,t){null!=e&&(Ze.isArray(e)?t+="[]":e=[e],Ze.forEach(e,(function(e){Ze.isDate(e)?e=e.toISOString():Ze.isObject(e)&&(e=JSON.stringify(e)),i.push(Qe(t)+"="+Qe(e))})))})),n=i.join("&")}if(n){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e};function tt(){this.handlers=[]}tt.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},tt.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},tt.prototype.forEach=function(e){Ze.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var rt=tt,nt=function(e,t,r){return Ze.forEach(r,(function(r){e=r(e,t)})),e},it=function(e){return!(!e||!e.__CANCEL__)},ot=function(e,t){Ze.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))},st=function(e,t,r,n,i){return function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}(new Error(e),t,r,n,i)},at=Ze.isStandardBrowserEnv()?{write:function(e,t,r,n,i,o){var s=[];s.push(e+"="+encodeURIComponent(t)),Ze.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),Ze.isString(n)&&s.push("path="+n),Ze.isString(i)&&s.push("domain="+i),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},ut=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],ct=Ze.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=n(window.location.href),function(t){var r=Ze.isString(t)?n(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0},lt=function(e){return new Promise((function(t,r){var n=e.data,i=e.headers;Ze.isFormData(n)&&delete i["Content-Type"];var o=new XMLHttpRequest;if(e.auth){var s=e.auth.username||"",a=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.Authorization="Basic "+btoa(s+":"+a)}var u,c,l=(u=e.baseURL,c=e.url,u&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(c)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(u,c):c);if(o.open(e.method.toUpperCase(),et(l,e.params,e.paramsSerializer),!0),o.timeout=e.timeout,o.onreadystatechange=function(){if(o&&4===o.readyState&&(0!==o.status||o.responseURL&&0===o.responseURL.indexOf("file:"))){var n,i,s,a,u,c="getAllResponseHeaders"in o?(n=o.getAllResponseHeaders(),u={},n?(Ze.forEach(n.split("\n"),(function(e){if(a=e.indexOf(":"),i=Ze.trim(e.substr(0,a)).toLowerCase(),s=Ze.trim(e.substr(a+1)),i){if(u[i]&&ut.indexOf(i)>=0)return;u[i]="set-cookie"===i?(u[i]?u[i]:[]).concat([s]):u[i]?u[i]+", "+s:s}})),u):u):null,l={data:e.responseType&&"text"!==e.responseType?o.response:o.responseText,status:o.status,statusText:o.statusText,headers:c,config:e,request:o};!function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(st("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}(t,r,l),o=null}},o.onabort=function(){o&&(r(st("Request aborted",e,"ECONNABORTED",o)),o=null)},o.onerror=function(){r(st("Network Error",e,null,o)),o=null},o.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(st(t,e,"ECONNABORTED",o)),o=null},Ze.isStandardBrowserEnv()){var h=(e.withCredentials||ct(l))&&e.xsrfCookieName?at.read(e.xsrfCookieName):void 0;h&&(i[e.xsrfHeaderName]=h)}if("setRequestHeader"in o&&Ze.forEach(i,(function(e,t){void 0===n&&"content-type"===t.toLowerCase()?delete i[t]:o.setRequestHeader(t,e)})),Ze.isUndefined(e.withCredentials)||(o.withCredentials=!!e.withCredentials),e.responseType)try{o.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&o.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&o.upload&&o.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){o&&(o.abort(),r(e),o=null)})),n||(n=null),o.send(n)}))},ht={"Content-Type":"application/x-www-form-urlencoded"};function ft(e,t){!Ze.isUndefined(e)&&Ze.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var dt,pt={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(dt=lt),dt),transformRequest:[function(e,t){return ot(t,"Accept"),ot(t,"Content-Type"),Ze.isFormData(e)||Ze.isArrayBuffer(e)||Ze.isBuffer(e)||Ze.isStream(e)||Ze.isFile(e)||Ze.isBlob(e)?e:Ze.isArrayBufferView(e)?e.buffer:Ze.isURLSearchParams(e)?(ft(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):Ze.isObject(e)?(ft(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};pt.headers={common:{Accept:"application/json, text/plain, */*"}},Ze.forEach(["delete","get","head"],(function(e){pt.headers[e]={}})),Ze.forEach(["post","put","patch"],(function(e){pt.headers[e]=Ze.merge(ht)}));var gt=pt;function mt(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var vt=function(e){return mt(e),e.headers=e.headers||{},e.data=nt(e.data,e.headers,e.transformRequest),e.headers=Ze.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Ze.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||gt.adapter)(e).then((function(t){return mt(e),t.data=nt(t.data,t.headers,e.transformResponse),t}),(function(t){return it(t)||(mt(e),t&&t.response&&(t.response.data=nt(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},yt=function(e,t){t=t||{};var r={},n=["url","method","data"],i=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],s=["validateStatus"];function a(e,t){return Ze.isPlainObject(e)&&Ze.isPlainObject(t)?Ze.merge(e,t):Ze.isPlainObject(t)?Ze.merge({},t):Ze.isArray(t)?t.slice():t}function u(n){Ze.isUndefined(t[n])?Ze.isUndefined(e[n])||(r[n]=a(void 0,e[n])):r[n]=a(e[n],t[n])}Ze.forEach(n,(function(e){Ze.isUndefined(t[e])||(r[e]=a(void 0,t[e]))})),Ze.forEach(i,u),Ze.forEach(o,(function(n){Ze.isUndefined(t[n])?Ze.isUndefined(e[n])||(r[n]=a(void 0,e[n])):r[n]=a(void 0,t[n])})),Ze.forEach(s,(function(n){n in t?r[n]=a(e[n],t[n]):n in e&&(r[n]=a(void 0,e[n]))}));var c=n.concat(i).concat(o).concat(s),l=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===c.indexOf(e)}));return Ze.forEach(l,u),r};function bt(e){this.defaults=e,this.interceptors={request:new rt,response:new rt}}bt.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=yt(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[vt,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},bt.prototype.getUri=function(e){return e=yt(this.defaults,e),et(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},Ze.forEach(["delete","get","head","options"],(function(e){bt.prototype[e]=function(t,r){return this.request(yt(r||{},{method:e,url:t,data:(r||{}).data}))}})),Ze.forEach(["post","put","patch"],(function(e){bt.prototype[e]=function(t,r,n){return this.request(yt(n||{},{method:e,url:t,data:r}))}}));var wt=bt;function Ft(e){this.message=e}Ft.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},Ft.prototype.__CANCEL__=!0;var _t=Ft;function St(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new _t(e),t(r.reason))}))}St.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},St.source=function(){var e;return{token:new St((function(t){e=t})),cancel:e}};var Et=St;function xt(e){var t=new wt(e),r=Ve(wt.prototype.request,t);return Ze.extend(r,wt.prototype,t),Ze.extend(r,t),r}var Dt=xt(gt);Dt.Axios=wt,Dt.create=function(e){return xt(yt(Dt.defaults,e))},Dt.Cancel=_t,Dt.CancelToken=Et,Dt.isCancel=it,Dt.all=function(e){return Promise.all(e)},Dt.spread=function(e){return function(t){return e.apply(null,t)}};var kt=Dt,At=Dt;kt.default=At;var Ct=kt;class Pt{baseUrl="http://192.168.0.108:8080/api/v1";defineHeaders(){Ct.defaults.headers.common.Authorization="Bearer "+u(Ee)}async getProject(e){return this.defineHeaders(),Ct.get(`${this.baseUrl}/projects/${e}`).then((e=>e.data)).catch((e=>{console.log(e)}))}async getProjects(){return this.defineHeaders(),Ct.get(this.baseUrl+"/projects").then((e=>e.data)).catch((e=>{console.log(e)}))}async saveProject(e){return this.defineHeaders(),Ct.post(this.baseUrl+"/projects",e).then((e=>e.data)).catch((e=>console.log(e)))}async getProjectIssues(e){return this.defineHeaders(),Ct.get(`${this.baseUrl}/projects/${e}/issues`).then((e=>e.data)).catch((e=>console.log(e)))}async getProjectIssue(e,t){return this.defineHeaders(),Ct.get(`${this.baseUrl}/projects/${e}/issues/${t}`).then((e=>e.data)).catch((e=>{console.log(e)}))}async saveProjectIssue(e,t){return this.defineHeaders(),Ct.post(`${this.baseUrl}/projects/${e}/issues`,t).then((e=>e.data)).catch((e=>console.log(e)))}async deleteProjectIssue(e,t){return this.defineHeaders(),Ct.delete(`${this.baseUrl}/projects/${e}/issues/${t}`).then((e=>{})).catch((e=>console.log(e)))}}function Tt(t){let r,n,i,o,s,a,u,c,l,h,f,d;return{c(){r=y("div"),n=y("div"),i=y("img"),s=F(),a=y("a"),u=y("div"),c=w(t[1]),h=F(),f=y("div"),d=w(t[2]),E(i,"class","w-5 mr-2"),i.src!==(o="/img/project.svg")&&E(i,"src","/img/project.svg"),E(u,"class","text-lg"),E(a,"href",l="#/projects/"+t[0]),E(n,"class","flex"),E(f,"class","text-sm"),E(r,"class","flex flex-col p-2 border rounded-sm w-full md:w-1/2 mb-2 mx-2 bg-gray-100")},m(e,t){g(e,r,t),p(r,n),p(n,i),p(n,s),p(n,a),p(a,u),p(u,c),p(r,h),p(r,f),p(f,d)},p(e,[t]){2&t&&x(c,e[1]),1&t&&l!==(l="#/projects/"+e[0])&&E(a,"href",l),4&t&&x(d,e[2])},i:e,o:e,d(e){e&&m(r)}}}function Rt(e,t,r){let{id:n}=t,{title:i}=t,{desc:o}=t;return e.$$set=e=>{"id"in e&&r(0,n=e.id),"title"in e&&r(1,i=e.title),"desc"in e&&r(2,o=e.desc)},[n,i,o]}class Bt extends ue{constructor(e){super(),ae(this,e,Rt,Tt,s,{id:0,title:1,desc:2})}}function It(e,t,r){const n=e.slice();return n[1]=t[r],n}function jt(e){let t,r;return t=new Bt({props:{id:e[1].project.id,title:e[1].project.title,desc:e[1].project.description}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,r){const n={};1&r&&(n.id=e[1].project.id),1&r&&(n.title=e[1].project.title),1&r&&(n.desc=e[1].project.description),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function $t(e){let t,r,n,i,o,s,a;i=new Ne({props:{name:"New Project",href:"#/project-edit"}});let u=e[0],c=[];for(let t=0;t<u.length;t+=1)c[t]=jt(It(e,u,t));const l=e=>Q(c[e],1,1,(()=>{c[e]=null}));return{c(){t=y("h1"),t.textContent="Your projects",r=F(),n=y("div"),ie(i.$$.fragment),o=F();for(let e=0;e<c.length;e+=1)c[e].c();s=_(),E(t,"class","text-2xl mb-2"),E(n,"class","w-full flex justify-end py-2")},m(e,u){g(e,t,u),g(e,r,u),g(e,n,u),oe(i,n,null),g(e,o,u);for(let t=0;t<c.length;t+=1)c[t].m(e,u);g(e,s,u),a=!0},p(e,[t]){if(1&t){let r;for(u=e[0],r=0;r<u.length;r+=1){const n=It(e,u,r);c[r]?(c[r].p(n,t),Z(c[r],1)):(c[r]=jt(n),c[r].c(),Z(c[r],1),c[r].m(s.parentNode,s))}for(G(),r=u.length;r<c.length;r+=1)l(r);X()}},i(e){if(!a){Z(i.$$.fragment,e);for(let e=0;e<u.length;e+=1)Z(c[e]);a=!0}},o(e){Q(i.$$.fragment,e),c=c.filter(Boolean);for(let e=0;e<c.length;e+=1)Q(c[e]);a=!1},d(e){e&&m(t),e&&m(r),e&&m(n),se(i),e&&m(o),v(c,e),e&&m(s)}}}function Lt(e,t,r){let n=[];return T((async()=>{const e=new Pt;r(0,n=await e.getProjects()||[])})),[n]}class Nt extends ue{constructor(e){super(),ae(this,e,Lt,$t,s,{})}}function Ot(e){if(!e)throw Error("Parameter args is required");if(!e.component==!e.asyncComponent)throw Error("One and only one of component and asyncComponent is required");if(e.component&&(e.asyncComponent=()=>Promise.resolve(e.component)),"function"!=typeof e.asyncComponent)throw Error("Parameter asyncComponent must be a function");if(e.conditions){Array.isArray(e.conditions)||(e.conditions=[e.conditions]);for(let t=0;t<e.conditions.length;t++)if(!e.conditions[t]||"function"!=typeof e.conditions[t])throw Error("Invalid parameter conditions["+t+"]")}e.loadingComponent&&(e.asyncComponent.loading=e.loadingComponent,e.asyncComponent.loadingParams=e.loadingParams||void 0);return{component:e.asyncComponent,userData:e.userData,conditions:e.conditions&&e.conditions.length?e.conditions:void 0,props:e.props&&Object.keys(e.props).length?e.props:{},_sveltesparouter:!0}}function Ut(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var r,n,i,o,s=[],a="",u=e.split("/");for(u[0]||u.shift();i=u.shift();)"*"===(r=i[0])?(s.push("wild"),a+="/(.*)"):":"===r?(n=i.indexOf("?",1),o=i.indexOf(".",1),s.push(i.substring(1,~n?n:~o?o:i.length)),a+=~n&&!~o?"(?:/([^/]+?))?":"/([^/]+?)",~o&&(a+=(~n?"?":"")+"\\"+i.substring(o))):a+="/"+i;return{keys:s,pattern:new RegExp("^"+a+(t?"(?=$|/)":"/?$"),"i")}}function Mt(e){let r,n,i;const o=[e[2]];var s=e[0];function a(e){let r={};for(let e=0;e<o.length;e+=1)r=t(r,o[e]);return{props:r}}return s&&(r=new s(a()),r.$on("routeEvent",e[7])),{c(){r&&ie(r.$$.fragment),n=_()},m(e,t){r&&oe(r,e,t),g(e,n,t),i=!0},p(e,t){const i=4&t?te(o,[re(e[2])]):{};if(s!==(s=e[0])){if(r){G();const e=r;Q(e.$$.fragment,1,0,(()=>{se(e,1)})),X()}s?(r=new s(a()),r.$on("routeEvent",e[7]),ie(r.$$.fragment),Z(r.$$.fragment,1),oe(r,n.parentNode,n)):r=null}else s&&r.$set(i)},i(e){i||(r&&Z(r.$$.fragment,e),i=!0)},o(e){r&&Q(r.$$.fragment,e),i=!1},d(e){e&&m(n),r&&se(r,e)}}}function Ht(e){let r,n,i;const o=[{params:e[1]},e[2]];var s=e[0];function a(e){let r={};for(let e=0;e<o.length;e+=1)r=t(r,o[e]);return{props:r}}return s&&(r=new s(a()),r.$on("routeEvent",e[6])),{c(){r&&ie(r.$$.fragment),n=_()},m(e,t){r&&oe(r,e,t),g(e,n,t),i=!0},p(e,t){const i=6&t?te(o,[2&t&&{params:e[1]},4&t&&re(e[2])]):{};if(s!==(s=e[0])){if(r){G();const e=r;Q(e.$$.fragment,1,0,(()=>{se(e,1)})),X()}s?(r=new s(a()),r.$on("routeEvent",e[6]),ie(r.$$.fragment),Z(r.$$.fragment,1),oe(r,n.parentNode,n)):r=null}else s&&r.$set(i)},i(e){i||(r&&Z(r.$$.fragment,e),i=!0)},o(e){r&&Q(r.$$.fragment,e),i=!1},d(e){e&&m(n),r&&se(r,e)}}}function qt(e){let t,r,n,i;const o=[Ht,Mt],s=[];function a(e,t){return e[1]?0:1}return t=a(e),r=s[t]=o[t](e),{c(){r.c(),n=_()},m(e,r){s[t].m(e,r),g(e,n,r),i=!0},p(e,[i]){let u=t;t=a(e),t===u?s[t].p(e,i):(G(),Q(s[u],1,1,(()=>{s[u]=null})),X(),r=s[t],r?r.p(e,i):(r=s[t]=o[t](e),r.c()),Z(r,1),r.m(n.parentNode,n))},i(e){i||(Z(r),i=!0)},o(e){Q(r),i=!1},d(e){s[t].d(e),e&&m(n)}}}function Vt(){const e=window.location.href.indexOf("#/");let t=e>-1?window.location.href.substr(e+1):"/";const r=t.indexOf("?");let n="";return r>-1&&(n=t.substr(r+1),t=t.substr(0,r)),{location:t,querystring:n}}const Kt=ve(null,(function(e){e(Vt());const t=()=>{e(Vt())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}}));be(Kt,(e=>e.location)),be(Kt,(e=>e.querystring));async function zt(e){if(!e||e.length<1||"/"!=e.charAt(0)&&0!==e.indexOf("#/"))throw Error("Invalid parameter location");await M(),history.replaceState({scrollX:window.scrollX,scrollY:window.scrollY},void 0,void 0),window.location.hash=("#"==e.charAt(0)?"":"#")+e}async function Jt(){await M(),window.history.back()}function Wt(e,t){if(!e||!e.tagName||"a"!=e.tagName.toLowerCase())throw Error('Action "link" can only be used with <a> tags');return Yt(e,t||e.getAttribute("href")),{update(t){Yt(e,t)}}}function Yt(e,t){if(!t||t.length<1||"/"!=t.charAt(0))throw Error('Invalid value for "href" attribute: '+t);e.setAttribute("href","#"+t),e.addEventListener("click",Gt)}function Gt(e){e.preventDefault();const t=e.currentTarget.getAttribute("href");history.replaceState({scrollX:window.scrollX,scrollY:window.scrollY},void 0,void 0),window.location.hash=t}function Xt(e,t,r){let{routes:n={}}=t,{prefix:i=""}=t,{restoreScrollState:o=!1}=t;class s{constructor(e,t){if(!t||"function"!=typeof t&&("object"!=typeof t||!0!==t._sveltesparouter))throw Error("Invalid component object");if(!e||"string"==typeof e&&(e.length<1||"/"!=e.charAt(0)&&"*"!=e.charAt(0))||"object"==typeof e&&!(e instanceof RegExp))throw Error('Invalid value for "path" argument');const{pattern:r,keys:n}=Ut(e);this.path=e,"object"==typeof t&&!0===t._sveltesparouter?(this.component=t.component,this.conditions=t.conditions||[],this.userData=t.userData,this.props=t.props||{}):(this.component=()=>Promise.resolve(t),this.conditions=[],this.props={}),this._pattern=r,this._keys=n}match(e){if(i)if("string"==typeof i&&e.startsWith(i))e=e.substr(i.length)||"/";else if(i instanceof RegExp){const t=e.match(i);t&&t[0]&&(e=e.substr(t[0].length)||"/")}const t=this._pattern.exec(e);if(null===t)return null;if(!1===this._keys)return t;const r={};let n=0;for(;n<this._keys.length;){try{r[this._keys[n]]=decodeURIComponent(t[n+1]||"")||null}catch(e){r[this._keys[n]]=null}n++}return r}async checkConditions(e){for(let t=0;t<this.conditions.length;t++)if(!await this.conditions[t](e))return!1;return!0}}const a=[];n instanceof Map?n.forEach(((e,t)=>{a.push(new s(t,e))})):Object.keys(n).forEach((e=>{a.push(new s(e,n[e]))}));let u=null,c=null,l={};const h=R();async function f(e,t){await M(),h(e,t)}let d=null;var p;o&&(window.addEventListener("popstate",(e=>{d=e.state&&e.state.scrollY?e.state:null})),p=()=>{d?window.scrollTo(d.scrollX,d.scrollY):window.scrollTo(0,0)},P().$$.after_update.push(p));let g=null,m=null;return Kt.subscribe((async e=>{g=e;let t=0;for(;t<a.length;){const n=a[t].match(e.location);if(!n){t++;continue}const i={route:a[t].path,location:e.location,querystring:e.querystring,userData:a[t].userData};if(!await a[t].checkConditions(i))return r(0,u=null),m=null,void f("conditionsFailed",i);f("routeLoading",Object.assign({},i));const o=a[t].component;if(m!=o){o.loading?(r(0,u=o.loading),m=o,r(1,c=o.loadingParams),r(2,l={}),f("routeLoaded",Object.assign({},i,{component:u,name:u.name}))):(r(0,u=null),m=null);const t=await o();if(e!=g)return;r(0,u=t&&t.default||t),m=o}return n&&"object"==typeof n&&Object.keys(n).length?r(1,c=n):r(1,c=null),r(2,l=a[t].props),void f("routeLoaded",Object.assign({},i,{component:u,name:u.name}))}r(0,u=null),m=null})),e.$$set=e=>{"routes"in e&&r(3,n=e.routes),"prefix"in e&&r(4,i=e.prefix),"restoreScrollState"in e&&r(5,o=e.restoreScrollState)},e.$$.update=()=>{32&e.$$.dirty&&(history.scrollRestoration=o?"manual":"auto")},[u,c,l,n,i,o,function(t){B(e,t)},function(t){B(e,t)}]}class Zt extends ue{constructor(e){super(),ae(this,e,Xt,qt,s,{routes:3,prefix:4,restoreScrollState:5})}}function Qt(e){let t,r;return{c(){t=y("div"),r=w(e[0]),E(t,"class","bg-red-500 mt-8")},m(e,n){g(e,t,n),p(t,r)},p(e,t){1&t&&x(r,e[0])},d(e){e&&m(t)}}}function er(e){let t,r,n,i,o,s,a;o=new Ne({props:{name:"Login",href:"#"}}),o.$on("click",e[1]);let u=e[0]&&Qt(e);return{c(){t=y("div"),r=y("div"),r.innerHTML='<img src="/img/logo_1_inv.svg" alt=""/> \n        <div class="text-white mt-8 flex justify-end">Simple general purpose issue tracker</div>',n=F(),i=y("div"),ie(o.$$.fragment),s=F(),u&&u.c(),E(r,"class","mt-8 p-6 lg:w-1/2 sm:w-3/4 bg-green-500 flex flex-col"),E(i,"class","mt-16"),E(t,"class","container mx-auto flex flex-col items-center pt-16")},m(e,c){g(e,t,c),p(t,r),p(t,n),p(t,i),oe(o,i,null),p(t,s),u&&u.m(t,null),a=!0},p(e,[r]){e[0]?u?u.p(e,r):(u=Qt(e),u.c(),u.m(t,null)):u&&(u.d(1),u=null)},i(e){a||(Z(o.$$.fragment,e),a=!0)},o(e){Q(o.$$.fragment,e),a=!1},d(e){e&&m(t),se(o),u&&u.d()}}}function tr(e,t,r){let n;return[n,function(){r(0,n=void 0),Re().catch((e=>r(0,n=e.message)))}]}class rr extends ue{constructor(e){super(),ae(this,e,tr,er,s,{})}}function nr(e){let t,r,n;t=new qe({});const i=e[1].default,o=l(i,e,e[0],null);return{c(){ie(t.$$.fragment),r=F(),o&&o.c()},m(e,i){oe(t,e,i),g(e,r,i),o&&o.m(e,i),n=!0},p(e,[t]){o&&o.p&&1&t&&f(o,i,e,e[0],t,null,null)},i(e){n||(Z(t.$$.fragment,e),Z(o,e),n=!0)},o(e){Q(t.$$.fragment,e),Q(o,e),n=!1},d(e){se(t,e),e&&m(r),o&&o.d(e)}}}function ir(e,t,r){let{$$slots:n={},$$scope:i}=t;return e.$$set=e=>{"$$scope"in e&&r(0,i=e.$$scope)},[i,n]}class or extends ue{constructor(e){super(),ae(this,e,ir,nr,s,{})}}function sr(t){let r,n,i;return{c(){r=y("h1"),r.textContent="tasks",n=F(),i=y("div"),i.textContent="projects: "+t[0]},m(e,t){g(e,r,t),g(e,n,t),g(e,i,t)},p:e,d(e){e&&m(r),e&&m(n),e&&m(i)}}}function ar(e){let t,r;return t=new or({props:{$$slots:{default:[sr]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,[r]){const n={};4&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function ur(e){return T((()=>{})),[undefined]}function cr(e){let t,r;return t=new Nt({}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function lr(e){let t,r;return t=new fe({props:{extraClasses:"px-2",$$slots:{default:[cr]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,r){const n={};1&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function hr(e){let t,r;return t=new or({props:{$$slots:{default:[lr]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,[r]){const n={};1&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function fr(t){let r;return{c(){r=y("div"),r.innerHTML="This is <strong>Bar</strong> component"},m(e,t){g(e,r,t)},p:e,i:e,o:e,d(e){e&&m(r)}}}function dr(e){let t,r,n;return{c(){t=y("div"),t.textContent="Home component",r=F(),n=y("div"),n.innerHTML='Check out your <a class="underline" href="#/projects">Projects</a>',E(t,"class","mt-10"),E(n,"class","mt-10")},m(e,i){g(e,t,i),g(e,r,i),g(e,n,i)},d(e){e&&m(t),e&&m(r),e&&m(n)}}}function pr(e){let t,r;return t=new fe({props:{$$slots:{default:[dr]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,r){const n={};1&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function gr(e){let t,r;return t=new or({props:{$$slots:{default:[pr]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,[r]){const n={};1&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function mr(e){return T((()=>{console.log("Home onMount")})),[]}function vr(e){let t;return{c(){t=w("Workspace")},m(e,r){g(e,t,r)},d(e){e&&m(t)}}}function yr(e){let t,r;return t=new or({props:{$$slots:{default:[vr]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,[r]){const n={};1&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}var br=pe((function(e,t){
/*!
     * validate.js 0.13.1
     *
     * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
     * Validate.js may be freely distributed under the MIT license.
     * For all details and documentation:
     * http://validatejs.org/
     */
(function(e,t,r){var n=function(e,t,r){r=i.extend({},i.options,r);var o=i.runValidations(e,t,r);if(o.some((function(e){return i.isPromise(e.error)})))throw new Error("Use validate.async if you want support for promises");return n.processValidationResults(o,r)},i=n;i.extend=function(e){return[].slice.call(arguments,1).forEach((function(t){for(var r in t)e[r]=t[r]})),e},i.extend(n,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var e=i.format("%{major}.%{minor}.%{patch}",i.version);return i.isEmpty(i.version.metadata)||(e+="+"+i.version.metadata),e}},Promise:"undefined"!=typeof Promise?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(e,t,r){var n,o,s,a,u,c,l,h=[];for(n in(i.isDomElement(e)||i.isJqueryElement(e))&&(e=i.collectFormValues(e)),t)for(o in s=i.getDeepObjectValue(e,n),a=i.result(t[n],s,e,n,r,t)){if(!(u=i.validators[o]))throw l=i.format("Unknown validator %{name}",{name:o}),new Error(l);c=a[o],(c=i.result(c,s,e,n,r,t))&&h.push({attribute:n,value:s,validator:o,globalOptions:r,attributes:e,options:c,error:u.call(u,s,c,n,e,r)})}return h},processValidationResults:function(e,t){e=i.pruneEmptyErrors(e,t),e=i.expandMultipleErrors(e,t),e=i.convertErrorMessages(e,t);var r=t.format||"grouped";if("function"!=typeof i.formatters[r])throw new Error(i.format("Unknown format %{format}",t));return e=i.formatters[r](e),i.isEmpty(e)?void 0:e},async:function(e,t,r){var n=(r=i.extend({},i.async.options,r)).wrapErrors||function(e){return e};!1!==r.cleanAttributes&&(e=i.cleanAttributes(e,t));var o=i.runValidations(e,t,r);return new i.Promise((function(s,a){i.waitForResults(o).then((function(){var u=i.processValidationResults(o,r);u?a(new n(u,r,e,t)):s(e)}),(function(e){a(e)}))}))},single:function(e,t,r){return r=i.extend({},i.single.options,r,{format:"flat",fullMessages:!1}),i({single:e},{single:t},r)},waitForResults:function(e){return e.reduce((function(e,t){return i.isPromise(t.error)?e.then((function(){return t.error.then((function(e){t.error=e||null}))})):e}),new i.Promise((function(e){e()})))},result:function(e){var t=[].slice.call(arguments,1);return"function"==typeof e&&(e=e.apply(null,t)),e},isNumber:function(e){return"number"==typeof e&&!isNaN(e)},isFunction:function(e){return"function"==typeof e},isInteger:function(e){return i.isNumber(e)&&e%1==0},isBoolean:function(e){return"boolean"==typeof e},isObject:function(e){return e===Object(e)},isDate:function(e){return e instanceof Date},isDefined:function(e){return null!=e},isPromise:function(e){return!!e&&i.isFunction(e.then)},isJqueryElement:function(e){return e&&i.isString(e.jquery)},isDomElement:function(e){return!!e&&(!(!e.querySelectorAll||!e.querySelector)&&(!(!i.isObject(document)||e!==document)||("object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName)))},isEmpty:function(e){var t;if(!i.isDefined(e))return!0;if(i.isFunction(e))return!1;if(i.isString(e))return i.EMPTY_STRING_REGEXP.test(e);if(i.isArray(e))return 0===e.length;if(i.isDate(e))return!1;if(i.isObject(e)){for(t in e)return!1;return!0}return!1},format:i.extend((function(e,t){return i.isString(e)?e.replace(i.format.FORMAT_REGEXP,(function(e,r,n){return"%"===r?"%{"+n+"}":String(t[n])})):e}),{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(e){return i.isNumber(e)?100*e%1==0?""+e:parseFloat(Math.round(100*e)/100).toFixed(2):i.isArray(e)?e.map((function(e){return i.prettify(e)})).join(", "):i.isObject(e)?i.isDefined(e.toString)?e.toString():JSON.stringify(e):(e=""+e).replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,(function(e,t,r){return t+" "+r.toLowerCase()})).toLowerCase()},stringifyValue:function(e,t){return(t&&t.prettify||i.prettify)(e)},isString:function(e){return"string"==typeof e},isArray:function(e){return"[object Array]"==={}.toString.call(e)},isHash:function(e){return i.isObject(e)&&!i.isArray(e)&&!i.isFunction(e)},contains:function(e,t){return!!i.isDefined(e)&&(i.isArray(e)?-1!==e.indexOf(t):t in e)},unique:function(e){return i.isArray(e)?e.filter((function(e,t,r){return r.indexOf(e)==t})):e},forEachKeyInKeypath:function(e,t,r){if(i.isString(t)){var n,o="",s=!1;for(n=0;n<t.length;++n)switch(t[n]){case".":s?(s=!1,o+="."):(e=r(e,o,!1),o="");break;case"\\":s?(s=!1,o+="\\"):s=!0;break;default:s=!1,o+=t[n]}return r(e,o,!0)}},getDeepObjectValue:function(e,t){if(i.isObject(e))return i.forEachKeyInKeypath(e,t,(function(e,t){if(i.isObject(e))return e[t]}))},collectFormValues:function(e,t){var r,n,o,s,a,u,c={};if(i.isJqueryElement(e)&&(e=e[0]),!e)return c;for(t=t||{},s=e.querySelectorAll("input[name], textarea[name]"),r=0;r<s.length;++r)if(o=s.item(r),!i.isDefined(o.getAttribute("data-ignored"))){var l=o.name.replace(/\./g,"\\\\.");u=i.sanitizeFormValue(o.value,t),"number"===o.type?u=u?+u:null:"checkbox"===o.type?o.attributes.value?o.checked||(u=c[l]||null):u=o.checked:"radio"===o.type&&(o.checked||(u=c[l]||null)),c[l]=u}for(s=e.querySelectorAll("select[name]"),r=0;r<s.length;++r)if(o=s.item(r),!i.isDefined(o.getAttribute("data-ignored"))){if(o.multiple)for(n in u=[],o.options)(a=o.options[n])&&a.selected&&u.push(i.sanitizeFormValue(a.value,t));else{var h=void 0!==o.options[o.selectedIndex]?o.options[o.selectedIndex].value:"";u=i.sanitizeFormValue(h,t)}c[o.name]=u}return c},sanitizeFormValue:function(e,t){return t.trim&&i.isString(e)&&(e=e.trim()),!1!==t.nullify&&""===e?null:e},capitalize:function(e){return i.isString(e)?e[0].toUpperCase()+e.slice(1):e},pruneEmptyErrors:function(e){return e.filter((function(e){return!i.isEmpty(e.error)}))},expandMultipleErrors:function(e){var t=[];return e.forEach((function(e){i.isArray(e.error)?e.error.forEach((function(r){t.push(i.extend({},e,{error:r}))})):t.push(e)})),t},convertErrorMessages:function(e,t){var r=[],n=(t=t||{}).prettify||i.prettify;return e.forEach((function(e){var o=i.result(e.error,e.value,e.attribute,e.options,e.attributes,e.globalOptions);i.isString(o)?("^"===o[0]?o=o.slice(1):!1!==t.fullMessages&&(o=i.capitalize(n(e.attribute))+" "+o),o=o.replace(/\\\^/g,"^"),o=i.format(o,{value:i.stringifyValue(e.value,t)}),r.push(i.extend({},e,{error:o}))):r.push(e)})),r},groupErrorsByAttribute:function(e){var t={};return e.forEach((function(e){var r=t[e.attribute];r?r.push(e):t[e.attribute]=[e]})),t},flattenErrorsToArray:function(e){return e.map((function(e){return e.error})).filter((function(e,t,r){return r.indexOf(e)===t}))},cleanAttributes:function(e,t){function r(e,t,r){return i.isObject(e[t])?e[t]:e[t]=!!r||{}}return i.isObject(t)&&i.isObject(e)?function e(t,r){if(!i.isObject(t))return t;var n,o,s=i.extend({},t);for(o in t)n=r[o],i.isObject(n)?s[o]=e(s[o],n):n||delete s[o];return s}(e,t=function(e){var t,n={};for(t in e)e[t]&&i.forEachKeyInKeypath(n,t,r);return n}(t)):{}},exposeModule:function(e,t,r,n,i){r?(n&&n.exports&&(r=n.exports=e),r.validate=e):(t.validate=e,e.isFunction(i)&&i.amd&&i([],(function(){return e})))},warn:function(e){"undefined"!=typeof console&&console.warn&&console.warn("[validate.js] "+e)},error:function(e){"undefined"!=typeof console&&console.error&&console.error("[validate.js] "+e)}}),n.validators={presence:function(e,t){if(!1!==(t=i.extend({},this.options,t)).allowEmpty?!i.isDefined(e):i.isEmpty(e))return t.message||this.message||"can't be blank"},length:function(e,t,r){if(i.isDefined(e)){var n,o=(t=i.extend({},this.options,t)).is,s=t.maximum,a=t.minimum,u=[],c=(e=(t.tokenizer||function(e){return e})(e)).length;return i.isNumber(c)?(i.isNumber(o)&&c!==o&&(n=t.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",u.push(i.format(n,{count:o}))),i.isNumber(a)&&c<a&&(n=t.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",u.push(i.format(n,{count:a}))),i.isNumber(s)&&c>s&&(n=t.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",u.push(i.format(n,{count:s}))),u.length>0?t.message||u:void 0):t.message||this.notValid||"has an incorrect length"}},numericality:function(e,t,r,n,o){if(i.isDefined(e)){var s,a,u=[],c={greaterThan:function(e,t){return e>t},greaterThanOrEqualTo:function(e,t){return e>=t},equalTo:function(e,t){return e===t},lessThan:function(e,t){return e<t},lessThanOrEqualTo:function(e,t){return e<=t},divisibleBy:function(e,t){return e%t==0}},l=(t=i.extend({},this.options,t)).prettify||o&&o.prettify||i.prettify;if(i.isString(e)&&t.strict){var h="^-?(0|[1-9]\\d*)";if(t.onlyInteger||(h+="(\\.\\d+)?"),h+="$",!new RegExp(h).test(e))return t.message||t.notValid||this.notValid||this.message||"must be a valid number"}if(!0!==t.noStrings&&i.isString(e)&&!i.isEmpty(e)&&(e=+e),!i.isNumber(e))return t.message||t.notValid||this.notValid||this.message||"is not a number";if(t.onlyInteger&&!i.isInteger(e))return t.message||t.notInteger||this.notInteger||this.message||"must be an integer";for(s in c)if(a=t[s],i.isNumber(a)&&!c[s](e,a)){var f="not"+i.capitalize(s),d=t[f]||this[f]||this.message||"must be %{type} %{count}";u.push(i.format(d,{count:a,type:l(s)}))}return t.odd&&e%2!=1&&u.push(t.notOdd||this.notOdd||this.message||"must be odd"),t.even&&e%2!=0&&u.push(t.notEven||this.notEven||this.message||"must be even"),u.length?t.message||u:void 0}},datetime:i.extend((function(e,t){if(!i.isFunction(this.parse)||!i.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(i.isDefined(e)){var r,n=[],o=(t=i.extend({},this.options,t)).earliest?this.parse(t.earliest,t):NaN,s=t.latest?this.parse(t.latest,t):NaN;return e=this.parse(e,t),isNaN(e)||t.dateOnly&&e%864e5!=0?(r=t.notValid||t.message||this.notValid||"must be a valid date",i.format(r,{value:arguments[0]})):(!isNaN(o)&&e<o&&(r=t.tooEarly||t.message||this.tooEarly||"must be no earlier than %{date}",r=i.format(r,{value:this.format(e,t),date:this.format(o,t)}),n.push(r)),!isNaN(s)&&e>s&&(r=t.tooLate||t.message||this.tooLate||"must be no later than %{date}",r=i.format(r,{date:this.format(s,t),value:this.format(e,t)}),n.push(r)),n.length?i.unique(n):void 0)}}),{parse:null,format:null}),date:function(e,t){return t=i.extend({},t,{dateOnly:!0}),i.validators.datetime.call(i.validators.datetime,e,t)},format:function(e,t){(i.isString(t)||t instanceof RegExp)&&(t={pattern:t});var r,n=(t=i.extend({},this.options,t)).message||this.message||"is invalid",o=t.pattern;if(i.isDefined(e))return i.isString(e)?(i.isString(o)&&(o=new RegExp(t.pattern,t.flags)),(r=o.exec(e))&&r[0].length==e.length?void 0:n):n},inclusion:function(e,t){if(i.isDefined(e)&&(i.isArray(t)&&(t={within:t}),t=i.extend({},this.options,t),!i.contains(t.within,e))){var r=t.message||this.message||"^%{value} is not included in the list";return i.format(r,{value:e})}},exclusion:function(e,t){if(i.isDefined(e)&&(i.isArray(t)&&(t={within:t}),t=i.extend({},this.options,t),i.contains(t.within,e))){var r=t.message||this.message||"^%{value} is restricted";return i.isString(t.within[e])&&(e=t.within[e]),i.format(r,{value:e})}},email:i.extend((function(e,t){var r=(t=i.extend({},this.options,t)).message||this.message||"is not a valid email";if(i.isDefined(e))return i.isString(e)&&this.PATTERN.exec(e)?void 0:r}),{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(e,t,r,n,o){if(i.isDefined(e)){i.isString(t)&&(t={attribute:t});var s=(t=i.extend({},this.options,t)).message||this.message||"is not equal to %{attribute}";if(i.isEmpty(t.attribute)||!i.isString(t.attribute))throw new Error("The attribute must be a non empty string");var a=i.getDeepObjectValue(n,t.attribute),u=t.comparator||function(e,t){return e===t},c=t.prettify||o&&o.prettify||i.prettify;return u(e,a,t,r,n)?void 0:i.format(s,{attribute:c(t.attribute)})}},url:function(e,t){if(i.isDefined(e)){var r=(t=i.extend({},this.options,t)).message||this.message||"is not a valid url",n=t.schemes||this.schemes||["http","https"],o=t.allowLocal||this.allowLocal||!1,s=t.allowDataUrl||this.allowDataUrl||!1;if(!i.isString(e))return r;var a="^(?:(?:"+n.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",u="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(o?u+="?":a+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",a+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+u+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",s){a="(?:"+a+")|(?:^data:(?:\\w+\\/[-+.\\w]+(?:;[\\w=]+)*)?(?:;base64)?,[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*$)"}return new RegExp(a,"i").exec(e)?void 0:r}},type:i.extend((function(e,t,r,n,o){if(i.isString(t)&&(t={type:t}),i.isDefined(e)){var s,a=i.extend({},this.options,t),u=a.type;if(!i.isDefined(u))throw new Error("No type was specified");if(s=i.isFunction(u)?u:this.types[u],!i.isFunction(s))throw new Error("validate.validators.type.types."+u+" must be a function.");if(!s(e,a,r,n,o)){var c=t.message||this.messages[u]||this.message||a.message||(i.isFunction(u)?"must be of the correct type":"must be of type %{type}");return i.isFunction(c)&&(c=c(e,t,r,n,o)),i.format(c,{attribute:i.prettify(r),type:u})}}}),{types:{object:function(e){return i.isObject(e)&&!i.isArray(e)},array:i.isArray,integer:i.isInteger,number:i.isNumber,string:i.isString,date:i.isDate,boolean:i.isBoolean},messages:{}})},n.formatters={detailed:function(e){return e},flat:i.flattenErrorsToArray,grouped:function(e){var t;for(t in e=i.groupErrorsByAttribute(e))e[t]=i.flattenErrorsToArray(e[t]);return e},constraint:function(e){var t;for(t in e=i.groupErrorsByAttribute(e))e[t]=e[t].map((function(e){return e.validator})).sort();return e}},n.exposeModule(n,this,e,t,r)}).call(de,t,e,null)}));function wr(t){let r,n,i,o,s,a,u,c,l,h,f,d=(t[2]||"")+"";return{c(){r=y("div"),n=y("label"),i=w(t[1]),o=F(),s=y("div"),a=y("input"),u=F(),c=y("div"),l=w(d),E(n,"class",""),E(a,"name","title"),E(a,"type","text"),E(a,"class","px-2 border border-gray-400 focus:border-indigo-600 text-gray-700 focus:border-red-300 focus:outline-none rounded-sm"),E(a,"autocomplete","off"),E(c,"class","h-4 md:h-8 text-red-500"),E(s,"class","flex flex-col col-span-2"),E(r,"class","grid sm:grid-cols-3 sm:gap-4 mb-2")},m(e,d){g(e,r,d),p(r,n),p(n,i),p(r,o),p(r,s),p(s,a),t[5](a),D(a,t[0]),p(s,u),p(s,c),p(c,l),h||(f=S(a,"input",t[6]),h=!0)},p(e,[t]){2&t&&x(i,e[1]),1&t&&a.value!==e[0]&&D(a,e[0]),4&t&&d!==(d=(e[2]||"")+"")&&x(l,d)},i:e,o:e,d(e){e&&m(r),t[5](null),h=!1,f()}}}function Fr(e,t,r){let n,{label:i}=t,{value:o}=t,{errorMsg:s}=t,{autofocus:a}=t;return T((()=>{a&&setTimeout((()=>{n.focus()}),0)})),e.$$set=e=>{"label"in e&&r(1,i=e.label),"value"in e&&r(0,o=e.value),"errorMsg"in e&&r(2,s=e.errorMsg),"autofocus"in e&&r(4,a=e.autofocus)},[o,i,s,n,a,function(e){j[e?"unshift":"push"]((()=>{n=e,r(3,n)}))},function(){o=this.value,r(0,o)}]}class _r extends ue{constructor(e){super(),ae(this,e,Fr,wr,s,{label:1,value:0,errorMsg:2,autofocus:4})}}function Sr(t){let r,n,i,o,s,a,u,c,l,h,f,d=(t[2]||"")+"";return{c(){r=y("div"),n=y("input"),i=F(),o=y("div"),s=y("label"),a=w(t[1]),u=F(),c=y("div"),l=w(d),E(n,"type","checkbox"),E(n,"id","checkbox"),E(s,"class","ml-4"),E(s,"for","checkbox"),E(c,"class","text-red-500"),E(o,"class","flex flex-col"),E(r,"class","flex items-center")},m(e,d){g(e,r,d),p(r,n),n.checked=t[0],p(r,i),p(r,o),p(o,s),p(s,a),p(o,u),p(o,c),p(c,l),h||(f=S(n,"change",t[3]),h=!0)},p(e,[t]){1&t&&(n.checked=e[0]),2&t&&x(a,e[1]),4&t&&d!==(d=(e[2]||"")+"")&&x(l,d)},i:e,o:e,d(e){e&&m(r),h=!1,f()}}}function Er(e,t,r){let{label:n}=t,{value:i}=t,{errorMsg:o}=t;return e.$$set=e=>{"label"in e&&r(1,n=e.label),"value"in e&&r(0,i=e.value),"errorMsg"in e&&r(2,o=e.errorMsg)},[i,n,o,function(){i=this.checked,r(0,i)}]}class xr extends ue{constructor(e){super(),ae(this,e,Er,Sr,s,{label:1,value:0,errorMsg:2})}}function Dr(e){const t=document.createElement("div");t.style.display="block",t.style.position="relative";const r=document.createElement("div"),n=getComputedStyle(e);function i(){r.innerHTML=e.value+" "}return Object.assign(r.style,{minHeight:n.minHeight,fontFamily:n.fontFamily,fontSize:n.fontSize,paddingTop:n.paddingTop,paddingLeft:n.paddingLeft,paddingBottom:n.paddingBottom,paddingRight:n.paddingRight,borderTopWidth:n.borderTopWidth,borderLeftWidth:n.borderLeftWidth,borderBottomWidth:n.borderBottomWidth,borderRightWidth:n.borderRightWidth,borderTopStyle:n.borderTopStyle,borderLeftStyle:n.borderLeftStyle,borderBottomStyle:n.borderBottomStyle,borderRightStyle:n.borderRightStyle,lineHeight:n.lineHeight,boxSizing:n.boxSizing,position:"relative",whiteSpace:"pre",visibility:"hidden"}),Object.assign(e.style,{position:"absolute",left:0,top:0,width:"100%",height:"100%",resize:"none"}),t.appendChild(r),e.parentNode.insertBefore(t,e),t.appendChild(e),i(),e.addEventListener("input",i),{destroy(){e.removeEventListener("input",i)}}}function kr(t){let r,n,o,s,a,u,c,l,h,f,v,b,_=(t[2]||"")+"";return{c(){r=y("div"),n=y("label"),o=w(t[1]),s=F(),a=y("div"),u=y("textarea"),l=F(),h=y("div"),f=w(_),E(n,"class",""),E(u,"name","title"),E(u,"class","px-2 border border-gray-400 focus:border-indigo-600 text-gray-700 focus:border-red-300\n               focus:outline-none rounded-sm svelte-o75bor"),E(u,"autocomplete","off"),E(h,"class","h-4 md:h-8 text-red-500"),E(a,"class","flex flex-col col-span-2"),E(r,"class","grid sm:grid-cols-3 sm:gap-4 mb-2")},m(e,i){g(e,r,i),p(r,n),p(n,o),p(r,s),p(r,a),p(a,u),t[5](u),D(u,t[0]),p(a,l),p(a,h),p(h,f),v||(b=[S(u,"input",t[6]),d(c=Dr.call(null,u))],v=!0)},p(e,[t]){2&t&&x(o,e[1]),1&t&&D(u,e[0]),4&t&&_!==(_=(e[2]||"")+"")&&x(f,_)},i:e,o:e,d(e){e&&m(r),t[5](null),v=!1,i(b)}}}function Ar(e,t,r){let n,{label:i}=t,{value:o}=t,{errorMsg:s}=t,{autofocus:a}=t;return T((()=>{a&&setTimeout((()=>{n.focus()}),0)})),e.$$set=e=>{"label"in e&&r(1,i=e.label),"value"in e&&r(0,o=e.value),"errorMsg"in e&&r(2,s=e.errorMsg),"autofocus"in e&&r(4,a=e.autofocus)},[o,i,s,n,a,function(e){j[e?"unshift":"push"]((()=>{n=e,r(3,n)}))},function(){o=this.value,r(0,o)}]}class Cr extends ue{constructor(e){super(),ae(this,e,Ar,kr,s,{label:1,value:0,errorMsg:2,autofocus:4})}}function Pr(t){let r,n,i,o,s;return{c(){r=y("button"),n=w(t[0]),r.disabled=t[2],E(r,"class",i="text-sm px-4 py-2 leading-none border rounded border-gray-500\n    "+(t[1]?"bg-mytrack-light active:bg-mytrack-dark":"active:bg-gray-300")+"\n\n   focus:outline-none\n lg:mt-0 svelte-keq1it")},m(e,i){g(e,r,i),p(r,n),o||(s=S(r,"click",t[3]),o=!0)},p(e,[t]){1&t&&x(n,e[0]),4&t&&(r.disabled=e[2]),2&t&&i!==(i="text-sm px-4 py-2 leading-none border rounded border-gray-500\n    "+(e[1]?"bg-mytrack-light active:bg-mytrack-dark":"active:bg-gray-300")+"\n\n   focus:outline-none\n lg:mt-0 svelte-keq1it")&&E(r,"class",i)},i:e,o:e,d(e){e&&m(r),o=!1,s()}}}function Tr(e,t,r){let{name:n="Button"}=t,{defaultAction:i=!1}=t,{disabled:o}=t;return e.$$set=e=>{"name"in e&&r(0,n=e.name),"defaultAction"in e&&r(1,i=e.defaultAction),"disabled"in e&&r(2,o=e.disabled)},[n,i,o,function(t){B(e,t)}]}class Rr extends ue{constructor(e){super(),ae(this,e,Tr,Pr,s,{name:0,defaultAction:1,disabled:2})}}function Br(t){let r,n;return{c(){r=y("div"),E(r,"class",n="border-t-2 border-l-2 rounded-full animate-spin circle w-"+t[0]+" h-"+t[0]+" border-mytrack-dark border-solid")},m(e,t){g(e,r,t)},p(e,[t]){1&t&&n!==(n="border-t-2 border-l-2 rounded-full animate-spin circle w-"+e[0]+" h-"+e[0]+" border-mytrack-dark border-solid")&&E(r,"class",n)},i:e,o:e,d(e){e&&m(r)}}}function Ir(e,t,r){let{size:n=16}=t;return e.$$set=e=>{"size"in e&&r(0,n=e.size)},[n]}class jr extends ue{constructor(e){super(),ae(this,e,Ir,Br,s,{size:0})}}function $r(e){let t,r,n;return r=new jr({}),{c(){t=y("div"),ie(r.$$.fragment),E(t,"class","z-50 flex justify-center items-center opacity-75 bg-white w-full h-full absolute top-0 left-0"),E(t,"id","busy-screen")},m(e,i){g(e,t,i),oe(r,t,null),n=!0},i(e){n||(Z(r.$$.fragment,e),n=!0)},o(e){Q(r.$$.fragment,e),n=!1},d(e){e&&m(t),se(r)}}}function Lr(e){let t,r,n=e[0]&&$r();return{c(){n&&n.c(),t=_()},m(e,i){n&&n.m(e,i),g(e,t,i),r=!0},p(e,[r]){e[0]?n?1&r&&Z(n,1):(n=$r(),n.c(),Z(n,1),n.m(t.parentNode,t)):n&&(G(),Q(n,1,1,(()=>{n=null})),X())},i(e){r||(Z(n),r=!0)},o(e){Q(n),r=!1},d(e){n&&n.d(e),e&&m(t)}}}function Nr(e,t,r){let{loading:n=!1}=t;return e.$$set=e=>{"loading"in e&&r(0,n=e.loading)},[n]}class Or extends ue{constructor(e){super(),ae(this,e,Nr,Lr,s,{loading:0})}}function Ur(t){let r,n,i,o,s;return{c(){r=y("button"),n=w(t[0]),r.disabled=t[1],E(r,"class",i="text-sm px-4 py-2 leading-none border rounded "+t[2]+" "+t[3]+" active:"+t[4]+"\n   "+t[5]+"\n\n   focus:outline-none\n lg:mt-0 svelte-keq1it")},m(e,i){g(e,r,i),p(r,n),o||(s=S(r,"click",t[6]),o=!0)},p(e,[t]){1&t&&x(n,e[0]),2&t&&(r.disabled=e[1]),60&t&&i!==(i="text-sm px-4 py-2 leading-none border rounded "+e[2]+" "+e[3]+" active:"+e[4]+"\n   "+e[5]+"\n\n   focus:outline-none\n lg:mt-0 svelte-keq1it")&&E(r,"class",i)},i:e,o:e,d(e){e&&m(r),o=!1,s()}}}function Mr(e,t,r){let{name:n="Button"}=t,{disabled:i}=t,{bgColor:o="border-gray-500"}=t,{textColor:s=""}=t,{pressedBackground:a="bg-gray-300"}=t,{extraStyle:u=""}=t;return e.$$set=e=>{"name"in e&&r(0,n=e.name),"disabled"in e&&r(1,i=e.disabled),"bgColor"in e&&r(2,o=e.bgColor),"textColor"in e&&r(3,s=e.textColor),"pressedBackground"in e&&r(4,a=e.pressedBackground),"extraStyle"in e&&r(5,u=e.extraStyle)},[n,i,o,s,a,u,function(t){B(e,t)}]}class Hr extends ue{constructor(e){super(),ae(this,e,Mr,Ur,s,{name:0,disabled:1,bgColor:2,textColor:3,pressedBackground:4,extraStyle:5})}}function qr(e,t,r){const n=e.slice();return n[18]=t[r][0],n[19]=t[r][1],n[20]=t,n[21]=r,n}function Vr(e){let t,r,n,i;function o(t){e[16].call(null,t,e[18])}function s(t){e[17].call(null,t,e[18])}let a={label:e[19].label,autofocus:e[19].autofocus||!1};return void 0!==e[0][e[18]]&&(a.value=e[0][e[18]]),void 0!==e[3][e[18]]&&(a.errorMsg=e[3][e[18]]),t=new Cr({props:a}),j.push((()=>ne(t,"value",o))),j.push((()=>ne(t,"errorMsg",s))),{c(){ie(t.$$.fragment)},m(e,r){oe(t,e,r),i=!0},p(i,o){e=i;const s={};2&o&&(s.label=e[19].label),2&o&&(s.autofocus=e[19].autofocus||!1),!r&&3&o&&(r=!0,s.value=e[0][e[18]],q((()=>r=!1))),!n&&10&o&&(n=!0,s.errorMsg=e[3][e[18]],q((()=>n=!1))),t.$set(s)},i(e){i||(Z(t.$$.fragment,e),i=!0)},o(e){Q(t.$$.fragment,e),i=!1},d(e){se(t,e)}}}function Kr(e){let t,r,n,i;function o(t){e[14].call(null,t,e[18])}function s(t){e[15].call(null,t,e[18])}let a={label:e[19].label};return void 0!==e[0][e[18]]&&(a.value=e[0][e[18]]),void 0!==e[3][e[18]]&&(a.errorMsg=e[3][e[18]]),t=new xr({props:a}),j.push((()=>ne(t,"value",o))),j.push((()=>ne(t,"errorMsg",s))),{c(){ie(t.$$.fragment)},m(e,r){oe(t,e,r),i=!0},p(i,o){e=i;const s={};2&o&&(s.label=e[19].label),!r&&3&o&&(r=!0,s.value=e[0][e[18]],q((()=>r=!1))),!n&&10&o&&(n=!0,s.errorMsg=e[3][e[18]],q((()=>n=!1))),t.$set(s)},i(e){i||(Z(t.$$.fragment,e),i=!0)},o(e){Q(t.$$.fragment,e),i=!1},d(e){se(t,e)}}}function zr(e){let t,r,n,i;function o(t){e[12].call(null,t,e[18])}function s(t){e[13].call(null,t,e[18])}let a={label:e[19].label,autofocus:e[19].autofocus||!1};return void 0!==e[0][e[18]]&&(a.value=e[0][e[18]]),void 0!==e[3][e[18]]&&(a.errorMsg=e[3][e[18]]),t=new _r({props:a}),j.push((()=>ne(t,"value",o))),j.push((()=>ne(t,"errorMsg",s))),{c(){ie(t.$$.fragment)},m(e,r){oe(t,e,r),i=!0},p(i,o){e=i;const s={};2&o&&(s.label=e[19].label),2&o&&(s.autofocus=e[19].autofocus||!1),!r&&3&o&&(r=!0,s.value=e[0][e[18]],q((()=>r=!1))),!n&&10&o&&(n=!0,s.errorMsg=e[3][e[18]],q((()=>n=!1))),t.$set(s)},i(e){i||(Z(t.$$.fragment,e),i=!0)},o(e){Q(t.$$.fragment,e),i=!1},d(e){se(t,e)}}}function Jr(e,t){let r,n,i,o,s;const a=[zr,Kr,Vr],u=[];function c(e,t){return"text"===e[19].type?0:"checkbox"===e[19].type?1:"textarea"===e[19].type?2:-1}return~(n=c(t))&&(i=u[n]=a[n](t)),{key:e,first:null,c(){r=_(),i&&i.c(),o=_(),this.first=r},m(e,t){g(e,r,t),~n&&u[n].m(e,t),g(e,o,t),s=!0},p(e,t){let r=n;n=c(e),n===r?~n&&u[n].p(e,t):(i&&(G(),Q(u[r],1,1,(()=>{u[r]=null})),X()),~n?(i=u[n],i?i.p(e,t):(i=u[n]=a[n](e),i.c()),Z(i,1),i.m(o.parentNode,o)):i=null)},i(e){s||(Z(i),s=!0)},o(e){Q(i),s=!1},d(e){e&&m(r),~n&&u[n].d(e),e&&m(o)}}}function Wr(e){let t,r,n,i,s,a,u,c,l,h,f,d,v,b,w,_=[],x=new Map;r=new Or({props:{loading:e[5]}});let D=Object.entries(e[1]);const k=e=>e[18];for(let t=0;t<D.length;t+=1){let r=qr(e,D,t),n=k(r);x.set(n,_[t]=Jr(n,r))}return a=new Rr({props:{name:"Save",defaultAction:"true",disabled:!e[4]}}),a.$on("click",e[6]),h=new Hr({props:{name:"Delete",textColor:"text-white",bgColor:"bg-red-700",pressedBackground:"bg-red-900",extraStyle:"px-0"}}),h.$on("click",e[7]),d=new Rr({props:{name:"Cancel"}}),d.$on("click",(function(){o(e[2])&&e[2].apply(this,arguments)})),{c(){t=y("div"),ie(r.$$.fragment),n=F();for(let e=0;e<_.length;e+=1)_[e].c();i=F(),s=y("div"),ie(a.$$.fragment),u=F(),c=y("div"),l=F(),ie(h.$$.fragment),f=F(),ie(d.$$.fragment),E(s,"class","mt-4 grid grid-cols-4 md:grid-cols-4 gap-4"),E(s,"id","form-action-bar"),E(t,"class","grid relative w-full")},m(o,m){g(o,t,m),oe(r,t,null),p(t,n);for(let e=0;e<_.length;e+=1)_[e].m(t,null);p(t,i),p(t,s),oe(a,s,null),p(s,u),p(s,c),p(s,l),oe(h,s,null),p(s,f),oe(d,s,null),v=!0,b||(w=S(t,"keydown",e[8]),b=!0)},p(n,[o]){e=n;const s={};if(32&o&&(s.loading=e[5]),r.$set(s),11&o){const r=Object.entries(e[1]);G(),_=function(e,t,r,n,i,o,s,a,u,c,l,h){let f=e.length,d=o.length,p=f;const g={};for(;p--;)g[e[p].key]=p;const m=[],v=new Map,y=new Map;for(p=d;p--;){const e=h(i,o,p),a=r(e);let u=s.get(a);u?n&&u.p(e,t):(u=c(a,e),u.c()),v.set(a,m[p]=u),a in g&&y.set(a,Math.abs(p-g[a]))}const b=new Set,w=new Set;function F(e){Z(e,1),e.m(a,l),s.set(e.key,e),l=e.first,d--}for(;f&&d;){const t=m[d-1],r=e[f-1],n=t.key,i=r.key;t===r?(l=t.first,f--,d--):v.has(i)?!s.has(n)||b.has(n)?F(t):w.has(i)?f--:y.get(n)>y.get(i)?(w.add(n),F(t)):(b.add(i),f--):(u(r,s),f--)}for(;f--;){const t=e[f];v.has(t.key)||u(t,s)}for(;d;)F(m[d-1]);return m}(_,o,k,1,e,r,x,t,ee,Jr,i,qr),X()}const u={};16&o&&(u.disabled=!e[4]),a.$set(u)},i(e){if(!v){Z(r.$$.fragment,e);for(let e=0;e<D.length;e+=1)Z(_[e]);Z(a.$$.fragment,e),Z(h.$$.fragment,e),Z(d.$$.fragment,e),v=!0}},o(e){Q(r.$$.fragment,e);for(let e=0;e<_.length;e+=1)Q(_[e]);Q(a.$$.fragment,e),Q(h.$$.fragment,e),Q(d.$$.fragment,e),v=!1},d(e){e&&m(t),se(r);for(let e=0;e<_.length;e+=1)_[e].d();se(a),se(h),se(d),b=!1,w()}}}function Yr(e,t,r){let{dataObject:n}=t,{fields:i}=t,{constraints:o}=t,{onSubmit:s}=t,{onDelete:a}=t,{onCancel:u=(()=>{Jt()})}=t,c={},l=!1,h=!1;async function f(){r(5,h=!0),await s(n),r(5,h=!1)}return e.$$set=e=>{"dataObject"in e&&r(0,n=e.dataObject),"fields"in e&&r(1,i=e.fields),"constraints"in e&&r(9,o=e.constraints),"onSubmit"in e&&r(10,s=e.onSubmit),"onDelete"in e&&r(11,a=e.onDelete),"onCancel"in e&&r(2,u=e.onCancel)},e.$$.update=()=>{if(513&e.$$.dirty){let e=br.validate(n,o);r(4,l=void 0===e),r(3,c=e||{})}},[n,i,u,c,l,h,f,async function(){r(5,h=!0),await a(n),r(5,h=!1)},function(e){e.ctrlKey&&"Enter"===e.key&&l&&f()},o,s,a,function(e,t){n[t]=e,r(0,n)},function(e,t){c[t]=e,r(3,c),r(0,n),r(9,o)},function(e,t){n[t]=e,r(0,n)},function(e,t){c[t]=e,r(3,c),r(0,n),r(9,o)},function(e,t){n[t]=e,r(0,n)},function(e,t){c[t]=e,r(3,c),r(0,n),r(9,o)}]}class Gr extends ue{constructor(e){super(),ae(this,e,Yr,Wr,s,{dataObject:0,fields:1,constraints:9,onSubmit:10,onDelete:11,onCancel:2})}}function Xr(e){let t,r,n,i,o,s,a,u=e[1].id?"New project":"Edit project: "+name;return t=new Or({props:{loading:e[2]}}),s=new Gr({props:{dataObject:e[0],fields:e[3],onSubmit:e[5],constraints:e[4]}}),{c(){ie(t.$$.fragment),r=F(),n=y("h1"),i=w(u),o=F(),ie(s.$$.fragment),E(n,"class","text-xl mb-4")},m(e,u){oe(t,e,u),g(e,r,u),g(e,n,u),p(n,i),g(e,o,u),oe(s,e,u),a=!0},p(e,r){const n={};4&r&&(n.loading=e[2]),t.$set(n),(!a||2&r)&&u!==(u=e[1].id?"New project":"Edit project: "+name)&&x(i,u);const o={};1&r&&(o.dataObject=e[0]),s.$set(o)},i(e){a||(Z(t.$$.fragment,e),Z(s.$$.fragment,e),a=!0)},o(e){Q(t.$$.fragment,e),Q(s.$$.fragment,e),a=!1},d(e){se(t,e),e&&m(r),e&&m(n),e&&m(o),se(s,e)}}}function Zr(e){let t,r;return t=new fe({props:{extraClasses:"relative px-2",$$slots:{default:[Xr]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,r){const n={};135&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function Qr(e){let t,r;return t=new or({props:{$$slots:{default:[Zr]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,[r]){const n={};135&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function en(e,t,r){let{params:n={}}=t,i=!0,o=new Pt,{project:s={title:void 0,description:""}}=t;return T((async()=>{if(n.id)try{r(0,s=await o.getProject(n.id))}catch(e){console.log(e)}r(2,i=!1)})),e.$$set=e=>{"params"in e&&r(1,n=e.params),"project"in e&&r(0,s=e.project)},[s,n,i,{title:{type:"text",label:"Title",autofocus:!0},description:{type:"textarea",label:"Description"}},{title:{presence:{allowEmpty:!1}}},async function(e){await o.saveProject(e),zt("#/projects"),n.id}]}class tn extends ue{constructor(e){super(),ae(this,e,en,Qr,s,{params:1,project:0})}}function rn(e){let t,r,n,i,o,s,a,u=e[1]?"New "+e[2]:"Edit "+e[2];return t=new Or({props:{loading:e[5]}}),s=new Gr({props:{dataObject:e[0],fields:e[3],onSubmit:e[6],constraints:e[4],onDelete:e[7]}}),{c(){ie(t.$$.fragment),r=F(),n=y("h1"),i=w(u),o=F(),ie(s.$$.fragment),E(n,"class","text-xl mb-4")},m(e,u){oe(t,e,u),g(e,r,u),g(e,n,u),p(n,i),g(e,o,u),oe(s,e,u),a=!0},p(e,r){const n={};32&r&&(n.loading=e[5]),t.$set(n),(!a||6&r)&&u!==(u=e[1]?"New "+e[2]:"Edit "+e[2])&&x(i,u);const o={};1&r&&(o.dataObject=e[0]),8&r&&(o.fields=e[3]),16&r&&(o.constraints=e[4]),s.$set(o)},i(e){a||(Z(t.$$.fragment,e),Z(s.$$.fragment,e),a=!0)},o(e){Q(t.$$.fragment,e),Q(s.$$.fragment,e),a=!1},d(e){se(t,e),e&&m(r),e&&m(n),e&&m(o),se(s,e)}}}function nn(e){let t,r;return t=new fe({props:{extraClasses:"relative",$$slots:{default:[rn]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,[r]){const n={};4159&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function on(e,t,r){let{isNew:n=!0}=t,{name:i=""}=t,{dataObject:o}=t,{fields:s}=t,{constraints:a}=t,{readFunc:u}=t,{saveFunc:c}=t,{deleteFunc:l}=t,{redirect:h}=t,f=!0;return T((async()=>{n||r(0,o=await u()),r(5,f=!1)})),e.$$set=e=>{"isNew"in e&&r(1,n=e.isNew),"name"in e&&r(2,i=e.name),"dataObject"in e&&r(0,o=e.dataObject),"fields"in e&&r(3,s=e.fields),"constraints"in e&&r(4,a=e.constraints),"readFunc"in e&&r(8,u=e.readFunc),"saveFunc"in e&&r(9,c=e.saveFunc),"deleteFunc"in e&&r(10,l=e.deleteFunc),"redirect"in e&&r(11,h=e.redirect)},[o,n,i,s,a,f,async function(e){let t=await c(e);zt(h(t,!1))},async function(e){await l(e),zt(h(null,!0))},u,c,l,h]}class sn extends ue{constructor(e){super(),ae(this,e,on,nn,s,{isNew:1,name:2,dataObject:0,fields:3,constraints:4,readFunc:8,saveFunc:9,deleteFunc:10,redirect:11})}}function an(e){let t,r;return t=new sn({props:{dataObject:e[2],isNew:void 0===e[0].issueId,name:"Issue",fields:e[3],constraints:e[4],redirect:e[1],readFunc:e[5],saveFunc:e[6],deleteFunc:e[7]}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,[r]){const n={};1&r&&(n.isNew=void 0===e[0].issueId),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function un(e,t,r){let{params:n={}}=t,{projectId:i}=t,o=new Pt,s={title:void 0,description:"",closed:!1};return T((()=>{})),e.$$set=e=>{"params"in e&&r(0,n=e.params),"projectId"in e&&r(8,i=e.projectId)},[n,(e,t)=>t?`#/projects/${i}/issues/`:void 0!==e?`#/projects/${i}/issues/${e.id}`:void 0,s,{title:{type:"text",label:"Title",autofocus:!0},description:{type:"textarea",label:"Description"}},{title:{presence:{allowEmpty:!1}}},async function(){return await o.getProjectIssue(i,n.issueId)},async function(e){return await o.saveProjectIssue(i,e)},async function(e){return await o.deleteProjectIssue(i,e.id)},i]}class cn extends ue{constructor(e){super(),ae(this,e,un,an,s,{params:0,projectId:8})}}const ln=[];let hn;function fn(e){(e.className||"").split(" ").forEach((t=>{t&&(e.node.classList.remove(t),e.pattern.test(hn)&&e.node.classList.add(t))}))}function dn(e,t){if(!(t=t&&("string"==typeof t||"object"==typeof t&&t instanceof RegExp)?{path:t}:t||{}).path&&e.hasAttribute("href")&&(t.path=e.getAttribute("href"),t.path&&t.path.length>1&&"#"==t.path.charAt(0)&&(t.path=t.path.substring(1))),t.className||(t.className="active"),!t.path||"string"==typeof t.path&&(t.path.length<1||"/"!=t.path.charAt(0)&&"*"!=t.path.charAt(0)))throw Error('Invalid value for "path" argument');const{pattern:r}="string"==typeof t.path?Ut(t.path):{pattern:t.path},n={node:e,className:t.className,pattern:r};return ln.push(n),fn(n),{destroy(){ln.splice(ln.indexOf(n),1)}}}function pn(e,t,r){const n=e.slice();return n[6]=t[r],n}function gn(e){let t,r;return{c(){t=y("img"),t.src!==(r=e[6].icon)&&E(t,"src",r),E(t,"class","w-4 mr-2"),E(t,"alt","")},m(e,r){g(e,t,r)},p(e,n){2&n&&t.src!==(r=e[6].icon)&&E(t,"src",r)},d(e){e&&m(t)}}}function mn(e){let t,r,n,s,a,u,c,l,h,f,v=e[6].title+"",b=e[6].icon&&gn(e);return{c(){t=y("a"),b&&b.c(),r=F(),n=y("div"),s=w(v),a=F(),E(n,"class","text-md block md:inline-block hover:text-gray-600"),E(t,"href",u=e[6].link),E(t,"class","flex p-2 items-center")},m(i,o){g(i,t,o),b&&b.m(t,null),p(t,r),p(t,n),p(n,s),p(t,a),h||(f=[d(c=Wt.call(null,t)),d(l=dn.call(null,t,{path:e[6].link,className:"border-l-4 border-gray-500 bg-gray-100"}))],h=!0)},p(n,i){(e=n)[6].icon?b?b.p(e,i):(b=gn(e),b.c(),b.m(t,r)):b&&(b.d(1),b=null),2&i&&v!==(v=e[6].title+"")&&x(s,v),2&i&&u!==(u=e[6].link)&&E(t,"href",u),l&&o(l.update)&&2&i&&l.update.call(null,{path:e[6].link,className:"border-l-4 border-gray-500 bg-gray-100"})},d(e){e&&m(t),b&&b.d(),h=!1,i(f)}}}function vn(t){let r,n,o,s,a,u,c,l,h,f,b,_,D=t[1],A=[];for(let e=0;e<D.length;e+=1)A[e]=mn(pn(t,D,e));return{c(){r=y("nav"),n=y("div"),o=y("button"),o.innerHTML='<img src="/img/menu.svg" class="w-6 h-6" alt=""/>',s=F(),a=y("div"),u=y("div"),c=w(t[0]),l=F(),h=y("div");for(let e=0;e<A.length;e+=1)A[e].c();E(o,"class","flex items-center rounded hover:text-gray-600 hover:border-gray-600 focus:outline-none"),E(n,"class","block md:hidden"),E(u,"class","px-2 py-2  text-lg border-b-2 border-gray-400"),E(h,"class","text-sm md:flex flex-col w-full"),E(a,"id","collapsible-menu"),E(a,"class","md:flex flex-col md:items-center md:w-auto\n         absolute right-0 top-0\n         md:relative md:right-auto md:top-auto\n         mt-8 md:mt-0\n         bg-white border"),k(a,"hidden",t[2]),E(r,"class","flex items-center md:border-0")},m(e,i){g(e,r,i),p(r,n),p(n,o),p(r,s),p(r,a),p(a,u),p(u,c),p(a,l),p(a,h);for(let e=0;e<A.length;e+=1)A[e].m(h,null);b||(_=[S(o,"click",t[4]),S(a,"click",t[5]),d(f=t[3].call(null,r))],b=!0)},p(e,[t]){if(1&t&&x(c,e[0]),2&t){let r;for(D=e[1],r=0;r<D.length;r+=1){const n=pn(e,D,r);A[r]?A[r].p(n,t):(A[r]=mn(n),A[r].c(),A[r].m(h,null))}for(;r<A.length;r+=1)A[r].d(1);A.length=D.length}4&t&&k(a,"hidden",e[2])},i:e,o:e,d(e){e&&m(r),v(A,e),b=!1,i(_)}}}function yn(e,t,r){let{menuTitle:n="Menu"}=t,{items:i=[]}=t,o=!0;return e.$$set=e=>{"menuTitle"in e&&r(0,n=e.menuTitle),"items"in e&&r(1,i=e.items)},[n,i,o,function(e){const t=t=>{!e||e.contains(t.target)||t.defaultPrevented||r(2,o=!0)};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}},()=>r(2,o=!o),()=>r(2,o=!0)]}Kt.subscribe((e=>{hn=e.location+(e.querystring?"?"+e.querystring:""),ln.map(fn)}));class bn extends ue{constructor(e){super(),ae(this,e,yn,vn,s,{menuTitle:0,items:1})}}function wn(e){let t,r,n;return{c(){t=y("div"),t.textContent="Members",r=F(),n=y("div"),n.textContent='Where does it come from?\n        Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin\n        literature from 45 BC, making it over 2000 years old. Richard McClintock, a Latin professor at Hampden-Sydney\n        College in Virginia, looked up one of the more obscure Latin words, consectetur, from a Lorem Ipsum passage, and\n        going through the cites of the word in classical literature, discovered the undoubtable source. Lorem Ipsum\n        comes from sections 1.10.32 and 1.10.33 of "de Finibus Bonorum et Malorum" (The Extremes of Good and Evil) by\n        Cicero, written in 45 BC. This book is a treatise on the theory of ethics, very popular during the Renaissance.\n        The first line of Lorem Ipsum, "Lorem ipsum dolor sit amet..", comes from a line in section 1.10.32.\n\n        The standard chunk of Lorem Ipsum used since the 1500s is reproduced below for those interested. Sections\n        1.10.32 and 1.10.33 from "de Finibus Bonorum et Malorum" by Cicero are also reproduced in their exact original\n        form, accompanied by English versions from the 1914 translation by H. Rackham.',E(t,"class","text-lg font-bold")},m(e,i){g(e,t,i),g(e,r,i),g(e,n,i)},d(e){e&&m(t),e&&m(r),e&&m(n)}}}function Fn(e){let t,r;return t=new fe({props:{$$slots:{default:[wn]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,[r]){const n={};1&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}class _n extends ue{constructor(e){super(),ae(this,e,null,Fn,s,{})}}function Sn(e){let t,r,n,i,o,s,a,u,c,l,h=e[0].title+"",f=e[0].author&&En(e);return{c(){t=y("div"),r=y("div"),n=y("img"),o=F(),s=y("a"),a=y("div"),u=w(h),l=F(),f&&f.c(),E(n,"class","w-5 mr-2"),n.src!==(i="/img/project.svg")&&E(n,"src","/img/project.svg"),E(a,"class","text-lg"),E(s,"href",c="#/projects/"+e[0].projectId+"/issues/"+e[0].id),E(r,"class","flex"),E(t,"class","flex flex-col p-2 border rounded-sm w-full md:w-1/2 mb-2 mx-2 bg-gray-100")},m(e,i){g(e,t,i),p(t,r),p(r,n),p(r,o),p(r,s),p(s,a),p(a,u),p(t,l),f&&f.m(t,null)},p(e,r){1&r&&h!==(h=e[0].title+"")&&x(u,h),1&r&&c!==(c="#/projects/"+e[0].projectId+"/issues/"+e[0].id)&&E(s,"href",c),e[0].author?f?f.p(e,r):(f=En(e),f.c(),f.m(t,null)):f&&(f.d(1),f=null)},d(e){e&&m(t),f&&f.d()}}}function En(e){let t,r,n,i,o=e[0].author.firstName+"",s=e[0].author.lastName+"";return{c(){t=y("div"),r=w(o),n=F(),i=w(s),E(t,"class","text-sm")},m(e,o){g(e,t,o),p(t,r),p(t,n),p(t,i)},p(e,t){1&t&&o!==(o=e[0].author.firstName+"")&&x(r,o),1&t&&s!==(s=e[0].author.lastName+"")&&x(i,s)},d(e){e&&m(t)}}}function xn(t){let r,n=t[0]&&Sn(t);return{c(){n&&n.c(),r=_()},m(e,t){n&&n.m(e,t),g(e,r,t)},p(e,[t]){e[0]?n?n.p(e,t):(n=Sn(e),n.c(),n.m(r.parentNode,r)):n&&(n.d(1),n=null)},i:e,o:e,d(e){n&&n.d(e),e&&m(r)}}}function Dn(e,t,r){let{issue:n}=t;return e.$$set=e=>{"issue"in e&&r(0,n=e.issue)},[n]}class kn extends ue{constructor(e){super(),ae(this,e,Dn,xn,s,{issue:0})}}function An(e,t,r){const n=e.slice();return n[2]=t[r],n}function Cn(e){let t;return{c(){t=y("h1"),t.textContent="Issues",E(t,"class","font-bold")},m(e,r){g(e,t,r)},d(e){e&&m(t)}}}function Pn(e){let t;return{c(){t=y("div"),t.textContent="No issues yet."},m(e,r){g(e,t,r)},d(e){e&&m(t)}}}function Tn(e){let t,r,n=e[0].content,i=[];for(let t=0;t<n.length;t+=1)i[t]=Rn(An(e,n,t));const o=e=>Q(i[e],1,1,(()=>{i[e]=null}));return{c(){for(let e=0;e<i.length;e+=1)i[e].c();t=_()},m(e,n){for(let t=0;t<i.length;t+=1)i[t].m(e,n);g(e,t,n),r=!0},p(e,r){if(1&r){let s;for(n=e[0].content,s=0;s<n.length;s+=1){const o=An(e,n,s);i[s]?(i[s].p(o,r),Z(i[s],1)):(i[s]=Rn(o),i[s].c(),Z(i[s],1),i[s].m(t.parentNode,t))}for(G(),s=n.length;s<i.length;s+=1)o(s);X()}},i(e){if(!r){for(let e=0;e<n.length;e+=1)Z(i[e]);r=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)Q(i[e]);r=!1},d(e){v(i,e),e&&m(t)}}}function Rn(e){let t,r;return t=new kn({props:{issue:e[2]}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,r){const n={};1&r&&(n.issue=e[2]),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function Bn(e){let t,r,n;function i(e,t){return e[0].content&&0===e[0].content.length?Pn:Cn}let o=i(e),s=o(e),a=e[0].content&&Tn(e);return{c(){s.c(),t=F(),a&&a.c(),r=_()},m(e,i){s.m(e,i),g(e,t,i),a&&a.m(e,i),g(e,r,i),n=!0},p(e,[n]){o!==(o=i(e))&&(s.d(1),s=o(e),s&&(s.c(),s.m(t.parentNode,t))),e[0].content?a?(a.p(e,n),1&n&&Z(a,1)):(a=Tn(e),a.c(),Z(a,1),a.m(r.parentNode,r)):a&&(G(),Q(a,1,1,(()=>{a=null})),X())},i(e){n||(Z(a),n=!0)},o(e){Q(a),n=!1},d(e){s.d(e),e&&m(t),a&&a.d(e),e&&m(r)}}}function In(e,t,r){let{projectId:n}=t,i=[];return T((async()=>{const e=new Pt;r(0,i=await e.getProjectIssues(n)||[]),console.log(i)})),e.$$set=e=>{"projectId"in e&&r(1,n=e.projectId)},[i,n]}class jn extends ue{constructor(e){super(),ae(this,e,In,Bn,s,{projectId:1})}}function $n(e){let t,r,n,i,o;return r=new Ne({props:{name:"New Issue",href:"#/projects/"+e[0]+"/issues/new",defaultAction:"true"}}),i=new jn({props:{projectId:e[0]}}),{c(){t=y("div"),ie(r.$$.fragment),n=F(),ie(i.$$.fragment),E(t,"class","mb-4")},m(e,s){g(e,t,s),oe(r,t,null),g(e,n,s),oe(i,e,s),o=!0},p(e,t){const n={};1&t&&(n.href="#/projects/"+e[0]+"/issues/new"),r.$set(n);const o={};1&t&&(o.projectId=e[0]),i.$set(o)},i(e){o||(Z(r.$$.fragment,e),Z(i.$$.fragment,e),o=!0)},o(e){Q(r.$$.fragment,e),Q(i.$$.fragment,e),o=!1},d(e){e&&m(t),se(r),e&&m(n),se(i,e)}}}function Ln(e){let t,r;return t=new fe({props:{$$slots:{default:[$n]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,[r]){const n={};5&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function Nn(e,t,r){let{projectId:n}=t,{params:i}=t;return T((()=>{console.log(i)})),e.$$set=e=>{"projectId"in e&&r(0,n=e.projectId),"params"in e&&r(1,i=e.params)},[n,i]}class On extends ue{constructor(e){super(),ae(this,e,Nn,Ln,s,{projectId:0,params:1})}}var Un=pe((function(e,t){e.exports=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}function r(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function o(e){var t={exports:{}};return e(t,t.exports),t.exports}var s=o((function(e){function t(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function r(t){e.exports.defaults=t}e.exports={defaults:t(),getDefaults:t,changeDefaults:r}})),a=/[&<>"']/,u=/[&<>"']/g,c=/[<>"']|&(?!#?\w+;)/,l=/[<>"']|&(?!#?\w+;)/g,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},f=function(e){return h[e]};function d(e,t){if(t){if(a.test(e))return e.replace(u,f)}else if(c.test(e))return e.replace(l,f);return e}var p=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function g(e){return e.replace(p,(function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))}var m=/(^|[^\[])\^/g;function v(e,t){e=e.source||e,t=t||"";var r={replace:function(t,n){return n=(n=n.source||n).replace(m,"$1"),e=e.replace(t,n),r},getRegex:function(){return new RegExp(e,t)}};return r}var y=/[^\w:]/g,b=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function w(e,t,r){if(e){var n;try{n=decodeURIComponent(g(r)).replace(y,"").toLowerCase()}catch(e){return null}if(0===n.indexOf("javascript:")||0===n.indexOf("vbscript:")||0===n.indexOf("data:"))return null}t&&!b.test(r)&&(r=x(t,r));try{r=encodeURI(r).replace(/%25/g,"%")}catch(e){return null}return r}var F={},_=/^[^:]+:\/*[^/]*$/,S=/^([^:]+:)[\s\S]*$/,E=/^([^:]+:\/*[^/]*)[\s\S]*$/;function x(e,t){F[" "+e]||(_.test(e)?F[" "+e]=e+"/":F[" "+e]=A(e,"/",!0));var r=-1===(e=F[" "+e]).indexOf(":");return"//"===t.substring(0,2)?r?t:e.replace(S,"$1")+t:"/"===t.charAt(0)?r?t:e.replace(E,"$1")+t:e+t}function D(e){for(var t,r,n=1;n<arguments.length;n++)for(r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function k(e,t){var r=e.replace(/\|/g,(function(e,t,r){for(var n=!1,i=t;--i>=0&&"\\"===r[i];)n=!n;return n?"|":" |"})).split(/ \|/),n=0;if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;n<r.length;n++)r[n]=r[n].trim().replace(/\\\|/g,"|");return r}function A(e,t,r){var n=e.length;if(0===n)return"";for(var i=0;i<n;){var o=e.charAt(n-i-1);if(o!==t||r){if(o===t||!r)break;i++}else i++}return e.substr(0,n-i)}function C(e,t){if(-1===e.indexOf(t[1]))return-1;for(var r=e.length,n=0,i=0;i<r;i++)if("\\"===e[i])i++;else if(e[i]===t[0])n++;else if(e[i]===t[1]&&--n<0)return i;return-1}function P(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function T(e,t){if(t<1)return"";for(var r="";t>1;)1&t&&(r+=e),t>>=1,e+=e;return r+e}var R={escape:d,unescape:g,edit:v,cleanUrl:w,resolveUrl:x,noopTest:{exec:function(){}},merge:D,splitCells:k,rtrim:A,findClosingBracket:C,checkSanitizeDeprecation:P,repeatString:T},B=s.defaults,I=R.rtrim,j=R.splitCells,$=R.escape,L=R.findClosingBracket;function N(e,t,r){var n=t.href,i=t.title?$(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");return"!"!==e[0].charAt(0)?{type:"link",raw:r,href:n,title:i,text:o}:{type:"image",raw:r,href:n,title:i,text:$(o)}}function O(e,t){var r=e.match(/^(\s+)(?:```)/);if(null===r)return t;var n=r[1];return t.split("\n").map((function(e){var t=e.match(/^\s+/);return null===t?e:t[0].length>=n.length?e.slice(n.length):e})).join("\n")}var U=function(){function e(e){this.options=e||B}var t=e.prototype;return t.space=function(e){var t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:"\n"}},t.code=function(e){var t=this.rules.block.code.exec(e);if(t){var r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:I(r,"\n")}}},t.fences=function(e){var t=this.rules.block.fences.exec(e);if(t){var r=t[0],n=O(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim():t[2],text:n}}},t.heading=function(e){var t=this.rules.block.heading.exec(e);if(t){var r=t[2].trim();if(/#$/.test(r)){var n=I(r,"#");this.options.pedantic?r=n.trim():n&&!/ $/.test(n)||(r=n.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r}}},t.nptable=function(e){var t=this.rules.block.nptable.exec(e);if(t){var r={type:"table",header:j(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[],raw:t[0]};if(r.header.length===r.align.length){var n,i=r.align.length;for(n=0;n<i;n++)/^ *-+: *$/.test(r.align[n])?r.align[n]="right":/^ *:-+: *$/.test(r.align[n])?r.align[n]="center":/^ *:-+ *$/.test(r.align[n])?r.align[n]="left":r.align[n]=null;for(i=r.cells.length,n=0;n<i;n++)r.cells[n]=j(r.cells[n],r.header.length);return r}}},t.hr=function(e){var t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}},t.blockquote=function(e){var t=this.rules.block.blockquote.exec(e);if(t){var r=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],text:r}}},t.list=function(e){var t=this.rules.block.list.exec(e);if(t){var r,n,i,o,s,a,u,c,l=t[0],h=t[2],f=h.length>1,d={type:"list",raw:l,ordered:f,start:f?+h.slice(0,-1):"",loose:!1,items:[]},p=t[0].match(this.rules.block.item),g=!1,m=p.length;i=this.rules.block.listItemStart.exec(p[0]);for(var v=0;v<m;v++){if(l=r=p[v],v!==m-1){if(o=this.rules.block.listItemStart.exec(p[v+1]),this.options.pedantic?o[1].length>i[1].length:o[1].length>i[0].length||o[1].length>3){p.splice(v,2,p[v]+"\n"+p[v+1]),v--,m--;continue}(!this.options.pedantic||this.options.smartLists?o[2][o[2].length-1]!==h[h.length-1]:f===(1===o[2].length))&&(s=p.slice(v+1).join("\n"),d.raw=d.raw.substring(0,d.raw.length-s.length),v=m-1),i=o}n=r.length,~(r=r.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(n-=r.length,r=this.options.pedantic?r.replace(/^ {1,4}/gm,""):r.replace(new RegExp("^ {1,"+n+"}","gm"),"")),a=g||/\n\n(?!\s*$)/.test(r),v!==m-1&&(g="\n"===r.charAt(r.length-1),a||(a=g)),a&&(d.loose=!0),this.options.gfm&&(c=void 0,(u=/^\[[ xX]\] /.test(r))&&(c=" "!==r[1],r=r.replace(/^\[[ xX]\] +/,""))),d.items.push({type:"list_item",raw:l,task:u,checked:c,loose:a,text:r})}return d}},t.html=function(e){var t=this.rules.block.html.exec(e);if(t)return{type:this.options.sanitize?"paragraph":"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):$(t[0]):t[0]}},t.def=function(e){var t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}},t.table=function(e){var t=this.rules.block.table.exec(e);if(t){var r={type:"table",header:j(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[]};if(r.header.length===r.align.length){r.raw=t[0];var n,i=r.align.length;for(n=0;n<i;n++)/^ *-+: *$/.test(r.align[n])?r.align[n]="right":/^ *:-+: *$/.test(r.align[n])?r.align[n]="center":/^ *:-+ *$/.test(r.align[n])?r.align[n]="left":r.align[n]=null;for(i=r.cells.length,n=0;n<i;n++)r.cells[n]=j(r.cells[n].replace(/^ *\| *| *\| *$/g,""),r.header.length);return r}}},t.lheading=function(e){var t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1]}},t.paragraph=function(e){var t=this.rules.block.paragraph.exec(e);if(t)return{type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1]}},t.text=function(e){var t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0]}},t.escape=function(e){var t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:$(t[1])}},t.tag=function(e,t,r){var n=this.rules.inline.tag.exec(e);if(n)return!t&&/^<a /i.test(n[0])?t=!0:t&&/^<\/a>/i.test(n[0])&&(t=!1),!r&&/^<(pre|code|kbd|script)(\s|>)/i.test(n[0])?r=!0:r&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(n[0])&&(r=!1),{type:this.options.sanitize?"text":"html",raw:n[0],inLink:t,inRawBlock:r,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):$(n[0]):n[0]}},t.link=function(e){var t=this.rules.inline.link.exec(e);if(t){var r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;var n=I(r.slice(0,-1),"\\");if((r.length-n.length)%2==0)return}else{var i=L(t[2],"()");if(i>-1){var o=(0===t[0].indexOf("!")?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,o).trim(),t[3]=""}}var s=t[2],a="";if(this.options.pedantic){var u=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);u&&(s=u[1],a=u[3])}else a=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(r)?s.slice(1):s.slice(1,-1)),N(t,{href:s?s.replace(this.rules.inline._escapes,"$1"):s,title:a?a.replace(this.rules.inline._escapes,"$1"):a},t[0])}},t.reflink=function(e,t){var r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){var n=(r[2]||r[1]).replace(/\s+/g," ");if(!(n=t[n.toLowerCase()])||!n.href){var i=r[0].charAt(0);return{type:"text",raw:i,text:i}}return N(r,n,r[0])}},t.emStrong=function(e,t,r){void 0===r&&(r="");var n=this.rules.inline.emStrong.lDelim.exec(e);if(n&&(!n[3]||!r.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var i=n[1]||n[2]||"";if(!i||i&&(""===r||this.rules.inline.punctuation.exec(r))){var o,s,a=n[0].length-1,u=a,c=0,l="*"===n[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+a);null!=(n=l.exec(t));)if(o=n[1]||n[2]||n[3]||n[4]||n[5]||n[6])if(s=o.length,n[3]||n[4])u+=s;else if(!((n[5]||n[6])&&a%3)||(a+s)%3){if(!((u-=s)>0)){if(u+c-s<=0&&!t.slice(l.lastIndex).match(l)&&(s=Math.min(s,s+u+c)),Math.min(a,s)%2)return{type:"em",raw:e.slice(0,a+n.index+s+1),text:e.slice(1,a+n.index+s)};if(Math.min(a,s)%2==0)return{type:"strong",raw:e.slice(0,a+n.index+s+1),text:e.slice(2,a+n.index+s-1)}}}else c+=s}}},t.codespan=function(e){var t=this.rules.inline.code.exec(e);if(t){var r=t[2].replace(/\n/g," "),n=/[^ ]/.test(r),i=/^ /.test(r)&&/ $/.test(r);return n&&i&&(r=r.substring(1,r.length-1)),r=$(r,!0),{type:"codespan",raw:t[0],text:r}}},t.br=function(e){var t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}},t.del=function(e){var t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2]}},t.autolink=function(e,t){var r,n,i=this.rules.inline.autolink.exec(e);if(i)return n="@"===i[2]?"mailto:"+(r=$(this.options.mangle?t(i[1]):i[1])):r=$(i[1]),{type:"link",raw:i[0],text:r,href:n,tokens:[{type:"text",raw:r,text:r}]}},t.url=function(e,t){var r;if(r=this.rules.inline.url.exec(e)){var n,i;if("@"===r[2])i="mailto:"+(n=$(this.options.mangle?t(r[0]):r[0]));else{var o;do{o=r[0],r[0]=this.rules.inline._backpedal.exec(r[0])[0]}while(o!==r[0]);n=$(r[0]),i="www."===r[1]?"http://"+n:n}return{type:"link",raw:r[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}},t.inlineText=function(e,t,r){var n,i=this.rules.inline.text.exec(e);if(i)return n=t?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):$(i[0]):i[0]:$(this.options.smartypants?r(i[0]):i[0]),{type:"text",raw:i[0],text:n}},e}(),M=R.noopTest,H=R.edit,q=R.merge,V={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:M,table:M,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};V.def=H(V.def).replace("label",V._label).replace("title",V._title).getRegex(),V.bullet=/(?:[*+-]|\d{1,9}[.)])/,V.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,V.item=H(V.item,"gm").replace(/bull/g,V.bullet).getRegex(),V.listItemStart=H(/^( *)(bull)/).replace("bull",V.bullet).getRegex(),V.list=H(V.list).replace(/bull/g,V.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+V.def.source+")").getRegex(),V._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",V._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,V.html=H(V.html,"i").replace("comment",V._comment).replace("tag",V._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),V.paragraph=H(V._paragraph).replace("hr",V.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",V._tag).getRegex(),V.blockquote=H(V.blockquote).replace("paragraph",V.paragraph).getRegex(),V.normal=q({},V),V.gfm=q({},V.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),V.gfm.nptable=H(V.gfm.nptable).replace("hr",V.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",V._tag).getRegex(),V.gfm.table=H(V.gfm.table).replace("hr",V.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",V._tag).getRegex(),V.pedantic=q({},V.normal,{html:H("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",V._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:M,paragraph:H(V.normal._paragraph).replace("hr",V.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",V.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var K={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:M,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_]*?\*[^_]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^*]*?\_[^*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:M,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};K.punctuation=H(K.punctuation).replace(/punctuation/g,K._punctuation).getRegex(),K.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,K.escapedEmSt=/\\\*|\\_/g,K._comment=H(V._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),K.emStrong.lDelim=H(K.emStrong.lDelim).replace(/punct/g,K._punctuation).getRegex(),K.emStrong.rDelimAst=H(K.emStrong.rDelimAst,"g").replace(/punct/g,K._punctuation).getRegex(),K.emStrong.rDelimUnd=H(K.emStrong.rDelimUnd,"g").replace(/punct/g,K._punctuation).getRegex(),K._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,K._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,K._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,K.autolink=H(K.autolink).replace("scheme",K._scheme).replace("email",K._email).getRegex(),K._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,K.tag=H(K.tag).replace("comment",K._comment).replace("attribute",K._attribute).getRegex(),K._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,K._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,K._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,K.link=H(K.link).replace("label",K._label).replace("href",K._href).replace("title",K._title).getRegex(),K.reflink=H(K.reflink).replace("label",K._label).getRegex(),K.reflinkSearch=H(K.reflinkSearch,"g").replace("reflink",K.reflink).replace("nolink",K.nolink).getRegex(),K.normal=q({},K),K.pedantic=q({},K.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:H(/^!?\[(label)\]\((.*?)\)/).replace("label",K._label).getRegex(),reflink:H(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",K._label).getRegex()}),K.gfm=q({},K.normal,{escape:H(K.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))/}),K.gfm.url=H(K.gfm.url,"i").replace("email",K.gfm._extended_email).getRegex(),K.breaks=q({},K.gfm,{br:H(K.br).replace("{2,}","*").getRegex(),text:H(K.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var z={block:V,inline:K},J=s.defaults,W=z.block,Y=z.inline,G=R.repeatString;function X(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function Z(e){var t,r,n="",i=e.length;for(t=0;t<i;t++)r=e.charCodeAt(t),Math.random()>.5&&(r="x"+r.toString(16)),n+="&#"+r+";";return n}var Q=function(){function e(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||J,this.options.tokenizer=this.options.tokenizer||new U,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var t={block:W.normal,inline:Y.normal};this.options.pedantic?(t.block=W.pedantic,t.inline=Y.pedantic):this.options.gfm&&(t.block=W.gfm,this.options.breaks?t.inline=Y.breaks:t.inline=Y.gfm),this.tokenizer.rules=t}e.lex=function(t,r){return new e(r).lex(t)},e.lexInline=function(t,r){return new e(r).inlineTokens(t)};var r=e.prototype;return r.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens,!0),this.inline(this.tokens),this.tokens},r.blockTokens=function(e,t,r){var n,i,o,s;for(void 0===t&&(t=[]),void 0===r&&(r=!0),this.options.pedantic&&(e=e.replace(/^ +$/gm,""));e;)if(n=this.tokenizer.space(e))e=e.substring(n.raw.length),n.type&&t.push(n);else if(n=this.tokenizer.code(e))e=e.substring(n.raw.length),(s=t[t.length-1])&&"paragraph"===s.type?(s.raw+="\n"+n.raw,s.text+="\n"+n.text):t.push(n);else if(n=this.tokenizer.fences(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.heading(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.nptable(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.hr(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.blockquote(e))e=e.substring(n.raw.length),n.tokens=this.blockTokens(n.text,[],r),t.push(n);else if(n=this.tokenizer.list(e)){for(e=e.substring(n.raw.length),o=n.items.length,i=0;i<o;i++)n.items[i].tokens=this.blockTokens(n.items[i].text,[],!1);t.push(n)}else if(n=this.tokenizer.html(e))e=e.substring(n.raw.length),t.push(n);else if(r&&(n=this.tokenizer.def(e)))e=e.substring(n.raw.length),this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});else if(n=this.tokenizer.table(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.lheading(e))e=e.substring(n.raw.length),t.push(n);else if(r&&(n=this.tokenizer.paragraph(e)))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.text(e))e=e.substring(n.raw.length),(s=t[t.length-1])&&"text"===s.type?(s.raw+="\n"+n.raw,s.text+="\n"+n.text):t.push(n);else if(e){var a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}throw new Error(a)}return t},r.inline=function(e){var t,r,n,i,o,s,a=e.length;for(t=0;t<a;t++)switch((s=e[t]).type){case"paragraph":case"text":case"heading":s.tokens=[],this.inlineTokens(s.text,s.tokens);break;case"table":for(s.tokens={header:[],cells:[]},i=s.header.length,r=0;r<i;r++)s.tokens.header[r]=[],this.inlineTokens(s.header[r],s.tokens.header[r]);for(i=s.cells.length,r=0;r<i;r++)for(o=s.cells[r],s.tokens.cells[r]=[],n=0;n<o.length;n++)s.tokens.cells[r][n]=[],this.inlineTokens(o[n],s.tokens.cells[r][n]);break;case"blockquote":this.inline(s.tokens);break;case"list":for(i=s.items.length,r=0;r<i;r++)this.inline(s.items[r].tokens)}return e},r.inlineTokens=function(e,t,r,n){var i,o;void 0===t&&(t=[]),void 0===r&&(r=!1),void 0===n&&(n=!1);var s,a,u,c=e;if(this.tokens.links){var l=Object.keys(this.tokens.links);if(l.length>0)for(;null!=(s=this.tokenizer.rules.inline.reflinkSearch.exec(c));)l.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(c=c.slice(0,s.index)+"["+G("a",s[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(s=this.tokenizer.rules.inline.blockSkip.exec(c));)c=c.slice(0,s.index)+"["+G("a",s[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(s=this.tokenizer.rules.inline.escapedEmSt.exec(c));)c=c.slice(0,s.index)+"++"+c.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(a||(u=""),a=!1,i=this.tokenizer.escape(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.tag(e,r,n)){e=e.substring(i.raw.length),r=i.inLink,n=i.inRawBlock;var h=t[t.length-1];h&&"text"===i.type&&"text"===h.type?(h.raw+=i.raw,h.text+=i.text):t.push(i)}else if(i=this.tokenizer.link(e))e=e.substring(i.raw.length),"link"===i.type&&(i.tokens=this.inlineTokens(i.text,[],!0,n)),t.push(i);else if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length);var f=t[t.length-1];"link"===i.type?(i.tokens=this.inlineTokens(i.text,[],!0,n),t.push(i)):f&&"text"===i.type&&"text"===f.type?(f.raw+=i.raw,f.text+=i.text):t.push(i)}else if(i=this.tokenizer.emStrong(e,c,u))e=e.substring(i.raw.length),i.tokens=this.inlineTokens(i.text,[],r,n),t.push(i);else if(i=this.tokenizer.codespan(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.br(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.del(e))e=e.substring(i.raw.length),i.tokens=this.inlineTokens(i.text,[],r,n),t.push(i);else if(i=this.tokenizer.autolink(e,Z))e=e.substring(i.raw.length),t.push(i);else if(r||!(i=this.tokenizer.url(e,Z))){if(i=this.tokenizer.inlineText(e,n,X))e=e.substring(i.raw.length),"_"!==i.raw.slice(-1)&&(u=i.raw.slice(-1)),a=!0,(o=t[t.length-1])&&"text"===o.type?(o.raw+=i.raw,o.text+=i.text):t.push(i);else if(e){var d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}throw new Error(d)}}else e=e.substring(i.raw.length),t.push(i);return t},t(e,null,[{key:"rules",get:function(){return{block:W,inline:Y}}}]),e}(),ee=s.defaults,te=R.cleanUrl,re=R.escape,ne=function(){function e(e){this.options=e||ee}var t=e.prototype;return t.code=function(e,t,r){var n=(t||"").match(/\S*/)[0];if(this.options.highlight){var i=this.options.highlight(e,n);null!=i&&i!==e&&(r=!0,e=i)}return e=e.replace(/\n$/,"")+"\n",n?'<pre><code class="'+this.options.langPrefix+re(n,!0)+'">'+(r?e:re(e,!0))+"</code></pre>\n":"<pre><code>"+(r?e:re(e,!0))+"</code></pre>\n"},t.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},t.html=function(e){return e},t.heading=function(e,t,r,n){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+n.slug(r)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},t.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},t.list=function(e,t,r){var n=t?"ol":"ul";return"<"+n+(t&&1!==r?' start="'+r+'"':"")+">\n"+e+"</"+n+">\n"},t.listitem=function(e){return"<li>"+e+"</li>\n"},t.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},t.paragraph=function(e){return"<p>"+e+"</p>\n"},t.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},t.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},t.tablecell=function(e,t){var r=t.header?"th":"td";return(t.align?"<"+r+' align="'+t.align+'">':"<"+r+">")+e+"</"+r+">\n"},t.strong=function(e){return"<strong>"+e+"</strong>"},t.em=function(e){return"<em>"+e+"</em>"},t.codespan=function(e){return"<code>"+e+"</code>"},t.br=function(){return this.options.xhtml?"<br/>":"<br>"},t.del=function(e){return"<del>"+e+"</del>"},t.link=function(e,t,r){if(null===(e=te(this.options.sanitize,this.options.baseUrl,e)))return r;var n='<a href="'+re(e)+'"';return t&&(n+=' title="'+t+'"'),n+=">"+r+"</a>"},t.image=function(e,t,r){if(null===(e=te(this.options.sanitize,this.options.baseUrl,e)))return r;var n='<img src="'+e+'" alt="'+r+'"';return t&&(n+=' title="'+t+'"'),n+=this.options.xhtml?"/>":">"},t.text=function(e){return e},e}(),ie=function(){function e(){}var t=e.prototype;return t.strong=function(e){return e},t.em=function(e){return e},t.codespan=function(e){return e},t.del=function(e){return e},t.html=function(e){return e},t.text=function(e){return e},t.link=function(e,t,r){return""+r},t.image=function(e,t,r){return""+r},t.br=function(){return""},e}(),oe=function(){function e(){this.seen={}}var t=e.prototype;return t.serialize=function(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},t.getNextSafeSlug=function(e,t){var r=e,n=0;if(this.seen.hasOwnProperty(r)){n=this.seen[e];do{r=e+"-"+ ++n}while(this.seen.hasOwnProperty(r))}return t||(this.seen[e]=n,this.seen[r]=0),r},t.slug=function(e,t){void 0===t&&(t={});var r=this.serialize(e);return this.getNextSafeSlug(r,t.dryrun)},e}(),se=s.defaults,ae=R.unescape,ue=function(){function e(e){this.options=e||se,this.options.renderer=this.options.renderer||new ne,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new ie,this.slugger=new oe}e.parse=function(t,r){return new e(r).parse(t)},e.parseInline=function(t,r){return new e(r).parseInline(t)};var t=e.prototype;return t.parse=function(e,t){void 0===t&&(t=!0);var r,n,i,o,s,a,u,c,l,h,f,d,p,g,m,v,y,b,w="",F=e.length;for(r=0;r<F;r++)switch((h=e[r]).type){case"space":continue;case"hr":w+=this.renderer.hr();continue;case"heading":w+=this.renderer.heading(this.parseInline(h.tokens),h.depth,ae(this.parseInline(h.tokens,this.textRenderer)),this.slugger);continue;case"code":w+=this.renderer.code(h.text,h.lang,h.escaped);continue;case"table":for(c="",u="",o=h.header.length,n=0;n<o;n++)u+=this.renderer.tablecell(this.parseInline(h.tokens.header[n]),{header:!0,align:h.align[n]});for(c+=this.renderer.tablerow(u),l="",o=h.cells.length,n=0;n<o;n++){for(u="",s=(a=h.tokens.cells[n]).length,i=0;i<s;i++)u+=this.renderer.tablecell(this.parseInline(a[i]),{header:!1,align:h.align[i]});l+=this.renderer.tablerow(u)}w+=this.renderer.table(c,l);continue;case"blockquote":l=this.parse(h.tokens),w+=this.renderer.blockquote(l);continue;case"list":for(f=h.ordered,d=h.start,p=h.loose,o=h.items.length,l="",n=0;n<o;n++)v=(m=h.items[n]).checked,y=m.task,g="",m.task&&(b=this.renderer.checkbox(v),p?m.tokens.length>0&&"text"===m.tokens[0].type?(m.tokens[0].text=b+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&"text"===m.tokens[0].tokens[0].type&&(m.tokens[0].tokens[0].text=b+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:b}):g+=b),g+=this.parse(m.tokens,p),l+=this.renderer.listitem(g,y,v);w+=this.renderer.list(l,f,d);continue;case"html":w+=this.renderer.html(h.text);continue;case"paragraph":w+=this.renderer.paragraph(this.parseInline(h.tokens));continue;case"text":for(l=h.tokens?this.parseInline(h.tokens):h.text;r+1<F&&"text"===e[r+1].type;)l+="\n"+((h=e[++r]).tokens?this.parseInline(h.tokens):h.text);w+=t?this.renderer.paragraph(l):l;continue;default:var _='Token with "'+h.type+'" type was not found.';if(this.options.silent)return void console.error(_);throw new Error(_)}return w},t.parseInline=function(e,t){t=t||this.renderer;var r,n,i="",o=e.length;for(r=0;r<o;r++)switch((n=e[r]).type){case"escape":i+=t.text(n.text);break;case"html":i+=t.html(n.text);break;case"link":i+=t.link(n.href,n.title,this.parseInline(n.tokens,t));break;case"image":i+=t.image(n.href,n.title,n.text);break;case"strong":i+=t.strong(this.parseInline(n.tokens,t));break;case"em":i+=t.em(this.parseInline(n.tokens,t));break;case"codespan":i+=t.codespan(n.text);break;case"br":i+=t.br();break;case"del":i+=t.del(this.parseInline(n.tokens,t));break;case"text":i+=t.text(n.text);break;default:var s='Token with "'+n.type+'" type was not found.';if(this.options.silent)return void console.error(s);throw new Error(s)}return i},e}(),ce=R.merge,le=R.checkSanitizeDeprecation,he=R.escape,fe=s.getDefaults,de=s.changeDefaults,pe=s.defaults;function ge(e,t,r){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(r=t,t=null),t=ce({},ge.defaults,t||{}),le(t),r){var n,i=t.highlight;try{n=Q.lex(e,t)}catch(e){return r(e)}var o=function(e){var o;if(!e)try{o=ue.parse(n,t)}catch(t){e=t}return t.highlight=i,e?r(e):r(null,o)};if(!i||i.length<3)return o();if(delete t.highlight,!n.length)return o();var s=0;return ge.walkTokens(n,(function(e){"code"===e.type&&(s++,setTimeout((function(){i(e.text,e.lang,(function(t,r){if(t)return o(t);null!=r&&r!==e.text&&(e.text=r,e.escaped=!0),0==--s&&o()}))}),0))})),void(0===s&&o())}try{var a=Q.lex(e,t);return t.walkTokens&&ge.walkTokens(a,t.walkTokens),ue.parse(a,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+he(e.message+"",!0)+"</pre>";throw e}}return ge.options=ge.setOptions=function(e){return ce(ge.defaults,e),de(ge.defaults),ge},ge.getDefaults=fe,ge.defaults=pe,ge.use=function(e){var t=ce({},e);if(e.renderer&&function(){var r=ge.defaults.renderer||new ne,n=function(t){var n=r[t];r[t]=function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];var a=e.renderer[t].apply(r,o);return!1===a&&(a=n.apply(r,o)),a}};for(var i in e.renderer)n(i);t.renderer=r}(),e.tokenizer&&function(){var r=ge.defaults.tokenizer||new U,n=function(t){var n=r[t];r[t]=function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];var a=e.tokenizer[t].apply(r,o);return!1===a&&(a=n.apply(r,o)),a}};for(var i in e.tokenizer)n(i);t.tokenizer=r}(),e.walkTokens){var r=ge.defaults.walkTokens;t.walkTokens=function(t){e.walkTokens(t),r&&r(t)}}ge.setOptions(t)},ge.walkTokens=function(e,t){for(var r,n=i(e);!(r=n()).done;){var o=r.value;switch(t(o),o.type){case"table":for(var s,a=i(o.tokens.header);!(s=a()).done;){var u=s.value;ge.walkTokens(u,t)}for(var c,l=i(o.tokens.cells);!(c=l()).done;)for(var h,f=i(c.value);!(h=f()).done;){var d=h.value;ge.walkTokens(d,t)}break;case"list":ge.walkTokens(o.items,t);break;default:o.tokens&&ge.walkTokens(o.tokens,t)}}},ge.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");t=ce({},ge.defaults,t||{}),le(t);try{var r=Q.lexInline(e,t);return t.walkTokens&&ge.walkTokens(r,t.walkTokens),ue.parseInline(r,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+he(e.message+"",!0)+"</pre>";throw e}},ge.Parser=ue,ge.parser=ue.parse,ge.Renderer=ne,ge.TextRenderer=ie,ge.Lexer=Q,ge.lexer=Q.lex,ge.Tokenizer=U,ge.Slugger=oe,ge.parse=ge,ge}()}));function Mn(e){let t,r;return t=new fe({props:{$$slots:{default:[qn]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,r){const n={};39&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function Hn(e){let t;return{c(){t=y("div"),t.textContent="closed",E(t,"class","float-right px-1 border rounded bg-red-700 text-white text-xs")},m(e,r){g(e,t,r)},d(e){e&&m(t)}}}function qn(e){let t,r,n,i,o,s,a,u,c,l,h,f,d,v,b,_,S,D,k,A,C,P,T,R,B=e[0].id+"",I=e[0].title+"",j=e[0].author.firstName+"",$=e[0].author.lastName+"",L=Un(e[0].description)+"";l=new Ne({props:{small:"true",name:"Edit",href:"#/projects/"+e[2]+"/issues/"+e[1].issueId+"/edit"}});let N=e[0].closed&&Hn();return T=new Hr({props:{name:e[0].closed?"Reopen issue":"Close issue",bgColor:"border-red-700",textColor:"text-red-700",pressedBackground:"bg-red-200"}}),T.$on("click",e[3]),{c(){t=y("div"),r=w("issue #"),n=w(B),i=F(),o=y("div"),s=y("div"),a=w(I),u=F(),c=y("div"),ie(l.$$.fragment),h=F(),f=y("div"),d=y("div"),v=w("author: "),b=w(j),_=F(),S=w($),D=F(),N&&N.c(),k=F(),A=y("div"),C=F(),P=y("div"),ie(T.$$.fragment),E(t,"class","font-bold"),E(s,"class","text-lg font-bold flex-grow"),E(c,"class","pt-1 flex"),E(o,"id","title-container"),E(o,"class","flex w-full items-start"),E(d,"class","text-sm w-full"),E(f,"class","flex w-full justify-start items-center mt-1"),E(A,"id","desc-container"),E(A,"class","w-full p-3 text-sm text-justify whitespace-pre-wrap svelte-7d96e1"),E(P,"id","issue-action")},m(e,m){g(e,t,m),p(t,r),p(t,n),g(e,i,m),g(e,o,m),p(o,s),p(s,a),p(o,u),p(o,c),oe(l,c,null),g(e,h,m),g(e,f,m),p(f,d),p(d,v),p(d,b),p(d,_),p(d,S),p(f,D),N&&N.m(f,null),g(e,k,m),g(e,A,m),A.innerHTML=L,g(e,C,m),g(e,P,m),oe(T,P,null),R=!0},p(e,t){(!R||1&t)&&B!==(B=e[0].id+"")&&x(n,B),(!R||1&t)&&I!==(I=e[0].title+"")&&x(a,I);const r={};6&t&&(r.href="#/projects/"+e[2]+"/issues/"+e[1].issueId+"/edit"),l.$set(r),(!R||1&t)&&j!==(j=e[0].author.firstName+"")&&x(b,j),(!R||1&t)&&$!==($=e[0].author.lastName+"")&&x(S,$),e[0].closed?N||(N=Hn(),N.c(),N.m(f,null)):N&&(N.d(1),N=null),(!R||1&t)&&L!==(L=Un(e[0].description)+"")&&(A.innerHTML=L);const i={};1&t&&(i.name=e[0].closed?"Reopen issue":"Close issue"),T.$set(i)},i(e){R||(Z(l.$$.fragment,e),Z(T.$$.fragment,e),R=!0)},o(e){Q(l.$$.fragment,e),Q(T.$$.fragment,e),R=!1},d(e){e&&m(t),e&&m(i),e&&m(o),se(l),e&&m(h),e&&m(f),N&&N.d(),e&&m(k),e&&m(A),e&&m(C),e&&m(P),se(T)}}}function Vn(e){let t,r,n=e[0]&&Mn(e);return{c(){n&&n.c(),t=_()},m(e,i){n&&n.m(e,i),g(e,t,i),r=!0},p(e,[r]){e[0]?n?(n.p(e,r),1&r&&Z(n,1)):(n=Mn(e),n.c(),Z(n,1),n.m(t.parentNode,t)):n&&(G(),Q(n,1,1,(()=>{n=null})),X())},i(e){r||(Z(n),r=!0)},o(e){Q(n),r=!1},d(e){n&&n.d(e),e&&m(t)}}}function Kn(e,t,r){let{params:n}=t,{projectId:i}=t,{issue:o}=t,s=new Pt;return T((async()=>{r(0,o=await s.getProjectIssue(i,n.issueId)),console.log(o.closed)})),e.$$set=e=>{"params"in e&&r(1,n=e.params),"projectId"in e&&r(2,i=e.projectId),"issue"in e&&r(0,o=e.issue)},[o,n,i,async function(){r(0,o.closed=!o.closed,o),r(0,o=await s.saveProjectIssue(i,o)),zt(`#/projects/${i}/issues/${o.id}`)}]}class zn extends ue{constructor(e){super(),ae(this,e,Kn,Vn,s,{params:1,projectId:2,issue:0})}}function Jn(e){let t,r,n=e[0].description+"";return{c(){t=y("div"),r=w(n)},m(e,n){g(e,t,n),p(t,r)},p(e,t){1&t&&n!==(n=e[0].description+"")&&x(r,n)},d(e){e&&m(t)}}}function Wn(e){let t,r=e[0]&&Jn(e);return{c(){r&&r.c(),t=_()},m(e,n){r&&r.m(e,n),g(e,t,n)},p(e,n){e[0]?r?r.p(e,n):(r=Jn(e),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},d(e){r&&r.d(e),e&&m(t)}}}function Yn(e){let t,r;return t=new fe({props:{$$slots:{default:[Wn]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,[r]){const n={};3&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}function Gn(e,t,r){let{project:n={}}=t;return e.$$set=e=>{"project"in e&&r(0,n=e.project)},[n]}class Xn extends ue{constructor(e){super(),ae(this,e,Gn,Yn,s,{project:0})}}function Zn(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function Qn(e){let t,r,n,i,o,s,a,u,c,l,h,f,d,v,b,_,S,D,A,C,P,T=e[0].title+"";return i=new Or({props:{loading:e[1]}}),b=new bn({props:{menuTitle:"Project Menu",items:e[2]}}),C=new Zt({props:{routes:e[3](),prefix:/^\/projects\/[0-9]+/}}),{c(){t=y("div"),t.innerHTML='<a href="#/projects" class="flex"><img class="w-4" src="/img/chevron-left.svg" alt="back"/> \n                <div class="text-sm">All projects</div></a>',r=F(),n=y("div"),ie(i.$$.fragment),o=F(),s=y("div"),s.innerHTML='<a href="#/projects" class="flex flex-col justify-center"><img class="w-6" src="/img/chevron-left.svg" alt="back"/></a>',a=F(),u=y("div"),c=y("div"),l=y("a"),h=w(T),d=F(),v=y("div"),ie(b.$$.fragment),_=F(),S=y("div"),D=F(),A=y("div"),ie(C.$$.fragment),E(t,"class","hidden md:flex pt-2"),E(s,"class","flex justify-center md:hidden"),k(s,"bg-red-200",ni),E(l,"href",f="#/projects/"+e[0].id),E(c,"class","text-center text-md"),E(u,"class","col-span-4 md:col-span-5 w-full flex justify-center items-center"),k(u,"bg-red-200",ni),E(v,"class","flex justify-center md:items-start md:row-span-4"),k(v,"bg-red-200",ni),E(S,"class","col-span-4 col-start-2 md:col-start-1 md:col-span-5 border-t-2 border-gray-200"),E(A,"class","col-start-1 col-span-6 md:col-start-1 md:col-span-5"),E(n,"class","relative grid grid-cols-6 gap-1 mt-2 px-2")},m(e,f){g(e,t,f),g(e,r,f),g(e,n,f),oe(i,n,null),p(n,o),p(n,s),p(n,a),p(n,u),p(u,c),p(c,l),p(l,h),p(n,d),p(n,v),oe(b,v,null),p(n,_),p(n,S),p(n,D),p(n,A),oe(C,A,null),P=!0},p(e,t){const r={};2&t&&(r.loading=e[1]),i.$set(r),0&t&&k(s,"bg-red-200",ni),(!P||1&t)&&T!==(T=e[0].title+"")&&x(h,T),(!P||1&t&&f!==(f="#/projects/"+e[0].id))&&E(l,"href",f),0&t&&k(u,"bg-red-200",ni),0&t&&k(v,"bg-red-200",ni)},i(e){P||(Z(i.$$.fragment,e),Z(b.$$.fragment,e),Z(C.$$.fragment,e),P=!0)},o(e){Q(i.$$.fragment,e),Q(b.$$.fragment,e),Q(C.$$.fragment,e),P=!1},d(e){e&&m(t),e&&m(r),e&&m(n),se(i),se(b),se(C)}}}function ei(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function ti(e){let t,r,n,i={ctx:e,current:null,token:null,hasCatch:!1,pending:ei,then:Qn,catch:Zn,value:6,blocks:[,,,]};return function(e,t){const r=t.token={};function n(e,n,i,o){if(t.token!==r)return;t.resolved=o;let s=t.ctx;void 0!==i&&(s=s.slice(),s[i]=o);const a=e&&(t.current=e)(s);let u=!1;t.block&&(t.blocks?t.blocks.forEach(((e,r)=>{r!==n&&e&&(G(),Q(e,1,1,(()=>{t.blocks[r]=null})),X())})):t.block.d(1),a.c(),Z(a,1),a.m(t.mount(),t.anchor),u=!0),t.block=a,t.blocks&&(t.blocks[n]=a),u&&z()}if((i=e)&&"object"==typeof i&&"function"==typeof i.then){const r=P();if(e.then((e=>{C(r),n(t.then,1,t.value,e),C(null)}),(e=>{if(C(r),n(t.catch,2,t.error,e),C(null),!t.hasCatch)throw e})),t.current!==t.pending)return n(t.pending,0),!0}else{if(t.current!==t.then)return n(t.then,1,t.value,e),!0;t.resolved=e}var i}(r=e[4](),i),{c(){t=_(),i.block.c()},m(e,r){g(e,t,r),i.block.m(e,i.anchor=r),i.mount=()=>t.parentNode,i.anchor=t,n=!0},p(t,r){{const n=(e=t).slice();n[6]=i.resolved,i.block.p(n,r)}},i(e){n||(Z(i.block),n=!0)},o(e){for(let e=0;e<3;e+=1){Q(i.blocks[e])}n=!1},d(e){e&&m(t),i.block.d(e),i.token=null,i=null}}}function ri(e){let t,r;return t=new or({props:{$$slots:{default:[ti]},$$scope:{ctx:e}}}),{c(){ie(t.$$.fragment)},m(e,n){oe(t,e,n),r=!0},p(e,[r]){const n={};131&r&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){r||(Z(t.$$.fragment,e),r=!0)},o(e){Q(t.$$.fragment,e),r=!1},d(e){se(t,e)}}}let ni=!1;function ii(e,t,r){let{params:n}=t,i=[{link:`/projects/${n.id}/issues`,title:"Issues",icon:"/img/document.svg"},{link:`/projects/${n.id}/members`,title:"Members",icon:"/img/user-groups.svg"},{link:"/project-edit/"+n.id,title:"Edit project"}],o={},s=!0;async function a(){let e=new Pt;r(0,o=await e.getProject(n.id)||{})}return T((async()=>{await a(),r(1,s=!1)})),e.$$set=e=>{"params"in e&&r(5,n=e.params)},[o,s,i,function(){return{"/":Ot({component:Xn,props:{project:o}}),"/members":_n,"/issues":Ot({component:On,props:{projectId:n.id}}),"/issues/new":Ot({component:cn,props:{projectId:n.id}}),"/issues/:issueId":Ot({component:zn,props:{projectId:n.id}}),"/issues/:issueId/edit":Ot({component:cn,props:{projectId:n.id}})}},a,n]}class oi extends ue{constructor(e){super(),ae(this,e,ii,ri,s,{params:5})}}const si=[e=>u(Se)],ai=[e=>!u(Se)];let ui={"/":Ot({component:class extends ue{constructor(e){super(),ae(this,e,mr,gr,s,{})}},conditions:si}),"/login":Ot({component:rr,conditions:ai}),"/tasks":Ot({component:class extends ue{constructor(e){super(),ae(this,e,ur,ar,s,{})}},conditions:si}),"/projects":Ot({component:class extends ue{constructor(e){super(),ae(this,e,null,hr,s,{})}},conditions:si}),"/projects/:id":Ot({component:oi,conditions:si}),"/projects/:id/edit":Ot({component:tn,conditions:si}),"/projects/:id/*":Ot({component:oi,conditions:si}),"/project-edit":Ot({component:tn,conditions:si}),"/project-edit/:id":Ot({component:tn,conditions:si}),"/projects/:id/issue-edit":Ot({component:cn,conditions:si}),"/projects/:id/issue-edit/:id":Ot({component:cn,conditions:si}),"/bar":Ot({component:class extends ue{constructor(e){super(),ae(this,e,null,fr,s,{})}},conditions:si}),"/workspace":Ot({component:class extends ue{constructor(e){super(),ae(this,e,null,yr,s,{})}},conditions:si})};Ot({component:rr});function ci(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function li(e){let t,r,n,i;const o=[fi,hi],s=[];function a(e,t){return e[1]?0:1}return t=a(e),r=s[t]=o[t](e),{c(){r.c(),n=_()},m(e,r){s[t].m(e,r),g(e,n,r),i=!0},p(e,i){let u=t;t=a(e),t===u?s[t].p(e,i):(G(),Q(s[u],1,1,(()=>{s[u]=null})),X(),r=s[t],r?r.p(e,i):(r=s[t]=o[t](e),r.c()),Z(r,1),r.m(n.parentNode,n))},i(e){i||(Z(r),i=!0)},o(e){Q(r),i=!1},d(e){s[t].d(e),e&&m(n)}}}function hi(t){let r,n;return r=new rr({}),{c(){ie(r.$$.fragment)},m(e,t){oe(r,e,t),n=!0},p:e,i(e){n||(Z(r.$$.fragment,e),n=!0)},o(e){Q(r.$$.fragment,e),n=!1},d(e){se(r,e)}}}function fi(t){let r,n;return r=new Zt({props:{routes:ui}}),r.$on("conditionsFailed",t[2]),{c(){ie(r.$$.fragment)},m(e,t){oe(r,e,t),n=!0},p:e,i(e){n||(Z(r.$$.fragment,e),n=!0)},o(e){Q(r.$$.fragment,e),n=!1},d(e){se(r,e)}}}function di(e){let t,r,n,i,o,s,a,u;t=new ce({}),n=new je({props:{issuer:"undefined",client_id:"undefined",redirect_uri:"undefined",post_logout_redirect_uri:"undefined"}});const c=[li,ci],l=[];function h(e,t){return e[0]?0:1}return o=h(e),s=l[o]=c[o](e),{c(){ie(t.$$.fragment),r=F(),ie(n.$$.fragment),i=F(),s.c(),a=_()},m(e,s){oe(t,e,s),g(e,r,s),oe(n,e,s),g(e,i,s),l[o].m(e,s),g(e,a,s),u=!0},p(e,[t]){const r={};8&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r);let i=o;o=h(e),o===i?l[o].p(e,t):(G(),Q(l[i],1,1,(()=>{l[i]=null})),X(),s=l[o],s?s.p(e,t):(s=l[o]=c[o](e),s.c()),Z(s,1),s.m(a.parentNode,a))},i(e){u||(Z(t.$$.fragment,e),Z(n.$$.fragment,e),Z(s),u=!0)},o(e){Q(t.$$.fragment,e),Q(n.$$.fragment,e),Q(s),u=!1},d(e){se(t,e),e&&m(r),se(n,e),e&&m(i),l[o].d(e),e&&m(a)}}}function pi(e,t,r){let n,i;return c(e,Ae,(e=>r(0,n=e))),c(e,Se,(e=>r(1,i=e))),[n,i,function(e){console.log("onRouteConditionFailed",e.detail),async function(e){if(!e||e.length<1||"/"!=e.charAt(0)&&0!==e.indexOf("#/"))throw Error("Invalid parameter location");await M();const t=("#"==e.charAt(0)?"":"#")+e;try{window.history.replaceState(void 0,void 0,t)}catch(e){console.warn("Caught exception while replacing the current page. If you're running this in the Svelte REPL, please note that the `replace` method might not work in this environment.")}window.dispatchEvent(new Event("hashchange"))}("/login")}]}return new class extends ue{constructor(e){super(),ae(this,e,pi,di,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
